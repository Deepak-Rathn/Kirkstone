{"is_source_file": true, "format": "C", "description": "This is a C source file implementing the 'sheens' engine for a larger automation framework. It manages machine specifications, crew state, message processing, and interaction with the Littlesheens library. The file includes functions for initializing, enabling/disabling, updating state, and processing messages with detailed crew state management and JSON handling.", "external_files": ["<littlesheens/machines.h>", "<automationService.h>", "<automationEngine.h>", "<icTypes/icHashMap.h>", "<automationAction.h>", "sheens.h"], "external_methods": ["mach_make_ctx", "mach_set_ctx", "mach_open", "mach_close", "mach_set_spec_provider", "mach_crew_process", "hashMapCreate", "hashMapDelete", "hashMapGet", "hashMapPut", "hashMapDestroy"], "published": ["sheensEngineInit"], "classes": [], "methods": [{"name": "void sheens_destroy(void)", "description": "Cleans up resources used by the sheens engine, including freeing context, state buffers, JSON objects, and the hash map.", "scope": "", "scopeKind": ""}, {"name": "bool sheens_enable(const char * id,const char * specification)", "description": "Enables a machine specification by ID; validates schema and updates internal maps and crew state.", "scope": "", "scopeKind": ""}, {"name": "void sheens_disable(const char * id)", "description": "Disables a machine specification by ID and updates internal state accordingly.", "scope": "", "scopeKind": ""}, {"name": "cJSON * sheens_get_state(const char * id)", "description": "Returns a duplicate of the current state of a given machine specified by ID.", "scope": "", "scopeKind": ""}, {"name": "cJSON * sheens_process(const cJSON * message,cJSON * stats)", "description": "Processes an input message, interacts with the Littlesheens crew, updates crew state, and produces action messages.", "scope": "", "scopeKind": ""}, {"name": "void sheensEngineInit(void)", "description": "Initializes the sheens engine, sets up context, JSON objects, function pointers, and registers the engine.", "scope": "", "scopeKind": ""}, {"name": "void freeSpecMap(void * key,void * value)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool handle_step_crew(cJSON * machine,cJSON * stepJson)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void handle_step_info(cJSON * stepJson,uint32_t * consumed,cJSON ** emitted)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool sheens_is_valid(const char * specification)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char * spec_provider(void * ctx,const char * specName,const char * cached)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void updateCrewState(void)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["mach_make_ctx", "mach_set_ctx", "mach_open", "mach_close", "hashMapCreate", "hashMapDelete", "hashMapGet", "hashMapPut", "cJSON_CreateObject", "cJSON_AddItemToObjectCS", "cJSON_CreateString", "cJSON_CreateStringReference", "cJSON_CreateObject", "cJSON_Parse", "cJSON_Delete", "cJSON_GetObjectItem", "cJSON_DetachItemFromObject", "cJSON_ReplaceItemInObject", "cJSON_HasObjectItem", "cJSON_IsTrue", "cJSON_IsArray", "cJSON_GetArraySize", "cJSON_Delete", "cJSON_PrintUnformatted", "cJSON_PrintBuffered", "cJSON_Duplicate"], "search-terms": ["sheens", "littlesheens", "crew state", "automation engine", "specification management", "JSON crew", "machine enable", "machine disable", "process message"], "state": 2, "file_id": 1185, "knowledge_revision": 14345, "git_revision": "", "ctags": [{"_type": "tag", "name": "AUTOMATIONS_PROP", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define AUTOMATIONS_PROP /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "CONSUMED_PROP", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define CONSUMED_PROP /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "CREW_BUFFER_STEP_SIZE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define CREW_BUFFER_STEP_SIZE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "HASHMAP_KEYLEN", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define HASHMAP_KEYLEN(/", "file": true, "language": "C", "kind": "macro", "signature": "(key)"}, {"_type": "tag", "name": "ID_PROP", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define ID_PROP /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "JSON_CREW_BINDINGS", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define JSON_CREW_BINDINGS /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "JSON_CREW_ID", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define JSON_CREW_ID /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "JSON_CREW_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define JSON_CREW_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "JSON_EMITTED", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define JSON_EMITTED /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "MACHINES_PROP", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define MACHINES_PROP /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "START_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define START_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "STEPPEDS_BUFFER_STEP_SIZE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define STEPPEDS_BUFFER_STEP_SIZE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TO_PROP", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define TO_PROP /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "crew", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static cJSON* crew;$/", "file": true, "language": "C", "typeref": "typename:cJSON *", "kind": "variable"}, {"_type": "tag", "name": "crewMachines", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static cJSON* crewMachines; \\/\\/ Belongs to 'crew'$/", "file": true, "language": "C", "typeref": "typename:cJSON *", "kind": "variable"}, {"_type": "tag", "name": "freeSpecMap", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static void freeSpecMap(void* key, void* value)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void * key,void * value)"}, {"_type": "tag", "name": "handle_step_crew", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static bool handle_step_crew(cJSON* machine, cJSON* stepJson)$/", "file": true, "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "(cJSON * machine,cJSON * stepJson)"}, {"_type": "tag", "name": "handle_step_info", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static void handle_step_info(cJSON* stepJson, uint32_t* consumed, cJSON** emitted)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(cJSON * stepJson,uint32_t * consumed,cJSON ** emitted)"}, {"_type": "tag", "name": "mutex", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;$/", "file": true, "language": "C", "typeref": "typename:pthread_mutex_t", "kind": "variable"}, {"_type": "tag", "name": "needStateUpdate", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static bool needStateUpdate = true;$/", "file": true, "language": "C", "typeref": "typename:bool", "kind": "variable"}, {"_type": "tag", "name": "ops", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static automationEngineOps ops = {$/", "file": true, "language": "C", "typeref": "typename:automationEngineOps", "kind": "variable"}, {"_type": "tag", "name": "sheensContext", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static void* sheensContext;$/", "file": true, "language": "C", "typeref": "typename:void *", "kind": "variable"}, {"_type": "tag", "name": "sheensEngineInit", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^void sheensEngineInit(void)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "sheens_destroy", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static void sheens_destroy(void)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "sheens_disable", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static void sheens_disable(const char* id)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(const char * id)"}, {"_type": "tag", "name": "sheens_enable", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static bool sheens_enable(const char* id, const char* specification)$/", "file": true, "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "(const char * id,const char * specification)"}, {"_type": "tag", "name": "sheens_get_state", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static cJSON* sheens_get_state(const char* id)$/", "file": true, "language": "C", "typeref": "typename:cJSON *", "kind": "function", "signature": "(const char * id)"}, {"_type": "tag", "name": "sheens_is_valid", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static bool sheens_is_valid(const char* specification)$/", "file": true, "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "(const char * specification)"}, {"_type": "tag", "name": "sheens_process", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static cJSON* sheens_process(const cJSON* message, cJSON* stats)$/", "file": true, "language": "C", "typeref": "typename:cJSON *", "kind": "function", "signature": "(const cJSON * message,cJSON * stats)"}, {"_type": "tag", "name": "sheens_version_key", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^#define sheens_version_key /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "specMap", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static icHashMap* specMap;$/", "file": true, "language": "C", "typeref": "typename:icHashMap *", "kind": "variable"}, {"_type": "tag", "name": "spec_provider", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static char* spec_provider(void* ctx, const char* specName, const char* cached)$/", "file": true, "language": "C", "typeref": "typename:char *", "kind": "function", "signature": "(void * ctx,const char * specName,const char * cached)"}, {"_type": "tag", "name": "state", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static char* state;$/", "file": true, "language": "C", "typeref": "typename:char *", "kind": "variable"}, {"_type": "tag", "name": "state_size", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static size_t state_size = CREW_BUFFER_STEP_SIZE;$/", "file": true, "language": "C", "typeref": "typename:size_t", "kind": "variable"}, {"_type": "tag", "name": "stepped_size", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static size_t stepped_size = STEPPEDS_BUFFER_STEP_SIZE;$/", "file": true, "language": "C", "typeref": "typename:size_t", "kind": "variable"}, {"_type": "tag", "name": "steppeds", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static char* steppeds;$/", "file": true, "language": "C", "typeref": "typename:char *", "kind": "variable"}, {"_type": "tag", "name": "updateCrewState", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "pattern": "/^static void updateCrewState(void)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}], "hash": "9856319a920870e3eade319825f781e7", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "components/opensource/zilker-sdk/source/services/automation/core/src/engines/sheens.c", "fields": [{"name": "cJSON * crew", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "cJSON * crewMachines", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pthread_mutex_t mutex", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool needStateUpdate", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "automationEngineOps ops", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void * sheensContext", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "icHashMap * specMap", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char * state", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "size_t state_size", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "size_t stepped_size", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char * steppeds", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"14345": ""}]}