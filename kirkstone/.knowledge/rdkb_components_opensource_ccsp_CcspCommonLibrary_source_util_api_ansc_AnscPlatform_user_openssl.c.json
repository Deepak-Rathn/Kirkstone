{"is_source_file": true, "format": "C source code", "description": "This file contains initialization, configuration, and utility functions for managing OpenSSL-based SSL/TLS connections, including setting up threading, loading CA certificates, establishing client/server SSL connections, and certificate validation.", "external_files": ["user_openssl.h", "pthread.h", "openssl/crypto.h", "openssl/x509v3.h", "ansc_platform.h", "ccsp_base_api.h"], "external_methods": ["RAND_load_file", "SSL_library_init", "SSL_load_error_strings", "SSLeay_add_all_algorithms", "SSLeay_add_ssl_algorithms", "SSL_CTX_load_verify_locations", "SSL_CTX_new", "SSL_CTX_use_certificate_file", "SSL_CTX_use_PrivateKey_file", "SSL_CTX_set_verify", "SSL_CTX_set_mode", "SSL_CTX_set_options", "SSL_CTX_set_quiet_shutdown", "SSL_library_init", "SSL_load_error_strings", "SSLv23_method", "SSL_get_peer_certificate", "SSL_get_verify_result", "SSL_new", "SSL_set_fd", "SSL_set_connect_state", "SSL_connect", "SSL_get_version", "SSL_get_state", "SSL_get_verify_result", "SSL_free", "SSL_accept", "SSL_read", "SSL_write", "SSL_pending", "SSL_get0_param", "X509_VERIFY_PARAM_set_hostflags", "X509_VERIFY_PARAM_set1_host", "X509_VERIFY_PARAM_add1_host", "X509_get_subject_name", "X509_get_issuer_name", "X509_NAME_oneline", "X509_NAME_get_text_by_NID", "X509_free", "ERR_get_error", "ERR_error_string", "CRYPTO_num_locks", "CRYPTO_set_locking_callback", "CRYPTO_set_id_callback"], "published": ["initialize_openssl_lib", "openssl_load_ca_certificates", "openssl_init", "openssl_connect", "openssl_accept", "openssl_validate_certificate"], "classes": [], "methods": [{"name": "void initialize_openssl_lib()", "description": "Initializes the OpenSSL library, loads PRNG seed, and sets up cryptographic algorithms.", "scope": "", "scopeKind": ""}, {"name": "void openssl_thread_setup(void)", "description": "Sets up thread locking callbacks for OpenSSL in multi-threaded environments.", "scope": "", "scopeKind": ""}, {"name": "void openssl_print_errors(SSL * ssl)", "description": "Prints the current OpenSSL error stack and verifies SSL certificates, providing diagnostics.", "scope": "", "scopeKind": ""}, {"name": "int openssl_load_ca_certificates(int who_calls)", "description": "Loads CA certificates from specified files for client or server verification.", "scope": "", "scopeKind": ""}, {"name": "int openssl_init(int who_calls)", "description": "Initializes SSL context for client or server, sets options and loads certificates.", "scope": "", "scopeKind": ""}, {"name": "int openssl_read(int fd,char * buf,int bufsize,void * ctx)", "description": "Performs SSL read operation from a socket.", "scope": "", "scopeKind": ""}, {"name": "int openssl_write(int fd,char * buf,int bufsize,void * ctx)", "description": "Performs SSL write operation to a socket.", "scope": "", "scopeKind": ""}, {"name": "SSL * openssl_connect(int fd,hostNames * hosts)", "description": "Establishes an SSL connection to a server given a socket and host information.", "scope": "", "scopeKind": ""}, {"name": "SSL * openssl_accept(int conn_fd)", "description": "Performs SSL handshake on a socket to accept an incoming SSL connection.", "scope": "", "scopeKind": ""}, {"name": "int _client_openssl_validate_certificate(int fd,char * host,SSL * ssl,bool isSecure)", "description": "Validates peer certificate during client-side SSL connection, including hostname verification.", "scope": "", "scopeKind": ""}, {"name": "int _server_openssl_validate_certificate(int fd,char * data,SSL * ssl)", "description": "Placeholder for server-side certificate validation during SSL handshake.", "scope": "", "scopeKind": ""}, {"name": "int openssl_validate_certificate(int fd,char * data,SSL * ssl,int who_calls,bool isSecure)", "description": "Delegates to client or server validation function based on call type.", "scope": "", "scopeKind": ""}, {"name": "int openssl_poll(int fd,long timeout,int set,void * ctx)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int openssl_select_fd(int fd,long maxtime,int set)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["RAND_load_file", "SSL_library_init", "SSL_load_error_strings", "SSLeay_add_all_algorithms", "SSLeay_add_ssl_algorithms", "SSL_CTX_load_verify_locations", "SSL_CTX_new", "SSL_CTX_use_certificate_file", "SSL_CTX_use_PrivateKey_file", "SSL_CTX_set_verify", "SSL_CTX_set_mode", "SSL_CTX_set_options", "SSL_CTX_set_quiet_shutdown", "SSL_new", "SSL_set_fd", "SSL_set_connect_state", "SSL_connect", "SSL_get_peer_certificate", "SSL_get_verify_result", "SSL_free", "SSL_accept", "SSL_read", "SSL_write", "SSL_pending", "SSL_get0_param", "X509_VERIFY_PARAM_set_hostflags", "X509_VERIFY_PARAM_set1_host", "X509_VERIFY_PARAM_add1_host", "X509_get_subject_name", "X509_get_issuer_name", "X509_NAME_oneline", "X509_NAME_get_text_by_NID", "X509_free", "ERR_get_error", "ERR_error_string", "CRYPTO_num_locks", "CRYPTO_set_locking_callback", "CRYPTO_set_id_callback"], "search-terms": ["openssl", "SSL_CTX", "certificate verification", "thread safety", "RSA seed", "SSL connection", "hostname verification", "client SSL", "server SSL", "certificate loading"], "state": 2, "file_id": 10762, "knowledge_revision": 23738, "git_revision": "", "ctags": [{"_type": "tag", "name": "AnscTrace", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^    #define  AnscTrace /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "AnscTraceWarning", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^    #define  AnscTraceWarning(/", "file": true, "language": "C", "kind": "macro", "signature": "(msg)"}, {"_type": "tag", "name": "DEVICE_PROPERTIES", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^#define DEVICE_PROPERTIES /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "USER_OPENSSL_Redirect_AnscTrace", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^#define  USER_OPENSSL_Redirect_AnscTrace /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "_client_openssl_validate_certificate", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^static int _client_openssl_validate_certificate (int fd,  char *host, SSL *ssl, bool isSecure)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int fd,char * host,SSL * ssl,bool isSecure)"}, {"_type": "tag", "name": "_server_openssl_validate_certificate", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^static int _server_openssl_validate_certificate (int fd, char *data, SSL *ssl)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int fd,char * data,SSL * ssl)"}, {"_type": "tag", "name": "g_ssl_ctx", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^static SSL_CTX *g_ssl_ctx[SSL_CTX_NUM];$/", "file": true, "language": "C", "typeref": "typename:SSL_CTX * []", "kind": "variable"}, {"_type": "tag", "name": "initialize_openssl_lib", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^void initialize_openssl_lib()$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "lock_count", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^static int *lock_count;$/", "file": true, "language": "C", "typeref": "typename:int *", "kind": "variable"}, {"_type": "tag", "name": "locks", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^static pthread_mutex_t *locks;$/", "file": true, "language": "C", "typeref": "typename:pthread_mutex_t *", "kind": "variable"}, {"_type": "tag", "name": "openssl_accept", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^SSL * openssl_accept (int conn_fd)$/", "language": "C", "typeref": "typename:SSL *", "kind": "function", "signature": "(int conn_fd)"}, {"_type": "tag", "name": "openssl_client_ca_certificate_files", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^char* openssl_client_ca_certificate_files = NULL;$/", "language": "C", "typeref": "typename:char *", "kind": "variable"}, {"_type": "tag", "name": "openssl_connect", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^SSL * openssl_connect (int fd, hostNames *hosts)$/", "language": "C", "typeref": "typename:SSL *", "kind": "function", "signature": "(int fd,hostNames * hosts)"}, {"_type": "tag", "name": "openssl_init", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^int openssl_init (int who_calls)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int who_calls)"}, {"_type": "tag", "name": "openssl_is_initialized", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^static pthread_once_t openssl_is_initialized = PTHREAD_ONCE_INIT;$/", "file": true, "language": "C", "typeref": "typename:pthread_once_t", "kind": "variable"}, {"_type": "tag", "name": "openssl_load_ca_certificates", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^int openssl_load_ca_certificates(int who_calls)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int who_calls)"}, {"_type": "tag", "name": "openssl_poll", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^int openssl_poll (int fd, long timeout, int set, void *ctx)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int fd,long timeout,int set,void * ctx)"}, {"_type": "tag", "name": "openssl_print_errors", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^openssl_print_errors (SSL *ssl)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(SSL * ssl)"}, {"_type": "tag", "name": "openssl_read", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^int openssl_read (int fd, char *buf, int bufsize, void *ctx)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int fd,char * buf,int bufsize,void * ctx)"}, {"_type": "tag", "name": "openssl_select_fd", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^int openssl_select_fd (int fd, long maxtime, int set)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int fd,long maxtime,int set)"}, {"_type": "tag", "name": "openssl_server_ca_certificate_files", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^char* openssl_server_ca_certificate_files = NULL;$/", "language": "C", "typeref": "typename:char *", "kind": "variable"}, {"_type": "tag", "name": "openssl_thread_setup", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^static void openssl_thread_setup(void)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "openssl_validate_certificate", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^int openssl_validate_certificate (int fd, char * data, SSL *ssl, int who_calls, bool isSecure)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int fd,char * data,SSL * ssl,int who_calls,bool isSecure)"}, {"_type": "tag", "name": "openssl_write", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "pattern": "/^int openssl_write (int fd, char *buf, int bufsize, void *ctx)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int fd,char * buf,int bufsize,void * ctx)"}], "hash": "d10d9edab6a4852152c0106f4c0090cf", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/CcspCommonLibrary/source/util_api/ansc/AnscPlatform/user_openssl.c", "fields": [{"name": "SSL_CTX * [] g_ssl_ctx", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int * lock_count", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pthread_mutex_t * locks", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char * openssl_client_ca_certificate_files", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pthread_once_t openssl_is_initialized", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char * openssl_server_ca_certificate_files", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"23738": ""}]}