{"is_source_file": true, "format": "C", "description": "This source file implements the 'service_dslite' utility for managing IPv6 transition mechanisms (DS-Lite). It provides functions for starting, stopping, restarting, and clearing the DS-Lite tunnel service, along with supporting DNS resolution, route configuration, firewall rule management, and system configuration updates. The file appears to be the main source code for a daemon or command-line utility intended for network configuration tasks related to IPv6 transition services.", "external_files": ["sysevent/sysevent.h", "syscfg/syscfg.h", "util.h", "time.h", "safec_lib_common.h", "secure_wrapper.h", "<stdio.h>", "<stdlib.h>", "<string.h>", "<unistd.h>", "<stdarg.h>", "<signal.h>", "<sys/ioctl.h>", "<net/if.h>", "<netdb.h>", "<sys/socket.h>", "<netinet/in.h>", "<arpa/inet.h>", "<semaphore.h>", "<sys/types.h>", "<sys/stat.h>", "<fcntl.h>", "<event2/dns.h>", "<event2/util.h>", "<event2/event.h>"], "external_methods": ["sysevent_open", "sysevent_close", "sysevent_get", "sysevent_set", "sysevent_set_unique", "syscfg_get", "syscfg_set", "syscfg_unset", "v_secure_system", "v_secure_popen", "v_secure_pclose", "sysctl_iface_set", "ERR_CHK"], "published": ["main"], "classes": [], "methods": [{"name": "dso_start", "description": "Starts the DS-Lite service, setting up tunnels, routing, firewall rules, and configuration parameters."}, {"name": "dso_stop", "description": "Stops the DS-Lite service and cleans up related system configurations."}, {"name": "dso_restart", "description": "Restarts the DS-Lite service by stopping and then starting it again."}, {"name": "dso_clear_status", "description": "Clears the DS-Lite status information in system configuration."}, {"name": "void usage(void)", "description": "Displays command usage information.", "scope": "", "scopeKind": ""}, {"name": "int main(int argc,char * argv[])", "description": "Entry point; parses command line arguments and executes corresponding commands for managing the DS-Lite service.", "scope": "", "scopeKind": ""}, {"name": "void _get_shell_output(FILE * fp,char * buf,size_t len)", "description": "Reads output from a shell command execution into a buffer.", "scope": "", "scopeKind": ""}, {"name": "void route_config(struct serv_dslite * sd)", "description": "Configures routing rules related to the DS-Lite service.", "scope": "", "scopeKind": ""}, {"name": "void route_deconfig(struct serv_dslite * sd)", "description": "Removes routing rules related to the DS-Lite service.", "scope": "", "scopeKind": ""}, {"name": "int serv_dslite_init(struct serv_dslite * sd)", "description": "Initializes internal state and opens system event handles.", "scope": "", "scopeKind": ""}, {"name": "int serv_dslite_term(struct serv_dslite * sd)", "description": "Cleans up system event handles.", "scope": "", "scopeKind": ""}, {"name": "void dns_cb(int result,char type,int count,int ttl,void * addresses,void * arg)", "description": "Callback for DNS resolution results.", "scope": "", "scopeKind": ""}, {"name": "struct:in6_addr * dslite_resolve_fqdn_to_ipv6addr(const char * name,unsigned int * dnsttl,const char * nameserver)", "description": "Performs DNS resolution of a domain to an IPv6 address.", "scope": "", "scopeKind": ""}, {"name": "int get_aftr(struct serv_dslite * sd,char * DSLITE_AFTR,char * dslite_mode,char * dslite_addr_type,int size_aftr)", "description": "Determines the AFTR address from DHCP or static configuration.", "scope": "", "scopeKind": ""}, {"name": "void wan_dhcp_stop(void)", "description": "Stops the DHCPv4 client.", "scope": "", "scopeKind": ""}, {"name": "void restart_zebra(struct serv_dslite * sd)", "description": "Restarts the Zebra routing daemon if needed.", "scope": "", "scopeKind": ""}, {"name": "int dslite_clear_status(struct serv_dslite * sd)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int dslite_restart(struct serv_dslite * sd)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int dslite_start(struct serv_dslite * sd)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int dslite_stop(struct serv_dslite * sd)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["sysevent_open", "sysevent_close", "sysevent_get", "sysevent_set", "sysevent_set_unique", "syscfg_get", "syscfg_set", "syscfg_unset", "v_secure_system", "v_secure_popen", "v_secure_pclose", "sysctl_iface_set", "evdns_base_new", "evdns_base_resolve_ipv6", "evdns_base_nameserver_ip_add", "event_base_new", "event_base_dispatch", "event_base_loopexit", "event_base_free", "evdns_base_free", "inet_pton", "inet_ntop", "malloc", "free", "strcpy_s", "strtok", "strstr", "strcasecmp", "kill", "unlink", "fprintf", "snprintf", "systemctl", "service_wan", "sysctl_iface_set", "conntrack_flush"], "search-terms": ["service_dslite", "DSLITE", "AFTR", "ipv6_nameserver", "dslite_enable", "dslite_active", "DSLITE_AFTR", "TNL_NETDEVNAME", "wan6_ipaddr", "sysevent", "ipv6", "DNS", "ip6tunnel", "IPv6 transition", "DS-Lite"], "state": 2, "file_id": 7660, "knowledge_revision": 20731, "git_revision": "", "ctags": [{"_type": "tag", "name": "ER_NETDEVNAME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^#define ER_NETDEVNAME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "PROG_NAME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^#define PROG_NAME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SEM_POST", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^#define SEM_POST /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SEM_WAIT", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^#define SEM_WAIT /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SVC_DSLITE_LOG", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^#define SVC_DSLITE_LOG /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TNL_NETDEVNAME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^#define TNL_NETDEVNAME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TNL_WANDEVNAME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^#define TNL_WANDEVNAME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "WAN_RTMOD_BRIDGE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^    WAN_RTMOD_BRIDGE,   \\/\\/ COSA_DML_DEVICE_MODE_Bridge$/", "file": true, "language": "C", "kind": "enumerator", "scope": "wan_rt_mod", "scopeKind": "enum"}, {"_type": "tag", "name": "WAN_RTMOD_DS", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^    WAN_RTMOD_DS,       \\/\\/ COSA_DML_DEVICE_MODE_Dualstack$/", "file": true, "language": "C", "kind": "enumerator", "scope": "wan_rt_mod", "scopeKind": "enum"}, {"_type": "tag", "name": "WAN_RTMOD_IPV4", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^    WAN_RTMOD_IPV4,     \\/\\/ COSA_DML_DEVICE_MODE_Ipv4$/", "file": true, "language": "C", "kind": "enumerator", "scope": "wan_rt_mod", "scopeKind": "enum"}, {"_type": "tag", "name": "WAN_RTMOD_IPV6", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^    WAN_RTMOD_IPV6,     \\/\\/ COSA_DML_DEVICE_MODE_Ipv6$/", "file": true, "language": "C", "kind": "enumerator", "scope": "wan_rt_mod", "scopeKind": "enum"}, {"_type": "tag", "name": "WAN_RTMOD_UNKNOW", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^    WAN_RTMOD_UNKNOW,$/", "file": true, "language": "C", "kind": "enumerator", "scope": "wan_rt_mod", "scopeKind": "enum"}, {"_type": "tag", "name": "_get_shell_output", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static void _get_shell_output (FILE *fp, char *buf, size_t len)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(FILE * fp,char * buf,size_t len)"}, {"_type": "tag", "name": "cmd", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^    const char *cmd;$/", "file": true, "language": "C", "typeref": "typename:const char *", "kind": "member", "scope": "cmd_op", "scopeKind": "struct"}, {"_type": "tag", "name": "cmd_op", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^struct cmd_op {$/", "file": true, "language": "C", "kind": "struct"}, {"_type": "tag", "name": "cmd_ops", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static const struct cmd_op cmd_ops[] = {$/", "file": true, "language": "C", "typeref": "typename:const struct cmd_op[]", "kind": "variable"}, {"_type": "tag", "name": "desc", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^    const char *desc;$/", "file": true, "language": "C", "typeref": "typename:const char *", "kind": "member", "scope": "cmd_op", "scopeKind": "struct"}, {"_type": "tag", "name": "dns_cb", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static void dns_cb (int result, char type, int count, int ttl, void *addresses, void *arg)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(int result,char type,int count,int ttl,void * addresses,void * arg)"}, {"_type": "tag", "name": "dslite_clear_status", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static int dslite_clear_status (struct serv_dslite *sd)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(struct serv_dslite * sd)"}, {"_type": "tag", "name": "dslite_resolve_fqdn_to_ipv6addr", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static struct in6_addr *dslite_resolve_fqdn_to_ipv6addr (const char *name, unsigned int *dnsttl,/", "file": true, "language": "C", "typeref": "struct:in6_addr *", "kind": "function", "signature": "(const char * name,unsigned int * dnsttl,const char * nameserver)"}, {"_type": "tag", "name": "dslite_restart", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static int dslite_restart (struct serv_dslite *sd)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(struct serv_dslite * sd)"}, {"_type": "tag", "name": "dslite_start", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static int dslite_start (struct serv_dslite *sd)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(struct serv_dslite * sd)"}, {"_type": "tag", "name": "dslite_stop", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static int dslite_stop (struct serv_dslite *sd)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(struct serv_dslite * sd)"}, {"_type": "tag", "name": "exec", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^    int (*exec)(struct serv_dslite *sd);$/", "file": true, "language": "C", "typeref": "typename:int (*)(struct serv_dslite * sd)", "kind": "member", "scope": "cmd_op", "scopeKind": "struct"}, {"_type": "tag", "name": "exit_base", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static struct event_base *exit_base;$/", "file": true, "language": "C", "typeref": "struct:event_base *", "kind": "variable"}, {"_type": "tag", "name": "fp_dslt_dbg", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static FILE *fp_dslt_dbg;$/", "file": true, "language": "C", "typeref": "typename:FILE *", "kind": "variable"}, {"_type": "tag", "name": "get_aftr", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static int get_aftr (struct serv_dslite *sd, char *DSLITE_AFTR, char *dslite_mode, char *dslite_/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(struct serv_dslite * sd,char * DSLITE_AFTR,char * dslite_mode,char * dslite_addr_type,int size_aftr)"}, {"_type": "tag", "name": "in6_addrs", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static struct in6_addr *in6_addrs = NULL;$/", "file": true, "language": "C", "typeref": "struct:in6_addr *", "kind": "variable"}, {"_type": "tag", "name": "main", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^int main (int argc, char *argv[])$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int argc,char * argv[])"}, {"_type": "tag", "name": "restart_zebra", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static void restart_zebra (struct serv_dslite *sd)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(struct serv_dslite * sd)"}, {"_type": "tag", "name": "route_config", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static void route_config (struct serv_dslite *sd)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(struct serv_dslite * sd)"}, {"_type": "tag", "name": "route_deconfig", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static void route_deconfig (struct serv_dslite *sd)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(struct serv_dslite * sd)"}, {"_type": "tag", "name": "rtmod", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^    enum wan_rt_mod rtmod;$/", "file": true, "language": "C", "typeref": "enum:wan_rt_mod", "kind": "member", "scope": "serv_dslite", "scopeKind": "struct"}, {"_type": "tag", "name": "sefd", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^    int sefd;$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "member", "scope": "serv_dslite", "scopeKind": "struct"}, {"_type": "tag", "name": "sem", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static sem_t *sem = NULL;$/", "file": true, "language": "C", "typeref": "typename:sem_t *", "kind": "variable"}, {"_type": "tag", "name": "serv_dslite", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^struct serv_dslite {$/", "file": true, "language": "C", "kind": "struct"}, {"_type": "tag", "name": "serv_dslite_init", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static int serv_dslite_init (struct serv_dslite *sd)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(struct serv_dslite * sd)"}, {"_type": "tag", "name": "serv_dslite_term", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static int serv_dslite_term (struct serv_dslite *sd)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(struct serv_dslite * sd)"}, {"_type": "tag", "name": "setok", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^    int setok;$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "member", "scope": "serv_dslite", "scopeKind": "struct"}, {"_type": "tag", "name": "usage", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static void usage (void)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "wan_dhcp_stop", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^static void wan_dhcp_stop (void)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "wan_rt_mod", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "pattern": "/^enum wan_rt_mod {$/", "file": true, "language": "C", "kind": "enum"}], "hash": "fa5f2c80a241ddc373272ba28446fddd", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/Utopia/source/service_dslite/service_dslite.c", "fields": [{"name": "const char * cmd", "scope": "cmd_op", "scopeKind": "struct", "description": "unavailable"}, {"name": "const struct cmd_op[] cmd_ops", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "const char * desc", "scope": "cmd_op", "scopeKind": "struct", "description": "unavailable"}, {"name": "int (*)(struct serv_dslite * sd) exec", "scope": "cmd_op", "scopeKind": "struct", "description": "unavailable"}, {"name": "struct:event_base * exit_base", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "FILE * fp_dslt_dbg", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "struct:in6_addr * in6_addrs", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "enum:wan_rt_mod rtmod", "scope": "serv_dslite", "scopeKind": "struct", "description": "unavailable"}, {"name": "int sefd", "scope": "serv_dslite", "scopeKind": "struct", "description": "unavailable"}, {"name": "sem_t * sem", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int setok", "scope": "serv_dslite", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"20731": ""}]}