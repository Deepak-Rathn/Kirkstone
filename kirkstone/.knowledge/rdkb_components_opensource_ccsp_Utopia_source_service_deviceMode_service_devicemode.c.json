{"is_source_file": true, "format": "C", "description": "This file implements service management for device modes (router/extender) in a network device, including starting/stopping services, handling sys events, and interacting with configuration parameters via PSM. It provides command-line interface for mode changes and manages system services accordingly.", "external_files": ["sysevent/sysevent.h", "syscfg/syscfg.h", "util.h", "errno.h", "telemetry_busmessage_sender.h", "ccsp_dm_api.h", "ccsp_custom.h", "ccsp_psm_helper.h", "ccsp_base_api.h", "ccsp_memory.h", "print_uptime.h"], "external_methods": ["sysevent_open", "sysevent_close", "sysevent_set", "PsmGetNextLevelInstances", "PSM_Get_Record_Value2", "PSM_Set_Record_Value2", "CCSP_Message_Bus_Init", "CCSP_Message_Bus_Init_Synced", "CCSP_Message_Bus_Exit"], "published": ["main", "handleDeviceModeUpdate"], "classes": [], "methods": [{"name": "int InitBus(void)", "description": "Initializes message bus connection for inter-process communication.", "scope": "", "scopeKind": ""}, {"name": "int syseventInit()", "description": "Initializes sysevent client for system event notifications.", "scope": "", "scopeKind": ""}, {"name": "void syseventClose()", "description": "Closes the sysevent connection.", "scope": "", "scopeKind": ""}, {"name": "int service_close()", "description": "Cleans up sysevent and message bus before exit.", "scope": "", "scopeKind": ""}, {"name": "int read_cmd_output(char * cmd,char * output_buf,int size_buf)", "description": "Reads command output from a shell command into a buffer.", "scope": "", "scopeKind": ""}, {"name": "int runCommandInShell(char * command)", "description": "Executes a shell command asynchronously.", "scope": "", "scopeKind": ""}, {"name": "int collectProcess(int pid,int timeout)", "description": "Waits for a process to terminate within a timeout.", "scope": "", "scopeKind": ""}, {"name": "int runCommandInShellBlocking(char * command)", "description": "Runs a shell command synchronously, waiting for completion.", "scope": "", "scopeKind": ""}, {"name": "int service_stop(int mode)", "description": "Stops services based on device mode (router/extender).", "scope": "", "scopeKind": ""}, {"name": "int GetL2InterfaceNameFromPsm(int instanceNumber,char * pName,int len)", "description": "Retrieves the L2 interface name from the PSM configuration.", "scope": "", "scopeKind": ""}, {"name": "int service_start(int mode)", "description": "Starts services based on device mode (router/extender).", "scope": "", "scopeKind": ""}, {"name": "char * get_mode(int mode)", "description": "Returns a string representation of the device mode.", "scope": "", "scopeKind": ""}, {"name": "int handleDeviceModeUpdate(int newMode)", "description": "Handles update to device mode, restarting services accordingly.", "scope": "", "scopeKind": ""}, {"name": "int main(int argc,char * argv[])", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["sysevent_set", "sleep", "printf", "strncpy", "snprintf", "close", "kill", "execv", "fork", "waitpid", "usleep", "Ansc_FreeMemory_Callback", "syscfg_get"], "search-terms": ["device_mode", "sysevent", "ccsp_psm_helper", "service_devicemode", "RBAC", "mode-switching", "networking configuration", "system services start stop"], "state": 2, "file_id": 7742, "knowledge_revision": 20810, "git_revision": "", "ctags": [{"_type": "tag", "name": "CCSP_SUBSYS", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define CCSP_SUBSYS /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "COLLECT_WAIT_INTERVAL_MS", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define COLLECT_WAIT_INTERVAL_MS /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "DEVICE_MODE_EXTENDER", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^    DEVICE_MODE_EXTENDER$/", "file": true, "language": "C", "kind": "enumerator", "scope": "deviceMode", "scopeKind": "enum"}, {"_type": "tag", "name": "DEVICE_MODE_ROUTER", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^    DEVICE_MODE_ROUTER,$/", "file": true, "language": "C", "kind": "enumerator", "scope": "deviceMode", "scopeKind": "enum"}, {"_type": "tag", "name": "GetL2InterfaceNameFromPsm", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^int GetL2InterfaceNameFromPsm(int instanceNumber, char *pName, int len)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int instanceNumber,char * pName,int len)"}, {"_type": "tag", "name": "InitBus", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^int InitBus( void )$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "LNF_MULTINET_INSTANCE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define LNF_MULTINET_INSTANCE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "LOGGING_MODULE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define LOGGING_MODULE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "MSECS_IN_SEC", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define MSECS_IN_SEC /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "OnboardLog", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define OnboardLog(/", "file": true, "language": "C", "kind": "macro", "signature": "(...)"}, {"_type": "tag", "name": "PRIVLAN_L3INST", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define PRIVLAN_L3INST /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "PSM_L2_BRIDGENAME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define PSM_L2_BRIDGENAME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "PSM_NAME_NETWORKING_DEVICE_MODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define PSM_NAME_NETWORKING_DEVICE_MODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "PSM_VALUE_GET_INS", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define PSM_VALUE_GET_INS(/", "file": true, "language": "C", "kind": "macro", "signature": "(name,pIns,ppInsArry)"}, {"_type": "tag", "name": "PSM_VALUE_GET_STRING", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define PSM_VALUE_GET_STRING(/", "file": true, "language": "C", "kind": "macro", "signature": "(name,str)"}, {"_type": "tag", "name": "PSM_VALUE_SET_STRING", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define PSM_VALUE_SET_STRING(/", "file": true, "language": "C", "kind": "macro", "signature": "(name,str)"}, {"_type": "tag", "name": "RETURN_ERROR", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define RETURN_ERROR /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "RETURN_OK", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define RETURN_OK /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ROUTER_MODE_SERVICES_PATH_1", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define ROUTER_MODE_SERVICES_PATH_1 /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "USECS_IN_MSEC", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define USECS_IN_MSEC /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "XHS_BRIDGE_NAME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define XHS_BRIDGE_NAME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "XHS_L3INST", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^#define XHS_L3INST /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "bus_handle", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^static void* bus_handle = NULL;$/", "file": true, "language": "C", "typeref": "typename:void *", "kind": "variable"}, {"_type": "tag", "name": "collectProcess", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^int collectProcess(int pid, int timeout)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int pid,int timeout)"}, {"_type": "tag", "name": "deviceMode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^typedef enum deviceMode$/", "file": true, "language": "C", "kind": "enum"}, {"_type": "tag", "name": "deviceMode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^}deviceMode;$/", "file": true, "language": "C", "typeref": "enum:deviceMode", "kind": "typedef"}, {"_type": "tag", "name": "get_mode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^char* get_mode(int mode)$/", "language": "C", "typeref": "typename:char *", "kind": "function", "signature": "(int mode)"}, {"_type": "tag", "name": "handleDeviceModeUpdate", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^int handleDeviceModeUpdate (int newMode)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int newMode)"}, {"_type": "tag", "name": "main", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^int main(int argc, char *argv[])$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int argc,char * argv[])"}, {"_type": "tag", "name": "read_cmd_output", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^int read_cmd_output(char *cmd, char *output_buf, int size_buf)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * cmd,char * output_buf,int size_buf)"}, {"_type": "tag", "name": "runCommandInShell", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^int runCommandInShell(char *command)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * command)"}, {"_type": "tag", "name": "runCommandInShellBlocking", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^int runCommandInShellBlocking(char *command)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * command)"}, {"_type": "tag", "name": "service_close", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^int service_close ()$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "service_devicemode_component_id", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^static const char* const service_devicemode_component_id = \"ccsp.devicemode\";$/", "file": true, "language": "C", "typeref": "typename:const char * const", "kind": "variable"}, {"_type": "tag", "name": "service_start", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^int service_start(int mode)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int mode)"}, {"_type": "tag", "name": "service_stop", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^int service_stop(int mode)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int mode)"}, {"_type": "tag", "name": "syseventClose", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^void syseventClose()$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "syseventInit", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^int syseventInit()$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "sysevent_fd", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^static int            sysevent_fd = -1;$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "sysevent_ip", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^static char           sysevent_ip[19];$/", "file": true, "language": "C", "typeref": "typename:char[19]", "kind": "variable"}, {"_type": "tag", "name": "sysevent_name", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^static char          *sysevent_name = \"devicemode\";$/", "file": true, "language": "C", "typeref": "typename:char *", "kind": "variable"}, {"_type": "tag", "name": "sysevent_port", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^static unsigned short sysevent_port;$/", "file": true, "language": "C", "typeref": "typename:unsigned short", "kind": "variable"}, {"_type": "tag", "name": "sysevent_token", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "pattern": "/^static token_t        sysevent_token;$/", "file": true, "language": "C", "typeref": "typename:token_t", "kind": "variable"}], "hash": "23af69399b142c166638767c987b1379", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/Utopia/source/service_deviceMode/service_devicemode.c", "fields": [{"name": "void * bus_handle", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "const char * const service_devicemode_component_id", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int sysevent_fd", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char[19] sysevent_ip", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char * sysevent_name", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "unsigned short sysevent_port", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "token_t sysevent_token", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"20810": ""}]}