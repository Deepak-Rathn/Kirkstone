{"is_source_file": true, "format": "C++", "description": "This file contains Google Test (gtest/gmock) unit tests for the CcspAdvSecurity module, specifically testing the start and stop features of the advsec security system, as well as initialization and de-initialization routines for the agent. It sets up mock expectations and verifies that system commands and configuration settings are handled correctly.", "external_files": ["gtest/gtest.h", "gmock/gmock.h", "test/mocks/mock_advsec_internal.h", "test/mocks/cosa_adv_security_internal_mock.h"], "external_methods": ["v_secure_system()", "CosaSetSysCfgUlong()", "CosaAdvSecStartFeatures()", "CosaAdvSecStopFeatures()", "CosaAdvSecAgentRaptrInit()", "CosaAdvSecAgentRaptrDeInit()"], "published": ["g_pAdvSecAgent", "g_AdvsecInternalMock"], "classes": [{"name": "CcspAdvSecurityDmlTestFixture", "description": "A test fixture class inheriting from ::testing::Test, used to set up and tear down mocks for each test case. It manages the static mock object pointer and ensures correct mock configuration."}], "methods": [{"name": "ccsp_advsec_start_features_sb", "description": "Tests starting the Safe Browsing feature, verifying system calls, configuration write, and the enable flag update."}, {"name": "ccsp_advsec_start_features_sf", "description": "Tests starting the Softflowd feature with similar validation as above."}, {"name": "ccsp_advsec_start_features_sb_sf", "description": "Tests starting both Safe Browsing and Softflowd features simultaneously."}, {"name": "ccsp_advsec_stop_features_sb", "description": "Tests stopping the Safe Browsing feature, confirming configuration is updated and the enable flag is cleared."}, {"name": "ccsp_advsec_stop_features_sf", "description": "Tests stopping the Softflowd feature similarly."}, {"name": "ccsp_advsec_stop_features_sb_sf", "description": "Tests stopping both features together and asserts proper configuration updates."}, {"name": "Cosa_AdvSec_Agent_Raptr_Init", "description": "Verifies initialization of the agent's Raptr feature, including mock expectations and configuration update."}, {"name": "Cosa_AdvSec_Agent_Raptr_DeInit", "description": "Verifies de-initialization of the Raptr feature in the agent, including mock expectations and configuration write."}, {"name": "CcspAdvSecurityDmlTestFixture()", "scope": "CcspAdvSecurityDmlTestFixture", "scopeKind": "class", "description": "unavailable"}, {"name": "TEST_F(CcspAdvSecurityDmlTestFixture,Cosa_AdvSec_Agent_Raptr_DeInit)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TEST_F(CcspAdvSecurityDmlTestFixture,Cosa_AdvSec_Agent_Raptr_Init)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TEST_F(CcspAdvSecurityDmlTestFixture,ccsp_advsec_start_features_sb)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TEST_F(CcspAdvSecurityDmlTestFixture,ccsp_advsec_start_features_sb_sf)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TEST_F(CcspAdvSecurityDmlTestFixture,ccsp_advsec_start_features_sf)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TEST_F(CcspAdvSecurityDmlTestFixture,ccsp_advsec_stop_features_sb)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TEST_F(CcspAdvSecurityDmlTestFixture,ccsp_advsec_stop_features_sb_sf)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TEST_F(CcspAdvSecurityDmlTestFixture,ccsp_advsec_stop_features_sf)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "~CcspAdvSecurityDmlTestFixture()", "scope": "CcspAdvSecurityDmlTestFixture", "scopeKind": "class", "description": "unavailable"}], "calls": ["v_secure_system()", "CosaSetSysCfgUlong()", "CosaAdvSecStartFeatures()", "CosaAdvSecStopFeatures()", "CosaAdvSecAgentRaptrInit()", "CosaAdvSecAgentRaptrDeInit()"], "search-terms": ["CcspAdvSecurityDmlTestCpp", "advsec_start_features", "advsec_stop_features", "Raptr", "SafeBrowsing", "Softflowd", "agent initialization", "mock advsec internal"], "state": 2, "file_id": 5856, "knowledge_revision": 18963, "git_revision": "", "ctags": [{"_type": "tag", "name": "CcspAdvSecurityDmlTestFixture", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^        CcspAdvSecurityDmlTestFixture()$/", "file": true, "language": "C++", "kind": "function", "signature": "()", "scope": "CcspAdvSecurityDmlTestFixture", "scopeKind": "class"}, {"_type": "tag", "name": "CcspAdvSecurityDmlTestFixture", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^class CcspAdvSecurityDmlTestFixture : public ::testing::Test {$/", "file": true, "language": "C++", "kind": "class"}, {"_type": "tag", "name": "TEST_F", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^TEST_F(CcspAdvSecurityDmlTestFixture, Cosa_AdvSec_Agent_Raptr_DeInit)$/", "language": "C++", "kind": "function", "signature": "(CcspAdvSecurityDmlTestFixture,Cosa_AdvSec_Agent_Raptr_DeInit)"}, {"_type": "tag", "name": "TEST_F", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^TEST_F(CcspAdvSecurityDmlTestFixture, Cosa_AdvSec_Agent_Raptr_Init)$/", "language": "C++", "kind": "function", "signature": "(CcspAdvSecurityDmlTestFixture,Cosa_AdvSec_Agent_Raptr_Init)"}, {"_type": "tag", "name": "TEST_F", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^TEST_F(CcspAdvSecurityDmlTestFixture, ccsp_advsec_start_features_sb)$/", "language": "C++", "kind": "function", "signature": "(CcspAdvSecurityDmlTestFixture,ccsp_advsec_start_features_sb)"}, {"_type": "tag", "name": "TEST_F", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^TEST_F(CcspAdvSecurityDmlTestFixture, ccsp_advsec_start_features_sb_sf)$/", "language": "C++", "kind": "function", "signature": "(CcspAdvSecurityDmlTestFixture,ccsp_advsec_start_features_sb_sf)"}, {"_type": "tag", "name": "TEST_F", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^TEST_F(CcspAdvSecurityDmlTestFixture, ccsp_advsec_start_features_sf)$/", "language": "C++", "kind": "function", "signature": "(CcspAdvSecurityDmlTestFixture,ccsp_advsec_start_features_sf)"}, {"_type": "tag", "name": "TEST_F", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^TEST_F(CcspAdvSecurityDmlTestFixture, ccsp_advsec_stop_features_sb)$/", "language": "C++", "kind": "function", "signature": "(CcspAdvSecurityDmlTestFixture,ccsp_advsec_stop_features_sb)"}, {"_type": "tag", "name": "TEST_F", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^TEST_F(CcspAdvSecurityDmlTestFixture, ccsp_advsec_stop_features_sb_sf)$/", "language": "C++", "kind": "function", "signature": "(CcspAdvSecurityDmlTestFixture,ccsp_advsec_stop_features_sb_sf)"}, {"_type": "tag", "name": "TEST_F", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^TEST_F(CcspAdvSecurityDmlTestFixture, ccsp_advsec_stop_features_sf)$/", "language": "C++", "kind": "function", "signature": "(CcspAdvSecurityDmlTestFixture,ccsp_advsec_stop_features_sf)"}, {"_type": "tag", "name": "g_AdvsecInternalMock", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^AdvsecInternalMock * g_AdvsecInternalMock = NULL;  \\/* This is the actual definition of the mock/", "language": "C++", "typeref": "typename:AdvsecInternalMock *", "kind": "variable"}, {"_type": "tag", "name": "g_pAdvSecAgent", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^COSA_DATAMODEL_AGENT *g_pAdvSecAgent = NULL;$/", "language": "C++", "typeref": "typename:COSA_DATAMODEL_AGENT *", "kind": "variable"}, {"_type": "tag", "name": "mockedAdvsecInternal", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^        AdvsecInternalMock mockedAdvsecInternal;$/", "file": true, "language": "C++", "typeref": "typename:AdvsecInternalMock", "kind": "member", "scope": "CcspAdvSecurityDmlTestFixture", "scopeKind": "class"}, {"_type": "tag", "name": "~CcspAdvSecurityDmlTestFixture", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "pattern": "/^        virtual ~CcspAdvSecurityDmlTestFixture()$/", "file": true, "language": "C++", "kind": "function", "signature": "()", "scope": "CcspAdvSecurityDmlTestFixture", "scopeKind": "class"}], "hash": "4996d3d35db3975d6ddd3a0af7c99210", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/CcspAdvSecurity/source/test/CcspAdvSecurityDmlTest/CcspAdvSecurityDmlTest.cpp", "fields": [{"name": "AdvsecInternalMock * g_AdvsecInternalMock", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "COSA_DATAMODEL_AGENT * g_pAdvSecAgent", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "AdvsecInternalMock mockedAdvsecInternal", "scope": "CcspAdvSecurityDmlTestFixture", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"18963": ""}]}