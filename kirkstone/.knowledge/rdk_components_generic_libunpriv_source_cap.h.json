{"is_source_file": true, "format": "C header file", "description": "This file declares functions, structures, and includes for managing process capabilities and privilege separation, including functions for initializing capabilities, dropping and gaining privileges, and fetching capability information.", "external_files": ["<sys/types.h>", "<unistd.h>", "<errno.h>", "<stdio.h>", "<string.h>", "<stdlib.h>", "<sys/capability.h>", "<sys/prctl.h>", "<pwd.h>", "<errno.h>", "<stdbool.h>", "\"rfcapi.h\""], "external_methods": ["cap_value_t add[]", "cap_value_t drop[]", "cap_value_t caps_default[]", "isBlocklisted", "fetchRFC", "init_capability", "prepare_caps", "drop_root_caps", "update_process_caps", "read_capability", "drop_root_priv", "gain_root_privilege", "get_capabilities", "log_cap"], "published": ["isBlocklisted", "fetchRFC", "init_capability", "prepare_caps", "drop_root_caps", "update_process_caps", "read_capability", "drop_root_priv", "gain_root_privilege", "get_capabilities", "log_cap"], "classes": [], "methods": [{"name": "isBlocklisted", "description": "Checks if the current process or entity is blocklisted."}, {"name": "fetchRFC", "description": "Fetches RFC configuration related to roles or capabilities using a key."}, {"name": "init_capability", "description": "Initializes and returns a capability set structure."}, {"name": "prepare_caps", "description": "Prepares application or process specific capabilities by setting add and drop lists."}, {"name": "drop_root_caps", "description": "Determines which capabilities should be dropped when running as non-root."}, {"name": "update_process_caps", "description": "Applies the specified process capabilities."}, {"name": "read_capability", "description": "Reads current capabilities of the process into the cap_user structure."}, {"name": "drop_root_priv", "description": "Switches the process to non-root privileges based on cap_user settings."}, {"name": "gain_root_privilege", "description": "Elevates the process privileges to root."}, {"name": "get_capabilities", "description": "Retrieves capabilities for a specified process."}, {"name": "log_cap", "description": "Logs capability-related messages with formatted output."}], "calls": ["isBlocklisted()", "fetchRFC()", "init_capability()", "prepare_caps()", "drop_root_caps()", "update_process_caps()", "read_capability()", "drop_root_priv()", "gain_root_privilege()", "get_capabilities()", "log_cap()"], "search-terms": ["capability", "privilege", "drop_root", "gain_root", "cap_user", "set capabilities"], "state": 2, "file_id": 12924, "knowledge_revision": 25828, "git_revision": "", "ctags": [{"_type": "tag", "name": "CAP_H_", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.h", "pattern": "/^#define CAP_H_$/", "language": "C++", "kind": "macro"}, {"_type": "tag", "name": "_cap_user", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.h", "pattern": "/^typedef struct _cap_user {$/", "language": "C++", "kind": "struct"}, {"_type": "tag", "name": "add", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.h", "pattern": "/^cap_value_t add[CAP_LAST_CAP+1];$/", "language": "C++", "typeref": "typename:cap_value_t[]", "kind": "member", "scope": "_cap_user", "scopeKind": "struct"}, {"_type": "tag", "name": "add_count", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.h", "pattern": "/^short add_count;$/", "language": "C++", "typeref": "typename:short", "kind": "member", "scope": "_cap_user", "scopeKind": "struct"}, {"_type": "tag", "name": "cap_user", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.h", "pattern": "/^}cap_user;$/", "language": "C++", "typeref": "struct:_cap_user", "kind": "typedef"}, {"_type": "tag", "name": "caps", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.h", "pattern": "/^char *caps;$/", "language": "C++", "typeref": "typename:char *", "kind": "member", "scope": "_cap_user", "scopeKind": "struct"}, {"_type": "tag", "name": "caps_default", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.h", "pattern": "/^cap_value_t caps_default[CAP_LAST_CAP+1];$/", "language": "C++", "typeref": "typename:cap_value_t[]", "kind": "member", "scope": "_cap_user", "scopeKind": "struct"}, {"_type": "tag", "name": "default_count", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.h", "pattern": "/^short default_count;$/", "language": "C++", "typeref": "typename:short", "kind": "member", "scope": "_cap_user", "scopeKind": "struct"}, {"_type": "tag", "name": "drop", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.h", "pattern": "/^cap_value_t drop[CAP_LAST_CAP+1];$/", "language": "C++", "typeref": "typename:cap_value_t[]", "kind": "member", "scope": "_cap_user", "scopeKind": "struct"}, {"_type": "tag", "name": "drop_count", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.h", "pattern": "/^short drop_count;$/", "language": "C++", "typeref": "typename:short", "kind": "member", "scope": "_cap_user", "scopeKind": "struct"}, {"_type": "tag", "name": "user_name", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.h", "pattern": "/^char *user_name;$/", "language": "C++", "typeref": "typename:char *", "kind": "member", "scope": "_cap_user", "scopeKind": "struct"}], "hash": "624f5e9b82ddbaceded741762c60c689", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdk/components/generic/libunpriv/source/cap.h", "fields": [{"name": "cap_value_t[] add", "scope": "_cap_user", "scopeKind": "struct", "description": "unavailable"}, {"name": "short add_count", "scope": "_cap_user", "scopeKind": "struct", "description": "unavailable"}, {"name": "char * caps", "scope": "_cap_user", "scopeKind": "struct", "description": "unavailable"}, {"name": "cap_value_t[] caps_default", "scope": "_cap_user", "scopeKind": "struct", "description": "unavailable"}, {"name": "short default_count", "scope": "_cap_user", "scopeKind": "struct", "description": "unavailable"}, {"name": "cap_value_t[] drop", "scope": "_cap_user", "scopeKind": "struct", "description": "unavailable"}, {"name": "short drop_count", "scope": "_cap_user", "scopeKind": "struct", "description": "unavailable"}, {"name": "char * user_name", "scope": "_cap_user", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"25828": ""}]}