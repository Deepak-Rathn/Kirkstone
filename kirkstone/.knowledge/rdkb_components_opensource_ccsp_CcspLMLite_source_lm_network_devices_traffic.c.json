{"is_source_file": true, "format": "C", "description": "This file contains source code for network devices traffic monitoring and reporting. It implements traffic data collection, list management, report triggering, and thread handling for network traffic harvesting, including synchronization and configuration management.", "external_files": ["network_devices_traffic.h", "ccsp_lmliteLog_wrapper.h", "network_devices_traffic_avropack.h", "lm_main.h", "report_common.h", "secure_wrapper.h", "rpl_malloc.h", "mlt_malloc.h"], "external_methods": ["SetNDTOverrideTTL()", "SetNDTPollingPeriodInNVRAM()", "SetNDTReportingPeriodInNVRAM()", "network_devices_traffic_report()", "ndt_avro_cleanup()", "GetNDTPollingPeriod()", "GetNDTReportingPeriod()", "GetNDTOverrideTTL()", "GetNDTOverrideTTLDefault()", "GetNDTReportingPeriodDefault()", "GetNDTPollingPeriodDefault()", "v_secure_system()", "gettimeofday()", "clock_gettime()"], "published": ["SetNDTReportingPeriod()", "GetNDTReportingPeriod()", "SetNDTPollingPeriod()", "GetNDTPollingPeriod()", "ValidateNDTPeriod()", "GetNDTHarvestingStatus()", "SetNDTHarvestingStatus()", "ResetEBTables()", "GetIPTableData()", "StartNetworkDevicesTrafficHarvesting()", "delete_list_ndt()", "delete_partial_list_ndt()", "add_to_list_ndt()", "print_list_ndt()"], "classes": [], "methods": [{"name": "bool isvalueinarray_ndt(ULONG val,ULONG * arr,int size)", "description": "Checks if a given value exists in an array of ULONGs", "scope": "", "scopeKind": ""}, {"name": "int ResetEBTables()", "description": "Resets Ethernet bridge tables by executing a shell script", "scope": "", "scopeKind": ""}, {"name": "int SetNDTHarvestingStatus(BOOL status)", "description": "Enables or disables traffic harvesting and manages harvesting thread", "scope": "", "scopeKind": ""}, {"name": "BOOL GetNDTHarvestingStatus()", "description": "Returns current harvesting status", "scope": "", "scopeKind": ""}, {"name": "int SetNDTReportingPeriod(ULONG period)", "description": "Sets the reporting period for NDT", "scope": "", "scopeKind": ""}, {"name": "ULONG GetNDTReportingPeriod()", "description": "Retrieves current reporting period", "scope": "", "scopeKind": ""}, {"name": "int SetNDTPollingPeriod(ULONG period)", "description": "Sets the polling interval", "scope": "", "scopeKind": ""}, {"name": "BOOL ValidateNDTPeriod(ULONG period)", "description": "Validates if given period is supported", "scope": "", "scopeKind": ""}, {"name": "ULONG GetNDTPollingPeriod()", "description": "Retrieves current polling interval", "scope": "", "scopeKind": ""}, {"name": "ULONG SetNDTReportingPeriodDefault(ULONG period)", "description": "Sets default reporting period", "scope": "", "scopeKind": ""}, {"name": "ULONG GetNDTReportingPeriodDefault()", "description": "Gets default reporting period", "scope": "", "scopeKind": ""}, {"name": "ULONG SetNDTPollingPeriodDefault(ULONG period)", "description": "Sets default polling interval", "scope": "", "scopeKind": ""}, {"name": "ULONG GetNDTPollingPeriodDefault()", "description": "Gets default polling interval", "scope": "", "scopeKind": ""}, {"name": "ULONG GetNDTOverrideTTL()", "description": "Returns current TTL override value", "scope": "", "scopeKind": ""}, {"name": "ULONG GetNDTOverrideTTLDefault()", "description": "Returns default TTL override value", "scope": "", "scopeKind": ""}, {"name": "int SetNDTOverrideTTL(ULONG ttl)", "description": "Sets TTL override value", "scope": "", "scopeKind": ""}, {"name": "GetTimeOffsetFromUtc", "description": "Externally defined function to get timezone offset (if UTC_ENABLE not defined)"}, {"name": "void WaitForPthreadConditionTimeoutNDT()", "description": "Waits for a condition or timeout in the harvesting thread", "scope": "", "scopeKind": ""}, {"name": "void add_to_list_ndt(char * ip_table_line)", "description": "Parses a line and adds device traffic data to linked list", "scope": "", "scopeKind": ""}, {"name": "void print_list_ndt()", "description": "Prints current list of device traffic data", "scope": "", "scopeKind": ""}, {"name": "void delete_list_ndt()", "description": "Deletes all entries in the device traffic list", "scope": "", "scopeKind": ""}, {"name": "void delete_partial_list_ndt()", "description": "Deletes older entries, keeping the last polling cycle's data", "scope": "", "scopeKind": ""}, {"name": "void GetIPTableData()", "description": "Fetches current network device traffic data from shell script output", "scope": "", "scopeKind": ""}, {"name": "void * StartNetworkDevicesTrafficHarvesting(void * arg)", "description": "Main loop for harvesting, reporting, and managing network device traffic data", "scope": "", "scopeKind": ""}], "search-terms": ["network_devices_traffic", "traffic harvesting", "traffic report", "list management", "traffic periods", "monitoring", "traffic data", "traffic list", "eth bridge reset", "thread synchronization"], "state": 2, "file_id": 7225, "knowledge_revision": 20306, "git_revision": "", "ctags": [{"_type": "tag", "name": "GetIPTableData", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^void GetIPTableData()$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "GetNDTHarvestingStatus", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^BOOL GetNDTHarvestingStatus()$/", "language": "C", "typeref": "typename:BOOL", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "GetNDTOverrideTTL", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG GetNDTOverrideTTL()$/", "language": "C", "typeref": "typename:ULONG", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "GetNDTOverrideTTLDefault", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG GetNDTOverrideTTLDefault()$/", "language": "C", "typeref": "typename:ULONG", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "GetNDTPollingPeriod", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG GetNDTPollingPeriod()$/", "language": "C", "typeref": "typename:ULONG", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "GetNDTPollingPeriodDefault", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG GetNDTPollingPeriodDefault()$/", "language": "C", "typeref": "typename:ULONG", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "GetNDTReportingPeriod", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG GetNDTReportingPeriod()$/", "language": "C", "typeref": "typename:ULONG", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "GetNDTReportingPeriodDefault", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG GetNDTReportingPeriodDefault()$/", "language": "C", "typeref": "typename:ULONG", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "NDTOverrideTTL", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG NDTOverrideTTL = TTL_INTERVAL;$/", "language": "C", "typeref": "typename:ULONG", "kind": "variable"}, {"_type": "tag", "name": "NDTOverrideTTLDefault", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG NDTOverrideTTLDefault = DEFAULT_TTL_INTERVAL;$/", "language": "C", "typeref": "typename:ULONG", "kind": "variable"}, {"_type": "tag", "name": "NDTPollingPeriod", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG NDTPollingPeriod = DEFAULT_TRAFFIC_POLLING_INTERVAL;$/", "language": "C", "typeref": "typename:ULONG", "kind": "variable"}, {"_type": "tag", "name": "NDTPollingPeriodDefault", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG NDTPollingPeriodDefault = DEFAULT_TRAFFIC_POLLING_INTERVAL;$/", "language": "C", "typeref": "typename:ULONG", "kind": "variable"}, {"_type": "tag", "name": "NDTReportStatus", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^BOOL NDTReportStatus = FALSE;$/", "language": "C", "typeref": "typename:BOOL", "kind": "variable"}, {"_type": "tag", "name": "NDTReportingPeriod", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG NDTReportingPeriod = DEFAULT_TRAFFIC_REPORTING_INTERVAL;$/", "language": "C", "typeref": "typename:ULONG", "kind": "variable"}, {"_type": "tag", "name": "NDTReportingPeriodDefault", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG NDTReportingPeriodDefault = DEFAULT_TRAFFIC_REPORTING_INTERVAL;$/", "language": "C", "typeref": "typename:ULONG", "kind": "variable"}, {"_type": "tag", "name": "NetworkDeviceTrafficPeriods", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG NetworkDeviceTrafficPeriods[] = {30,60,300,900,1800,3600,10800,21600,43200,86400};$/", "language": "C", "typeref": "typename:ULONG[]", "kind": "variable"}, {"_type": "tag", "name": "ResetEBTables", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^int ResetEBTables()$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "SetNDTHarvestingStatus", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^int SetNDTHarvestingStatus(BOOL status)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(BOOL status)"}, {"_type": "tag", "name": "SetNDTOverrideTTL", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^int SetNDTOverrideTTL(ULONG ttl)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(ULONG ttl)"}, {"_type": "tag", "name": "SetNDTPollingPeriod", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^int SetNDTPollingPeriod(ULONG period)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(ULONG period)"}, {"_type": "tag", "name": "SetNDTPollingPeriodDefault", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG SetNDTPollingPeriodDefault(ULONG period)$/", "language": "C", "typeref": "typename:ULONG", "kind": "function", "signature": "(ULONG period)"}, {"_type": "tag", "name": "SetNDTReportingPeriod", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^int SetNDTReportingPeriod(ULONG period)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(ULONG period)"}, {"_type": "tag", "name": "SetNDTReportingPeriodDefault", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG SetNDTReportingPeriodDefault(ULONG period)$/", "language": "C", "typeref": "typename:ULONG", "kind": "function", "signature": "(ULONG period)"}, {"_type": "tag", "name": "StartNetworkDevicesTrafficHarvesting", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^void* StartNetworkDevicesTrafficHarvesting( void *arg )$/", "language": "C", "typeref": "typename:void *", "kind": "function", "signature": "(void * arg)"}, {"_type": "tag", "name": "ValidateNDTPeriod", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^BOOL ValidateNDTPeriod(ULONG period)$/", "language": "C", "typeref": "typename:BOOL", "kind": "function", "signature": "(ULONG period)"}, {"_type": "tag", "name": "WaitForPthreadConditionTimeoutNDT", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^static void WaitForPthreadConditionTimeoutNDT()$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "add_to_list_ndt", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^void add_to_list_ndt(char* ip_table_line)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(char * ip_table_line)"}, {"_type": "tag", "name": "currentNDTReportingPeriod", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^ULONG currentNDTReportingPeriod = 0;$/", "language": "C", "typeref": "typename:ULONG", "kind": "variable"}, {"_type": "tag", "name": "currnode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^static struct networkdevicetrafficdata *currnode = NULL;$/", "file": true, "language": "C", "typeref": "struct:networkdevicetrafficdata *", "kind": "variable"}, {"_type": "tag", "name": "delete_list_ndt", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^void delete_list_ndt()$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "delete_partial_list_ndt", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^void delete_partial_list_ndt()$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "headnode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^static struct networkdevicetrafficdata *headnode = NULL;$/", "file": true, "language": "C", "typeref": "struct:networkdevicetrafficdata *", "kind": "variable"}, {"_type": "tag", "name": "isvalueinarray_ndt", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^bool isvalueinarray_ndt(ULONG val, ULONG *arr, int size)$/", "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "(ULONG val,ULONG * arr,int size)"}, {"_type": "tag", "name": "ndtCond", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^static pthread_cond_t ndtCond = PTHREAD_COND_INITIALIZER;$/", "file": true, "language": "C", "typeref": "typename:pthread_cond_t", "kind": "variable"}, {"_type": "tag", "name": "ndtMutex", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^static pthread_mutex_t ndtMutex = PTHREAD_MUTEX_INITIALIZER;$/", "file": true, "language": "C", "typeref": "typename:pthread_mutex_t", "kind": "variable"}, {"_type": "tag", "name": "print_list_ndt", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^void print_list_ndt()$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "reset_timestamp", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "pattern": "/^struct timeval reset_timestamp;$/", "language": "C", "typeref": "struct:timeval", "kind": "variable"}], "hash": "a6be0f4d33cd11957ad783ec2c31b2cc", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/CcspLMLite/source/lm/network_devices_traffic.c", "fields": [{"name": "ULONG NDTOverrideTTL", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ULONG NDTOverrideTTLDefault", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ULONG NDTPollingPeriod", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ULONG NDTPollingPeriodDefault", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "BOOL NDTReportStatus", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ULONG NDTReportingPeriod", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ULONG NDTReportingPeriodDefault", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ULONG[] NetworkDeviceTrafficPeriods", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ULONG currentNDTReportingPeriod", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "struct:networkdevicetrafficdata * currnode", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "struct:networkdevicetrafficdata * headnode", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pthread_cond_t ndtCond", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pthread_mutex_t ndtMutex", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "struct:timeval reset_timestamp", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"20306": ""}]}