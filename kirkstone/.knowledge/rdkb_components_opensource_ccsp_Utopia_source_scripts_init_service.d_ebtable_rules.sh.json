{"is_source_file": true, "format": "Shell script", "description": "This file defines shell functions to set up and manage ebtables rules for network traffic filtering, particularly focusing on blocking certain LAN-to-WAN IP traffic and configuring bridge/router modes. It includes system configuration commands, rule flushing, and mode-specific logic.", "external_files": ["/usr/sbin/arp", "/bin/awk", "/sbin/ebtables", "/sbin/arping", "/bin/ip", "/bin/grep", "/syscfg", "/sysevent"], "external_methods": ["ip", "awk", "ebtables", "arp", "syscfg get", "sysevent get"], "published": [], "classes": [], "methods": [{"name": "do_block_lan_to_wanip", "description": "Function to block traffic from a LAN interface to all IP addresses associated with a specified WAN interface, using ebtables."}, {"name": "block_lan_to_wanip_all", "description": "Function to iterate over LAN and WAN interfaces and invoke do_block_lan_to_wanip for each pair."}, {"name": "set_ebtable_rules", "description": "Main function to configure ebtables rules based on current network mode (bridge or router), including flushing rules, setting ignore parameters, and applying mode-specific policies."}], "calls": ["ip -4 addr show", "ip -6 addr show", "awk -F'[ /]+'", "ebtables -I FORWARD", "syscfg get lan_ethernet_physical_ifnames", "syscfg get emta_wan_ifname", "syscfg get ecm_wan_ifname", "syscfg get wan_physical_ifname", "sysevent get bridge_mode", "arp 192.168.101.3", "arping -c 1 -I l2sd0.500 192.168.101.3"], "search-terms": ["ebtables", "block_lan_to_wanip", "bridge_mode", "set_ebtable_rules", "iptables", "network security", "LAN to WAN filtering", "bridge mode configuration"], "state": 2, "file_id": 7607, "knowledge_revision": 20681, "git_revision": "", "hash": "50483fe118405c2e165449ac7d3977d3", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/Utopia/source/scripts/init/service.d/ebtable_rules.sh", "revision_history": [{"20681": ""}]}