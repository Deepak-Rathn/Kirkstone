{"is_source_file": true, "format": "C", "description": "This is the main source file for the SSP (Service Specific Platform) application, responsible for initialization, signal handling, daemonization, and command dispatching for the PSM (Platform Service Module) on the system. It contains the main() function, signal handlers, and core logic to start and stop the PSM service, along with utility functions for crash handling and backtrace.", "external_files": ["ssp_global.h", "safec_lib_common.h", "secure_wrapper.h", "systemd/sd-daemon.h", "breakpad_wrapper.h", "syscfg/syscfg.h", "cap.h"], "external_methods": ["PsmCreateSysRegistry", "PSM_SYS_REGISTRY_OBJECT->SetProperty", "PSM_SYS_REGISTRY_OBJECT->Engage", "PsmDbusInit", "CCSP_Msg_IsRbus_enabled", "PsmRbusInit", "CCSP_Message_Bus_Exit", "AnscTrace", "v_secure_system"], "published": ["main", "cmd_dispatch", "gather_info"], "classes": [], "methods": [{"name": "void _print_stack_backtrace(void)", "description": "Captures and prints the current call stack to a file and stdout for debugging purposes, if supported by the platform.", "calls": ["backtrace", "backtrace_symbols_fd", "backtrace_symbols"], "scope": "", "scopeKind": ""}, {"name": "void daemonize(void)", "description": "Creates a daemon process, initializes semaphores for IPC, and redirects standard file descriptors to /dev/null to run in background.", "calls": ["sem_open", "sem_unlink", "sem_close", "fork", "setsid", "open", "dup2", "close"], "scope": "", "scopeKind": ""}, {"name": "void sig_handler(int sig)", "description": "Handles various system signals such as SIGINT, SIGUSR1, SIGUSR2, SIGCHLD, SIGPIPE, SIGALRM, SIGTERM, performing clean up, saving configurations, and printing backtrace on fatal signals.", "calls": ["_print_stack_backtrace", "exit", "pPsmSysRegistry->Cancel", "pPsmSysRegistry->Remove", "pPsmSysRegistry->SaveConfigToFlash"], "scope": "", "scopeKind": ""}, {"name": "int is_core_dump_opened(void)", "description": "Checks whether core dump size limit is set to non-zero, indicating core dumps are enabled.", "calls": ["fopen", "fgets", "strstr", "strtok_r", "fclose"], "scope": "", "scopeKind": ""}, {"name": "int main(int argc,char * argv[])", "description": "Main entry point that initializes the system, sets up signal handlers, daemonizes if needed, writes PID to file, and handles command interface.", "calls": ["setlinebuf", "strcmp_s", "strcpy_s", "init_capability", "drop_root_caps", "daemonize", "fopen", "fputs", "signal", "breakpad_ExceptionHandler", "gather_info", "cmd_dispatch", "creat", "update_process_caps", "read_capability", "sleep", "getchar"], "scope": "", "scopeKind": ""}, {"name": "int cmd_dispatch(int command)", "description": "Handles start ('e') and stop ('c') commands for the PSM service, managing lifecycle including setup and cleanup of sys registry objects and bus connections.", "calls": ["PsmCreateSysRegistry", "strcpy_s", "pPsmSysRegistry->SetProperty", "pPsmSysRegistry->Engage", "CCSP_Message_Bus_Exit", "pPsmSysRegistry->Cancel", "pPsmSysRegistry->Remove"], "scope": "", "scopeKind": ""}, {"name": "int gather_info()", "description": "Displays introductory information about the application, testing, and licensing.", "calls": ["AnscTrace"], "scope": "", "scopeKind": ""}], "search-terms": ["PsmCreateSysRegistry", "Signal Handlers", "Daemonization", "Stack Backtrace", "Process Lifecycle", "Config Files", "Backup and Restore", "Systemd sd-daemon", "Crash Dump Handler", "Register", "Main Loop", "Command Interface"], "state": 2, "file_id": 9967, "knowledge_revision": 22969, "git_revision": "", "ctags": [{"_type": "tag", "name": "DEBUG_INI_NAME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^#define DEBUG_INI_NAME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TITLE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^#define TITLE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "_print_stack_backtrace", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^static void _print_stack_backtrace(void)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "appcaps", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^static cap_user                     appcaps;$/", "file": true, "language": "C", "typeref": "typename:cap_user", "kind": "variable"}, {"_type": "tag", "name": "bEngaged", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^BOOL                                bEngaged          = FALSE;$/", "language": "C", "typeref": "typename:BOOL", "kind": "variable"}, {"_type": "tag", "name": "bus_handle", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^void                               *bus_handle        = NULL;$/", "language": "C", "typeref": "typename:void *", "kind": "variable"}, {"_type": "tag", "name": "cfm_ifo", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^PSM_CFM_INTERFACE                   cfm_ifo;$/", "language": "C", "typeref": "typename:PSM_CFM_INTERFACE", "kind": "variable"}, {"_type": "tag", "name": "cmd_dispatch", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^int  cmd_dispatch(int  command)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int command)"}, {"_type": "tag", "name": "daemonize", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^static void daemonize(void) {$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "g_Subsystem", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^char                                g_Subsystem[32]   = {0};$/", "language": "C", "typeref": "typename:char[32]", "kind": "variable"}, {"_type": "tag", "name": "g_bLogEnable", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^BOOL                                g_bLogEnable      = FALSE;$/", "language": "C", "typeref": "typename:BOOL", "kind": "variable"}, {"_type": "tag", "name": "gather_info", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^int  gather_info()$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "is_core_dump_opened", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^static int is_core_dump_opened(void)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "main", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^int main(int argc, char* argv[])$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int argc,char * argv[])"}, {"_type": "tag", "name": "pPsmSysRegistry", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^PPSM_SYS_REGISTRY_OBJECT            pPsmSysRegistry   = (PPSM_SYS_REGISTRY_OBJECT)NULL;$/", "language": "C", "typeref": "typename:PPSM_SYS_REGISTRY_OBJECT", "kind": "variable"}, {"_type": "tag", "name": "sem", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^    sem_t *sem;$/", "language": "C", "typeref": "typename:sem_t *", "kind": "variable"}, {"_type": "tag", "name": "sig_handler", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "pattern": "/^void sig_handler(int sig)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(int sig)"}], "hash": "1f17a1600d81245d33ba3bd03bd2c9f2", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/CcspPsm/source/Ssp/ssp_main.c", "fields": [{"name": "cap_user appcaps", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "BOOL bEngaged", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void * bus_handle", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "PSM_CFM_INTERFACE cfm_ifo", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char[32] g_Subsystem", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "BOOL g_bLogEnable", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "PPSM_SYS_REGISTRY_OBJECT pPsmSysRegistry", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "sem_t * sem", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"22969": ""}]}