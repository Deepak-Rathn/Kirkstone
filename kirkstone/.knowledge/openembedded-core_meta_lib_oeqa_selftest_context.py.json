{"is_source_file": true, "format": "Python", "description": "This file contains the implementation of self-test context management, including classes and functions to set up, run, and manage self-tests within a build environment. It defines classes like OESelftestTestContext and OESelftestTestContextExecutor, with methods for preparing the environment, executing tests, and handling test suite configurations.", "external_files": ["oeqa", "oe", "bb.utils", "oeqa.core.context", "oeqa.core.exception", "oeqa.utils.commands", "oeqa.utils.metadata", "oeqa.utils.concurrencytest", "oeqa.selftest"], "external_methods": ["os.path.copytree", "os.environ", "os.path.exists", "os.path.expanduser", "os.path.join", "os.chdir", "subprocess.check_output", "subprocess.check_call", "time.sleep", "time.strftime", "glob.glob", "sys.exit", "sys.path.extend", "importlib.reload", "os.remove", "os.symlink", "oe.path.copytree", "oeqa.core.context.OETestContext", "oeqa.core.exception.OEQAPreRun", "oeqa.utils.commands.runCmd", "oeqa.utils.commands.get_bb_vars", "oeqa.utils.commands.get_test_layer", "oeqa.utils.metadata.metadata_from_bb", "oe.lsb.distro_identifier"], "published": ["OESelftestTestContext", "OESelftestTestContextExecutor"], "classes": [{"name": "NonConcurrentTestSuite", "description": "A unittest test suite that runs a given test suite without concurrency, managing build directory setup and teardown."}, {"name": "OESelftestTestContext", "description": "A context class for setting up and executing selftest suite in a build environment, managing directories, environment variables, and configurations."}, {"name": "OESelftestTestContextExecutor", "description": "An executor class for managing command-line interactions and orchestrating selftest runs and listings."}], "methods": [{"name": "run(self, logger, args)", "description": "Executes the selftest test suite within the configured environment.", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"name": "setup_builddir(self, suffix, selftestdir, suite)", "description": "Sets up a new build directory with necessary configurations and environment adjustments for selftest execution.", "scope": "OESelftestTestContext", "scopeKind": "class"}, {"name": "prepareSuite(self, suites, processes)", "description": "Prepares the test suite, optionally adding concurrency management based on the process count.", "scope": "OESelftestTestContext", "scopeKind": "class"}, {"name": "runTests(self, processes=None, machine=None, skips=[])", "description": "Runs the selftest suite, possibly on a specific machine or multiple machines.", "scope": "OESelftestTestContext", "scopeKind": "class"}, {"name": "listTests(self, display_type, machine=None)", "description": "Lists available tests, classes, or modules based on parameters.", "scope": "OESelftestTestContext", "scopeKind": "class"}, {"name": "_get_available_machines(self)", "description": "Discovers available machine configurations from layer conf files.", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"name": "_get_cases_paths(self, bbpath)", "description": "Collects paths to test case files from layer directories.", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"name": "_process_args(self, logger, args)", "description": "Processes command-line arguments for the selftest execution.", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"name": "_pre_run(self)", "description": "Performs pre-run checks, including environment validation and configuration adjustments.", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"name": "get_json_result_dir(self, args)", "description": "Determines the directory for storing JSON results.", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"name": "get_configuration(self, args)", "description": "Generates a configuration dictionary describing the test run environment.", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"name": "get_result_id(self, configuration)", "description": "Creates a unique identifier for a test result based on configuration.", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"name": "_internal_run(self, logger, args)", "description": "Performs the core execution of tests based on prepared environment and arguments.", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"name": "__init__(self, suite, processes, setupfunc, removefunc)", "scope": "NonConcurrentTestSuite", "scopeKind": "class", "description": "unavailable"}, {"name": "__init__(self, td=None, logger=None, machines=None, config_paths=None, newbuilddir=None, keep_builddir=None)", "scope": "OESelftestTestContext", "scopeKind": "class", "description": "unavailable"}, {"name": "_add_layer_libs()", "scope": "OESelftestTestContextExecutor._pre_run", "scopeKind": "member", "description": "unavailable"}, {"name": "_check_presence_meta_selftest()", "scope": "OESelftestTestContextExecutor._pre_run", "scopeKind": "member", "description": "unavailable"}, {"name": "_check_required_env_variables(vars)", "scope": "OESelftestTestContextExecutor._pre_run", "scopeKind": "member", "description": "unavailable"}, {"name": "patch_suite(s)", "scope": "OESelftestTestContext.setup_builddir", "scopeKind": "member", "description": "unavailable"}, {"name": "patch_test(t)", "scope": "OESelftestTestContext.setup_builddir", "scopeKind": "member", "description": "unavailable"}, {"name": "register_commands(self, logger, parser)", "scope": "OESelftestTestContextExecutor", "scopeKind": "class", "description": "unavailable"}, {"name": "removebuilddir(d)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "run(self, result)", "scope": "NonConcurrentTestSuite", "scopeKind": "class", "description": "unavailable"}, {"name": "tag_filter(tags)", "scope": "OESelftestTestContextExecutor._process_args", "scopeKind": "member", "description": "unavailable"}], "calls": ["os.path.exists", "os.path.expanduser", "os.environ", "os.path.join", "os.chdir", "subprocess.check_output", "bb.utils.mkdirhier", "oe.path.copytree", "subprocess.check_call", "sys.exit", "importlib.reload", "oeqa.core.context.OETestContext", "oeqa.core.exception.OEQAPreRun", "runCmd", "get_bb_vars", "get_test_layer", "metadata_from_bb", "oe.lsb.distro_identifier", "os.remove", "os.symlink"], "search-terms": ["oe-selftest", "OESelftestTestContext", "OEQATestNotFound", "selftest", "test suite management", "build directory setup", "test environment"], "state": 2, "file_id": 1946, "knowledge_revision": 15101, "git_revision": "", "ctags": [{"_type": "tag", "name": "NonConcurrentTestSuite", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^class NonConcurrentTestSuite(unittest.TestSuite):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "OESelftestTestContext", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^class OESelftestTestContext(OETestContext):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "OESelftestTestContextExecutor", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^class OESelftestTestContextExecutor(OETestContextExecutor):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def __init__(self, suite, processes, setupfunc, removefunc):$/", "language": "Python", "kind": "member", "signature": "(self, suite, processes, setupfunc, removefunc)", "scope": "NonConcurrentTestSuite", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def __init__(self, td=None, logger=None, machines=None, config_paths=None, newbuilddir=None,/", "language": "Python", "kind": "member", "signature": "(self, td=None, logger=None, machines=None, config_paths=None, newbuilddir=None, keep_builddir=None)", "scope": "OESelftestTestContext", "scopeKind": "class"}, {"_type": "tag", "name": "_add_layer_libs", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^        def _add_layer_libs():$/", "file": true, "language": "Python", "kind": "function", "signature": "()", "scope": "OESelftestTestContextExecutor._pre_run", "scopeKind": "member"}, {"_type": "tag", "name": "_check_presence_meta_selftest", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^        def _check_presence_meta_selftest():$/", "file": true, "language": "Python", "kind": "function", "signature": "()", "scope": "OESelftestTestContextExecutor._pre_run", "scopeKind": "member"}, {"_type": "tag", "name": "_check_required_env_variables", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^        def _check_required_env_variables(vars):$/", "file": true, "language": "Python", "kind": "function", "signature": "(vars)", "scope": "OESelftestTestContextExecutor._pre_run", "scopeKind": "member"}, {"_type": "tag", "name": "_context_class", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    _context_class = OESelftestTestContext$/", "language": "Python", "kind": "variable", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "_executor_class", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^_executor_class = OESelftestTestContextExecutor$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_get_available_machines", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def _get_available_machines(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "_get_cases_paths", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def _get_cases_paths(self, bbpath):$/", "language": "Python", "kind": "member", "signature": "(self, bbpath)", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "_internal_run", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def _internal_run(self, logger, args):$/", "language": "Python", "kind": "member", "signature": "(self, logger, args)", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "_pre_run", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def _pre_run(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "_process_args", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def _process_args(self, logger, args):$/", "language": "Python", "kind": "member", "signature": "(self, logger, args)", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "_script_executor", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    _script_executor = 'oe-selftest'$/", "language": "Python", "kind": "variable", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "description", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    description = 'Executes selftest tests'$/", "language": "Python", "kind": "variable", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "get_configuration", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def get_configuration(self, args):$/", "language": "Python", "kind": "member", "signature": "(self, args)", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "get_json_result_dir", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def get_json_result_dir(self, args):$/", "language": "Python", "kind": "member", "signature": "(self, args)", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "get_result_id", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def get_result_id(self, configuration):$/", "language": "Python", "kind": "member", "signature": "(self, configuration)", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "help", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    help = 'oe-selftest test component'$/", "language": "Python", "kind": "variable", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "listTests", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def listTests(self, display_type, machine=None):$/", "language": "Python", "kind": "member", "signature": "(self, display_type, machine=None)", "scope": "OESelftestTestContext", "scopeKind": "class"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    name = 'oe-selftest'$/", "language": "Python", "kind": "variable", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "patch_suite", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^        def patch_suite(s):$/", "file": true, "language": "Python", "kind": "function", "signature": "(s)", "scope": "OESelftestTestContext.setup_builddir", "scopeKind": "member"}, {"_type": "tag", "name": "patch_test", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^        def patch_test(t):$/", "file": true, "language": "Python", "kind": "function", "signature": "(t)", "scope": "OESelftestTestContext.setup_builddir", "scopeKind": "member"}, {"_type": "tag", "name": "prepareSuite", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def prepareSuite(self, suites, processes):$/", "language": "Python", "kind": "member", "signature": "(self, suites, processes)", "scope": "OESelftestTestContext", "scopeKind": "class"}, {"_type": "tag", "name": "register_commands", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def register_commands(self, logger, parser):$/", "language": "Python", "kind": "member", "signature": "(self, logger, parser)", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "removebuilddir", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^def removebuilddir(d):$/", "language": "Python", "kind": "function", "signature": "(d)"}, {"_type": "tag", "name": "run", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def run(self, logger, args):$/", "language": "Python", "kind": "member", "signature": "(self, logger, args)", "scope": "OESelftestTestContextExecutor", "scopeKind": "class"}, {"_type": "tag", "name": "run", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def run(self, result):$/", "language": "Python", "kind": "member", "signature": "(self, result)", "scope": "NonConcurrentTestSuite", "scopeKind": "class"}, {"_type": "tag", "name": "runTests", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def runTests(self, processes=None, machine=None, skips=[]):$/", "language": "Python", "kind": "member", "signature": "(self, processes=None, machine=None, skips=[])", "scope": "OESelftestTestContext", "scopeKind": "class"}, {"_type": "tag", "name": "setup_builddir", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^    def setup_builddir(self, suffix, selftestdir, suite):$/", "language": "Python", "kind": "member", "signature": "(self, suffix, selftestdir, suite)", "scope": "OESelftestTestContext", "scopeKind": "class"}, {"_type": "tag", "name": "tag_filter", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/context.py", "pattern": "/^        def tag_filter(tags):$/", "file": true, "language": "Python", "kind": "function", "signature": "(tags)", "scope": "OESelftestTestContextExecutor._process_args", "scopeKind": "member"}], "hash": "e8320a253be5172ce17fc567acea6282", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "openembedded-core/meta/lib/oeqa/selftest/context.py", "fields": [{"name": "_context_class = OESelftestTestContext", "scope": "OESelftestTestContextExecutor", "scopeKind": "class", "description": "unavailable"}, {"name": "_executor_class = OESelftestTestContextExecutor", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_script_executor = 'oe-selftest'", "scope": "OESelftestTestContextExecutor", "scopeKind": "class", "description": "unavailable"}, {"name": "description = 'Executes selftest tests'", "scope": "OESelftestTestContextExecutor", "scopeKind": "class", "description": "unavailable"}, {"name": "help = 'oe-selftest test component'", "scope": "OESelftestTestContextExecutor", "scopeKind": "class", "description": "unavailable"}, {"name": "name = 'oe-selftest'", "scope": "OESelftestTestContextExecutor", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"15101": ""}]}