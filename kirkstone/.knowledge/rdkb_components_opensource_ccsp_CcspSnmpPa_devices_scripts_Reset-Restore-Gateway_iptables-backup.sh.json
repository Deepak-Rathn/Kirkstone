{"is_source_file": true, "format": "shell script / bash", "description": "This script manages firewall rules using iptables, including saving, restoring, and conditionally modifying rules based on system states and configurations. It appears to be used for resetting or restoring iptables configurations for a network device.", "external_files": ["/etc/iptables/mangle_tables_rules.v4", "/etc/iptables/rules.v4", "/nvram/captivemode_enabled", "/nvram/updated_captiveportal_redirectionrules"], "external_methods": ["iptables", "iptables-save", "iptables-restore", "dmcli"], "published": [], "classes": [], "methods": [], "calls": ["sleep", "iptables -t nat -D PREROUTING -i brlan0 -p udp --dport 53 -j DNAT --to 10.0.0.1", "iptables -t nat -D PREROUTING -i brlan0 -p tcp --dport 53 -j DNAT --to 10.0.0.1", "iptables-save -c -t mangle > /etc/iptables/mangle_tables_rules.v4", "iptables -t mangle -F", "iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE", "iptables -D FORWARD -i eth0 -o brlan0 -m state --state RELATED,ESTABLISHED -j ACCEPT", "iptables -D FORWARD -i brlan0 -o eth0 -j ACCEPT", "iptables -t nat -D prerouting_redirect -p tcp --dport 80 -j DNAT --to-destination 0.0.0.0:21515", "iptables -t nat -D prerouting_redirect -p tcp --dport 443 -j DNAT --to-destination 0.0.0.0:21515", "iptables -t nat -D prerouting_redirect -p tcp  -j DNAT --to-destination 0.0.0.0:21515", "iptables -t nat -D prerouting_redirect -p udp ! --dport 53 -j DNAT --to-destination 0.0.0.0:21515", "iptables -t nat -D PREROUTING  -j prerouting_mgmt_override", "TRPORT=`dmcli simu getv Device.ManagementServer.X_CISCO_COM_ConnectionRequestURLPort | grep value | cut -f3 -d : | cut -f2 -d\" \"`", "iptables -t nat -D prerouting_mgmt_override -p tcp -m multiport --dports ${TRPORT},22 -j ACCEPT", "HOTSPOT_ENABLE=`dmcli simu getv Device.DeviceInfo.X_COMCAST_COM_xfinitywifiEnable | grep value | cut -f3 -d : | cut -f2 -d \" \"`", "if [ \"$HOTSPOT_ENABLE\" = \"true\" ]; then ... fi", "iptables-save -c > /etc/iptables/rules.v4", "iptables-restore -c  < /etc/iptables/mangle_tables_rules.v4", "iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE", "iptables -A FORWARD -i eth0 -o brlan0 -m state --state RELATED,ESTABLISHED -j ACCEPT", "iptables -A FORWARD -i brlan0 -o eth0 -j ACCEPT", "iptables -t nat -A prerouting_redirect -p tcp --dport 80 -j DNAT --to-destination 0.0.0.0:21515", "iptables -t nat -A prerouting_redirect -p tcp --dport 443 -j DNAT --to-destination 0.0.0.0:21515", "iptables -t nat -A prerouting_redirect -p tcp  -j DNAT --to-destination 0.0.0.0:21515", "iptables -t nat -A prerouting_redirect -p udp ! --dport 53 -j DNAT --to-destination 0.0.0.0:21515", "iptables -t nat -I PREROUTING 1 -j prerouting_mgmt_override", "iptables -t nat -A prerouting_mgmt_override -p tcp -m multiport --dports ${TRPORT},22 -j ACCEPT", "iptables -I FORWARD -j general_forward", "iptables -I OUTPUT -j general_output", "iptables -I general_forward -o brlan1 -p udp --dport=67:68 -j NFQUEUE --queue-bypass --queue-num 1", "iptables -A general_forward -o brlan2 -p udp --dport=67:68 -j NFQUEUE --queue-bypass --queue-num 2", "iptables -A general_output -o eth0 -p icmp --icmp-type 3 -j NFQUEUE --queue-bypass --queue-num 0", "sleep 3"], "search-terms": ["iptables", "firewall", "iptables-save", "iptables-restore", "iptables rules", "Restore iptables", "firewall reset", "network rules", "iptables mangle", "iptables NAT"], "state": 2, "file_id": 6811, "knowledge_revision": 19917, "git_revision": "", "hash": "4a86242c03d41624bb2351ebe899b7bf", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/CcspSnmpPa/devices/scripts/Reset-Restore-Gateway/iptables-backup.sh", "revision_history": [{"19917": ""}]}