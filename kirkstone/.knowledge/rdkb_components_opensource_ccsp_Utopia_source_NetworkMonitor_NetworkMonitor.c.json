{"is_source_file": true, "format": "C", "description": "This file is a C source file for a Network Monitor component, primarily responsible for monitoring IPv6 routing table updates via netlink sockets, and updating system event variables accordingly.", "external_files": ["<sysevent/sysevent.h>", "ccsp_psm_helper.h", "<ccsp_base_api.h>", "ccsp_memory.h", "secure_wrapper.h", "safec_lib_common.h"], "external_methods": ["PSM_Get_Record_Value2", "sysevent_open", "sysevent_set", "CCSP_Message_Bus_Init", "Ansc_AllocateMemory_Callback", "Ansc_FreeMemory_Callback"], "published": [], "classes": [], "methods": [{"name": "int rtnl_receive(int fd,struct msghdr * msg,int flags)", "description": "Receives a netlink message on a socket, handling interruptions and errors.", "scope": "", "scopeKind": ""}, {"name": "int rtnl_recvmsg(int fd,struct msghdr * msg,char ** answer)", "description": "Allocates buffer and receives a netlink message, returning message content.", "scope": "", "scopeKind": ""}, {"name": "void parse_rtattr(struct rtattr * tb[],int max,struct rtattr * rta,int len)", "description": "Parses routing attributes from netlink message.", "scope": "", "scopeKind": ""}, {"name": "int rtm_get_table(struct rtmsg * r,struct rtattr ** tb)", "description": "Retrieves routing table ID from netlink message.", "scope": "", "scopeKind": ""}, {"name": "void print_route(struct nlmsghdr * nl_header_answer)", "description": "Processes and prints route information, extracts IPv6 route details.", "scope": "", "scopeKind": ""}, {"name": "int open_netlink()", "description": "Opens a netlink socket for routing communication.", "scope": "", "scopeKind": ""}, {"name": "int do_route_dump_requst(int sock)", "description": "Sends a request to dump IPv6 routing table.", "scope": "", "scopeKind": ""}, {"name": "int get_route_dump_response(int sock)", "description": "Receives and processes netlink responses for route dump.", "scope": "", "scopeKind": ""}, {"name": "int msg_handler(struct sockaddr_nl * nl,struct nlmsghdr * msg)", "description": "Handles individual netlink messages, processes route updates.", "scope": "", "scopeKind": ""}, {"name": "int read_event(int sockint,int (* msg_handler)(struct sockaddr_nl *,struct nlmsghdr *))", "description": "Reads and dispatches netlink messages from socket.", "scope": "", "scopeKind": ""}, {"name": "int main()", "description": "Main execution routine initializing system, retrieving configuration, and monitoring IPv6 routes.", "scope": "", "scopeKind": ""}], "calls": ["recvmsg", "perror", "malloc", "free", "strcpy_s", "sscanf", "inet_ntop", "strncpy", "rindex", "close", "send", "bind", "socket", "getpid", "NLMSG_NEXT", "NLMSG_OK", "sysevent_set", "sysevent_open", "CCSP_Message_Bus_Init", "PSM_Get_Record_Value2"], "search-terms": ["IPv6 route monitoring", "netlink socket", "route dump", "system event", "IPv6 routing"], "state": 2, "file_id": 7796, "knowledge_revision": 20862, "git_revision": "", "ctags": [{"_type": "tag", "name": "CCSP_SUBSYS", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^#define CCSP_SUBSYS /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "PSM_MESH_WAN_IFNAME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^#define PSM_MESH_WAN_IFNAME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "PSM_VALUE_GET_STRING", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^#define PSM_VALUE_GET_STRING(/", "file": true, "language": "C", "kind": "macro", "signature": "(name,str)"}, {"_type": "tag", "name": "REMOTEWAN_ROUTER_IPV6", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^#define REMOTEWAN_ROUTER_IPV6 /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "__anon533a8d700108", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^    struct {$/", "file": true, "language": "C", "kind": "struct", "scope": "do_route_dump_requst", "scopeKind": "function"}, {"_type": "tag", "name": "bus_handle", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^void* bus_handle = NULL ;$/", "language": "C", "typeref": "typename:void *", "kind": "variable"}, {"_type": "tag", "name": "component_id", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^const char* component_id = \"ccsp.netmonitor\";$/", "language": "C", "typeref": "typename:const char *", "kind": "variable"}, {"_type": "tag", "name": "do_route_dump_requst", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^int do_route_dump_requst(int sock)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int sock)"}, {"_type": "tag", "name": "get_route_dump_response", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^int get_route_dump_response(int sock)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int sock)"}, {"_type": "tag", "name": "main", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^int main()$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "mesh_wan_ifname", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^static char mesh_wan_ifname[32]={0};$/", "file": true, "language": "C", "typeref": "typename:char[32]", "kind": "variable"}, {"_type": "tag", "name": "msg_handler", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^static int msg_handler(struct sockaddr_nl *nl, struct nlmsghdr *msg)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(struct sockaddr_nl * nl,struct nlmsghdr * msg)"}, {"_type": "tag", "name": "nlh", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^        struct nlmsghdr nlh;$/", "file": true, "language": "C", "typeref": "struct:nlmsghdr", "kind": "member", "scope": "do_route_dump_requst::__anon533a8d700108", "scopeKind": "struct"}, {"_type": "tag", "name": "open_netlink", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^int open_netlink()$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "parse_rtattr", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^void parse_rtattr(struct rtattr *tb[], int max, struct rtattr *rta, int len)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(struct rtattr * tb[],int max,struct rtattr * rta,int len)"}, {"_type": "tag", "name": "print_route", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^void print_route(struct nlmsghdr* nl_header_answer)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(struct nlmsghdr * nl_header_answer)"}, {"_type": "tag", "name": "read_event", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^    int read_event(int sockint, int (*msg_handler)(struct sockaddr_nl *,$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int sockint,int (* msg_handler)(struct sockaddr_nl *,struct nlmsghdr *))"}, {"_type": "tag", "name": "rtm", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^        struct rtmsg rtm;$/", "file": true, "language": "C", "typeref": "struct:rtmsg", "kind": "member", "scope": "do_route_dump_requst::__anon533a8d700108", "scopeKind": "struct"}, {"_type": "tag", "name": "rtm_get_table", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^static inline int rtm_get_table(struct rtmsg *r, struct rtattr **tb)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(struct rtmsg * r,struct rtattr ** tb)"}, {"_type": "tag", "name": "rtnl_receive", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^int rtnl_receive(int fd, struct msghdr *msg, int flags)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int fd,struct msghdr * msg,int flags)"}, {"_type": "tag", "name": "rtnl_recvmsg", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^static int rtnl_recvmsg(int fd, struct msghdr *msg, char **answer)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int fd,struct msghdr * msg,char ** answer)"}, {"_type": "tag", "name": "sysevent_fd", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^static int sysevent_fd;$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "sysevent_token", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "pattern": "/^static token_t sysevent_token;$/", "file": true, "language": "C", "typeref": "typename:token_t", "kind": "variable"}], "hash": "7535bc436b522ed62a78274661592831", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/Utopia/source/NetworkMonitor/NetworkMonitor.c", "fields": [{"name": "void * bus_handle", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "const char * component_id", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char[32] mesh_wan_ifname", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "struct:nlmsghdr nlh", "scope": "do_route_dump_requst::__anon533a8d700108", "scopeKind": "struct", "description": "unavailable"}, {"name": "struct:rtmsg rtm", "scope": "do_route_dump_requst::__anon533a8d700108", "scopeKind": "struct", "description": "unavailable"}, {"name": "int sysevent_fd", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "token_t sysevent_token", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"20862": ""}]}