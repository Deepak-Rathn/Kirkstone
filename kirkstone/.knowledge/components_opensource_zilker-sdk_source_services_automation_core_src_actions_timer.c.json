{"is_source_file": true, "format": "C", "description": "This source file implements timer management logic for automation actions, including setting, deleting, and handling timer expiration, along with property change handling for configuration toggles.", "external_files": ["icLog/logging.h", "icTypes/icHashMap.h", "automationService.h", "ccronexpr.h", "automationAction.h", "automationEngine.h", "propsMgr/propsHelper.h", "propsMgr/propsService_eventAdapter.h", "timer.h"], "external_methods": ["jsonrpc_create_notification", "jsonrpc_create_response_success", "jsonrpc_create_response_error", "hashMapCreate", "hashMapDelete", "hashMapPut", "hashMapGet", "hashMapDestroy", "register_cpePropertyEvent_eventListener", "unregister_cpePropertyEvent_eventListener", "getPropertyAsBool", "getPropertyEventAsBool", "automationActionRegisterOps"], "published": ["timersMessageTargetInit", "timersMessageTargetDestroy"], "classes": [], "methods": [{"name": "void handlePropertyChangedEvent(cpePropertyEvent * event)", "description": "Handles property change events, specifically toggling fastTimer based on a property.", "scope": "", "scopeKind": ""}, {"name": "void freeTimerEntry(TimerEntry * timer)", "description": "Frees resources associated with a TimerEntry, including deleting timers and JSON objects.", "scope": "", "scopeKind": ""}, {"name": "void freeTimerEntryFromHash(void * key,void * value)", "description": "Helper to free a TimerEntry and its associated key from hash map.", "scope": "", "scopeKind": ""}, {"name": "void timerExpiredThreadProc(union sigval arg)", "description": "Callback executed when a timer expires; creates and posts a notification, then cleans up the timer from hash map.", "scope": "", "scopeKind": ""}, {"name": "time_t getTimeFromCron(const char * cron)", "description": "Parses a cron expression and returns the next scheduled time; -1 on failure.", "scope": "", "scopeKind": ""}, {"name": "cJSON * makeTimerActionHandler(const cJSON * id,const cJSON * params)", "description": "Creates a new timer based on provided parameters, supporting in and cron types, manages timer creation and tracking.", "scope": "", "scopeKind": ""}, {"name": "cJSON * deleteTimerActionHandler(const cJSON * id,const cJSON * params)", "description": "Deletes an existing timer identified by its ID.", "scope": "", "scopeKind": ""}, {"name": "void timersMessageTargetDestroy(void)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void timersMessageTargetInit(void)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["jsonrpc_create_notification", "jsonrpc_create_response_success", "jsonrpc_create_response_error", "hashMapCreate", "hashMapDelete", "hashMapPut", "hashMapGet", "timer_delete", "cron_parse_expr", "cron_next", "register_cpePropertyEvent_eventListener", "unregister_cpePropertyEvent_eventListener", "getPropertyAsBool", "getPropertyEventAsBool", "automationActionRegisterOps"], "search-terms": ["timer management", "automation timer", "cron timer", "timer expiration", "timer creation", "delete timer", "fast timer", "property-based toggle", "structured JSON message", "timer hash map"], "state": 2, "file_id": 1178, "knowledge_revision": 14335, "git_revision": "", "ctags": [{"_type": "tag", "name": "CRON_PARAM", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^#define CRON_PARAM /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "FAST_TIMER_ACTION_PROP", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^#define FAST_TIMER_ACTION_PROP /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "IN_PARAM", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^#define IN_PARAM /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "JSON_PRIVATE_KEY", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^#define JSON_PRIVATE_KEY /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "JSON_TIMERID_KEY", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^#define JSON_TIMERID_KEY /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TimerEntry", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^} TimerEntry;$/", "file": true, "language": "C", "typeref": "struct:__anonc31457b40108", "kind": "typedef"}, {"_type": "tag", "name": "__anonc31457b40108", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^{$/", "file": true, "language": "C", "kind": "struct"}, {"_type": "tag", "name": "deleteTimerActionHandler", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^static cJSON* deleteTimerActionHandler(const cJSON* id, const cJSON* params)$/", "file": true, "language": "C", "typeref": "typename:cJSON *", "kind": "function", "signature": "(const cJSON * id,const cJSON * params)"}, {"_type": "tag", "name": "fastTimer", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^static bool fastTimer = false;$/", "file": true, "language": "C", "typeref": "typename:bool", "kind": "variable"}, {"_type": "tag", "name": "freeTimerEntry", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^static void freeTimerEntry(TimerEntry* timer)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(TimerEntry * timer)"}, {"_type": "tag", "name": "freeTimerEntryFromHash", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^static void freeTimerEntryFromHash(void* key, void* value)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void * key,void * value)"}, {"_type": "tag", "name": "getTimeFromCron", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^static time_t getTimeFromCron(const char* cron)$/", "file": true, "language": "C", "typeref": "typename:time_t", "kind": "function", "signature": "(const char * cron)"}, {"_type": "tag", "name": "handlePropertyChangedEvent", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^static void handlePropertyChangedEvent(cpePropertyEvent *event)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(cpePropertyEvent * event)"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^    cJSON* id;$/", "file": true, "language": "C", "typeref": "typename:cJSON *", "kind": "member", "scope": "__anonc31457b40108", "scopeKind": "struct"}, {"_type": "tag", "name": "makeTimerActionHandler", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^static cJSON* makeTimerActionHandler(const cJSON* id, const cJSON* params)$/", "file": true, "language": "C", "typeref": "typename:cJSON *", "kind": "function", "signature": "(const cJSON * id,const cJSON * params)"}, {"_type": "tag", "name": "message", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^    cJSON* message;$/", "file": true, "language": "C", "typeref": "typename:cJSON *", "kind": "member", "scope": "__anonc31457b40108", "scopeKind": "struct"}, {"_type": "tag", "name": "timerExpiredThreadProc", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^static void timerExpiredThreadProc(union sigval arg)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(union sigval arg)"}, {"_type": "tag", "name": "timerId", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^    timer_t timerId;$/", "file": true, "language": "C", "typeref": "typename:timer_t", "kind": "member", "scope": "__anonc31457b40108", "scopeKind": "struct"}, {"_type": "tag", "name": "timers", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^static icHashMap* timers = NULL;$/", "file": true, "language": "C", "typeref": "typename:icHashMap *", "kind": "variable"}, {"_type": "tag", "name": "timersMessageTargetDestroy", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^void timersMessageTargetDestroy(void)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "timersMessageTargetInit", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^void timersMessageTargetInit(void)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "timersMtx", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "pattern": "/^static pthread_mutex_t timersMtx = PTHREAD_MUTEX_INITIALIZER;$/", "file": true, "language": "C", "typeref": "typename:pthread_mutex_t", "kind": "variable"}], "hash": "340b31b77ad79f0c8e8e7ce70ffc1adc", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "components/opensource/zilker-sdk/source/services/automation/core/src/actions/timer.c", "fields": [{"name": "bool fastTimer", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "cJSON * id", "scope": "__anonc31457b40108", "scopeKind": "struct", "description": "unavailable"}, {"name": "cJSON * message", "scope": "__anonc31457b40108", "scopeKind": "struct", "description": "unavailable"}, {"name": "timer_t timerId", "scope": "__anonc31457b40108", "scopeKind": "struct", "description": "unavailable"}, {"name": "icHashMap * timers", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pthread_mutex_t timersMtx", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"14335": ""}]}