{"is_source_file": true, "format": "C", "description": "This source file implements a device communication watchdog for monitoring device connectivity status. It manages monitored devices, checks for communication failures based on timeouts, and triggers callbacks when devices enter or exit communication failure states. It includes threading, synchronization, and property event handling for dynamic configuration.", "external_files": ["deviceCommunicationWatchdog.h", "<stdint.h>", "<stdbool.h>", "<unistd.h>", "<inttypes.h>", "<icTypes/icHashMap.h>", "<pthread.h>", "<icLog/logging.h>", "<string.h>", "<icTime/timeUtils.h>", "<icTypes/icLinkedList.h>", "<icConcurrent/timedWait.h>", "<propsMgr/propsService_eventAdapter.h>", "<propsMgr/propsHelper.h>", "<propsMgr/commonProperties.h>", "<icConcurrent/threadUtils.h>", "<icUtil/stringUtils.h>"], "external_methods": ["register_cpePropertyEvent_eventListener", "unregister_cpePropertyEvent_eventListener", "getPropertyAsBool", "createThread", "hashMapCreate", "hashMapDestroy", "hashMapPut", "hashMapDelete", "hashMapGet", "hashMapIteratorCreate", "hashMapIteratorHasNext", "hashMapIteratorGetNext", "hashMapIteratorDestroy", "linkedListCreate", "linkedListAppend", "linkedListDestroy", "linkedListIteratorCreate", "linkedListIteratorHasNext", "linkedListIteratorGetNext", "linkedListIteratorDestroy", "initTimedWaitCond", "incrementalCondTimedWait", "incrementalCondTimedWaitMillis", "getMonotonicMillis", "createThread", "stringValueOfBool"], "published": ["deviceCommunicationWatchdogInit", "deviceCommunicationWatchdogSetMonitorInterval", "deviceCommunicationWatchdogTerm", "deviceCommunicationWatchdogMonitorDevice", "deviceCommunicationWatchdogStopMonitoringDevice", "deviceCommunicationWatchdogPetDevice", "deviceCommunicationWatchdogForceDeviceInCommFail", "deviceCommunicationWatchdogGetRemainingCommFailTimeoutForLPM", "deviceCommunicationWatchdogResetTimeoutForDevice"], "classes": [], "methods": [{"name": "void deviceCommunicationWatchdogInit(deviceCommunicationWatchdogCommFailedCallback failedcb,deviceCommunicationWatchdogCommRestoredCallback restoredcb)", "description": "Initializes the watchdog, setting up callback functions, starting the monitoring thread, and registering event listeners.", "scope": "", "scopeKind": ""}, {"name": "void deviceCommunicationWatchdogSetMonitorInterval(uint32_t seconds)", "description": "Sets the interval (in seconds) at which the monitoring thread wakes up to check device statuses.", "scope": "", "scopeKind": ""}, {"name": "void deviceCommunicationWatchdogTerm()", "description": "Terminates the watchdog, cleans up resources, and stops monitoring activities.", "scope": "", "scopeKind": ""}, {"name": "void deviceCommunicationWatchdogMonitorDevice(const char * uuid,const uint32_t commFailTimeoutSeconds,bool inCommFail)", "description": "Adds a device to be monitored with specified timeout and initial communication fail state.", "scope": "", "scopeKind": ""}, {"name": "void deviceCommunicationWatchdogStopMonitoringDevice(const char * uuid)", "description": "Removes a device from monitoring.", "scope": "", "scopeKind": ""}, {"name": "void deviceCommunicationWatchdogPetDevice(const char * uuid)", "description": "Updates the last successful communication timestamp for a device, indicating it is responsive.", "scope": "", "scopeKind": ""}, {"name": "void deviceCommunicationWatchdogForceDeviceInCommFail(const char * uuid)", "description": "Forces a device into a communication failure state, triggering the failure callback.", "scope": "", "scopeKind": ""}, {"name": "int32_t deviceCommunicationWatchdogGetRemainingCommFailTimeoutForLPM(const char * uuid,uint32_t commFailDelaySeconds)", "description": "Returns the remaining time before a device times out and enters communication failure based on last contact.", "scope": "", "scopeKind": ""}, {"name": "void deviceCommunicationWatchdogResetTimeoutForDevice(const char * uuid,uint32_t commFailTimeoutSeconds)", "description": "Resets or updates the communication failure timeout for a device.", "scope": "", "scopeKind": ""}, {"name": "void * commFailWatchdogThreadProc(void * arg)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void handlePropertyChangedEvent(cpePropertyEvent * event)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void monitoredDevicesEntryDestroy(void * key,void * value)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["register_cpePropertyEvent_eventListener", "unregister_cpePropertyEvent_eventListener", "getPropertyAsBool", "createThread", "hashMapCreate", "hashMapDestroy", "hashMapPut", "hashMapDelete", "hashMapGet", "hashMapIteratorCreate", "hashMapIteratorHasNext", "hashMapIteratorGetNext", "hashMapIteratorDestroy", "linkedListCreate", "linkedListAppend", "linkedListDestroy", "linkedListIteratorCreate", "linkedListIteratorHasNext", "linkedListIteratorGetNext", "linkedListIteratorDestroy", "initTimedWaitCond", "incrementalCondTimedWait", "incrementalCondTimedWaitMillis", "getMonotonicMillis", "stringValueOfBool"], "search-terms": ["device communication watchdog", "monitor device timeout", "communication failure detection", "property event listener", "threaded device monitoring", "communication watchdog callbacks", "device monitoring hash map", "fast comm fail timer", "monitoring thread sleep interval"], "state": 2, "file_id": 957, "knowledge_revision": 14119, "git_revision": "", "ctags": [{"_type": "tag", "name": "FAST_COMM_FAIL_PROP", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^#define FAST_COMM_FAIL_PROP /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "LOG_TAG", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^#define LOG_TAG /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "MONITOR_THREAD_SLEEP_SECS", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^#define MONITOR_THREAD_SLEEP_SECS /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "MonitoredDeviceInfo", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^} MonitoredDeviceInfo;$/", "file": true, "language": "C", "typeref": "struct:__anonb35196b90108", "kind": "typedef"}, {"_type": "tag", "name": "__anonb35196b90108", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^{$/", "file": true, "language": "C", "kind": "struct"}, {"_type": "tag", "name": "commFailTimeoutSeconds", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^    uint32_t commFailTimeoutSeconds;$/", "file": true, "language": "C", "typeref": "typename:uint32_t", "kind": "member", "scope": "__anonb35196b90108", "scopeKind": "struct"}, {"_type": "tag", "name": "commFailWatchdogThreadProc", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static void* commFailWatchdogThreadProc(void* arg)$/", "file": true, "language": "C", "typeref": "typename:void *", "kind": "function", "signature": "(void * arg)"}, {"_type": "tag", "name": "controlCond", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static pthread_cond_t controlCond = PTHREAD_COND_INITIALIZER;$/", "file": true, "language": "C", "typeref": "typename:pthread_cond_t", "kind": "variable"}, {"_type": "tag", "name": "controlMutex", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static pthread_mutex_t controlMutex = PTHREAD_MUTEX_INITIALIZER;$/", "file": true, "language": "C", "typeref": "typename:pthread_mutex_t", "kind": "variable"}, {"_type": "tag", "name": "deviceCommunicationWatchdogForceDeviceInCommFail", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^void deviceCommunicationWatchdogForceDeviceInCommFail(const char *uuid)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(const char * uuid)"}, {"_type": "tag", "name": "deviceCommunicationWatchdogGetRemainingCommFailTimeoutForLPM", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^int32_t deviceCommunicationWatchdogGetRemainingCommFailTimeoutForLPM(const char *uuid, uint32_t /", "language": "C", "typeref": "typename:int32_t", "kind": "function", "signature": "(const char * uuid,uint32_t commFailDelaySeconds)"}, {"_type": "tag", "name": "deviceCommunicationWatchdogInit", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^void deviceCommunicationWatchdogInit(deviceCommunicationWatchdogCommFailedCallback failedcb,$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(deviceCommunicationWatchdogCommFailedCallback failedcb,deviceCommunicationWatchdogCommRestoredCallback restoredcb)"}, {"_type": "tag", "name": "deviceCommunicationWatchdogMonitorDevice", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^void deviceCommunicationWatchdogMonitorDevice(const char* uuid, const uint32_t commFailTimeoutSe/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(const char * uuid,const uint32_t commFailTimeoutSeconds,bool inCommFail)"}, {"_type": "tag", "name": "deviceCommunicationWatchdogPetDevice", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^void deviceCommunicationWatchdogPetDevice(const char* uuid)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(const char * uuid)"}, {"_type": "tag", "name": "deviceCommunicationWatchdogResetTimeoutForDevice", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^void deviceCommunicationWatchdogResetTimeoutForDevice(const char *uuid, uint32_t commFailTimeout/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(const char * uuid,uint32_t commFailTimeoutSeconds)"}, {"_type": "tag", "name": "deviceCommunicationWatchdogSetMonitorInterval", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^void deviceCommunicationWatchdogSetMonitorInterval(uint32_t seconds)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(uint32_t seconds)"}, {"_type": "tag", "name": "deviceCommunicationWatchdogStopMonitoringDevice", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^void deviceCommunicationWatchdogStopMonitoringDevice(const char* uuid)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(const char * uuid)"}, {"_type": "tag", "name": "deviceCommunicationWatchdogTerm", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^void deviceCommunicationWatchdogTerm()$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "failedCallback", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static deviceCommunicationWatchdogCommFailedCallback failedCallback = NULL;$/", "file": true, "language": "C", "typeref": "typename:deviceCommunicationWatchdogCommFailedCallback", "kind": "variable"}, {"_type": "tag", "name": "fastCommFailTimer", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static bool fastCommFailTimer = false;$/", "file": true, "language": "C", "typeref": "typename:bool", "kind": "variable"}, {"_type": "tag", "name": "handlePropertyChangedEvent", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static void handlePropertyChangedEvent(cpePropertyEvent *event)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(cpePropertyEvent * event)"}, {"_type": "tag", "name": "inCommFail", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^    bool inCommFail;$/", "file": true, "language": "C", "typeref": "typename:bool", "kind": "member", "scope": "__anonb35196b90108", "scopeKind": "struct"}, {"_type": "tag", "name": "lastSuccessfulCommunicationMillis", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^    uint64_t lastSuccessfulCommunicationMillis;$/", "file": true, "language": "C", "typeref": "typename:uint64_t", "kind": "member", "scope": "__anonb35196b90108", "scopeKind": "struct"}, {"_type": "tag", "name": "monitorThreadId", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static pthread_t monitorThreadId;$/", "file": true, "language": "C", "typeref": "typename:pthread_t", "kind": "variable"}, {"_type": "tag", "name": "monitorThreadSleepSeconds", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static uint32_t monitorThreadSleepSeconds = MONITOR_THREAD_SLEEP_SECS;$/", "file": true, "language": "C", "typeref": "typename:uint32_t", "kind": "variable"}, {"_type": "tag", "name": "monitoredDevices", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static icHashMap* monitoredDevices = NULL;$/", "file": true, "language": "C", "typeref": "typename:icHashMap *", "kind": "variable"}, {"_type": "tag", "name": "monitoredDevicesEntryDestroy", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static void monitoredDevicesEntryDestroy(void* key, void* value)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void * key,void * value)"}, {"_type": "tag", "name": "monitoredDevicesMutex", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static pthread_mutex_t monitoredDevicesMutex = PTHREAD_MUTEX_INITIALIZER;$/", "file": true, "language": "C", "typeref": "typename:pthread_mutex_t", "kind": "variable"}, {"_type": "tag", "name": "restoredCallback", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static deviceCommunicationWatchdogCommRestoredCallback restoredCallback = NULL;$/", "file": true, "language": "C", "typeref": "typename:deviceCommunicationWatchdogCommRestoredCallback", "kind": "variable"}, {"_type": "tag", "name": "running", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^static bool running = false;$/", "file": true, "language": "C", "typeref": "typename:bool", "kind": "variable"}, {"_type": "tag", "name": "uuid", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "pattern": "/^    char* uuid;$/", "file": true, "language": "C", "typeref": "typename:char *", "kind": "member", "scope": "__anonb35196b90108", "scopeKind": "struct"}], "hash": "afdafc2d0c6da2089dc071097af1821f", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "components/opensource/zilker-sdk/source/services/device/core/src/deviceCommunicationWatchdog.c", "fields": [{"name": "uint32_t commFailTimeoutSeconds", "scope": "__anonb35196b90108", "scopeKind": "struct", "description": "unavailable"}, {"name": "pthread_cond_t controlCond", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pthread_mutex_t controlMutex", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "deviceCommunicationWatchdogCommFailedCallback failedCallback", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool fastCommFailTimer", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool inCommFail", "scope": "__anonb35196b90108", "scopeKind": "struct", "description": "unavailable"}, {"name": "uint64_t lastSuccessfulCommunicationMillis", "scope": "__anonb35196b90108", "scopeKind": "struct", "description": "unavailable"}, {"name": "pthread_t monitorThreadId", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "uint32_t monitorThreadSleepSeconds", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "icHashMap * monitoredDevices", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pthread_mutex_t monitoredDevicesMutex", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "deviceCommunicationWatchdogCommRestoredCallback restoredCallback", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool running", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char * uuid", "scope": "__anonb35196b90108", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"14119": ""}]}