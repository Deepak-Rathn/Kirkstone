{"is_source_file": true, "format": "C", "description": "This is a C source file implementing Auto WAN Management for a network device. It includes functions to handle WAN modes (auto, Ethernet, DOCSIS), check and manage WAN connections, toggle interfaces, and handle retries/reboots based on link status, specifically for Ethernet and DOCSIS interfaces.", "external_files": ["autowan.h", "ansc_wrapper_base.h", "cm_hal.h", "gw_prov_ethwan.h", "ccsp_hal_ethsw.h", "sysevent/sysevent.h", "syscfg/syscfg.h", "rdk_debug.h"], "external_methods": ["syscfg_get", "syscfg_set_u_commit", "syscfg_set_commit", "sysevent_get", "GWP_GetEthWanInterfaceName", "docsis_getCMStatus", "CcspHalExtSw_getEthWanEnable", "CcspHalExtSw_setEthWanEnable", "CosaDmlEthWanSetEnable", "sysctl -w net.ipv6.conf.%s.accept_ra=2", "system"], "published": ["GetCurrentWanMode", "SetCurrentWanMode", "GetSelectedWanMode", "SelectedWanMode", "GetLastKnownWanMode", "SetLastKnownWanMode", "AutoWAN_main"], "classes": [], "methods": [{"name": "char * WanModeStr(int WanMode)", "description": "Converts WAN mode integer value to human-readable string", "scope": "", "scopeKind": ""}, {"name": "void LogWanModeInfo()", "description": "Logs current, selected, and last known WAN modes", "scope": "", "scopeKind": ""}, {"name": "void AutoWAN_main()", "description": "Initializes auto WAN configuration and starts WAN manager thread", "scope": "", "scopeKind": ""}, {"name": "void IntializeAutoWanConfig()", "description": "Initializes WAN mode variables from syscfg and sets defaults", "scope": "", "scopeKind": ""}, {"name": "int GetCurrentWanMode()", "description": "Returns the current WAN mode", "scope": "", "scopeKind": ""}, {"name": "void SetCurrentWanMode(int mode)", "description": "Sets the current WAN mode and updates syscfg", "scope": "", "scopeKind": ""}, {"name": "int GetSelectedWanMode()", "description": "Returns the selected WAN mode", "scope": "", "scopeKind": ""}, {"name": "void SelectedWanMode(int mode)", "description": "Sets the selected WAN mode and updates syscfg", "scope": "", "scopeKind": ""}, {"name": "int GetLastKnownWanMode()", "description": "Returns the last known WAN mode", "scope": "", "scopeKind": ""}, {"name": "void SetLastKnownWanMode(int mode)", "description": "Sets the last known WAN mode and updates syscfg", "scope": "", "scopeKind": ""}, {"name": "void * WanMngrThread(void * arg)", "description": "Main thread for managing WAN modes based on connection status and retries", "scope": "", "scopeKind": ""}, {"name": "void HandleAutoWanMode(void)", "description": "Handles WAN mode based on last known mode and manages connections", "scope": "", "scopeKind": ""}, {"name": "void ManageWanModes(int mode)", "description": "Attempts to lock in a WAN mode by checking connection status and toggling interfaces if needed", "scope": "", "scopeKind": ""}, {"name": "int CheckWanConnection(int mode)", "description": "Retries checking WAN connection status with configured retries", "scope": "", "scopeKind": ""}, {"name": "int CheckWanStatus(int mode)", "description": "Checks the status of WAN connection (Ethernet or DOCSIS) via syscalls and system status", "scope": "", "scopeKind": ""}, {"name": "void TryAltWan(int * mode)", "description": "Switches WAN mode to alternate interface/mode, toggling interfaces and adjusting configurations", "scope": "", "scopeKind": ""}, {"name": "void RevertTriedConfig(int mode)", "description": "Restores previous WAN configuration if a mode switch fails", "scope": "", "scopeKind": ""}, {"name": "void AutoWan_BkupAndReboot()", "description": "Performs system reboot with a reason set in syscfg due to WAN mode change", "scope": "", "scopeKind": ""}, {"name": "int CosaDmlEthWanSetEnable(BOOL bEnable)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["system", "popen", "pclose", "sleep", "strnlen", "strcmp", "strcpy", "snprintf", "syscfg_get", "syscfg_set_u_commit", "syscfg_set_commit", "sysevent_get", "GWP_GetEthWanInterfaceName", "docsis_getCMStatus", "CosaDmlEthWanSetEnable", "system"], "search-terms": ["AutoWAN", "WAN mode management", "Ethernet WAN control", "DOCSISWAN control", "WAN connection check", "WAN toggle", "Reboot system", "WAN configuration switch"], "state": 2, "file_id": 5847, "knowledge_revision": 18955, "git_revision": "", "ctags": [{"_type": "tag", "name": "AUTOWAN_RETRY_CNT", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define AUTOWAN_RETRY_CNT\t/", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "AUTOWAN_RETRY_INTERVAL", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define AUTOWAN_RETRY_INTERVAL\t/", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "AUTO_WAN_LOG", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define AUTO_WAN_LOG /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "AutoWAN_main", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^void AutoWAN_main()$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "AutoWan_BkupAndReboot", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^void AutoWan_BkupAndReboot()$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "BOOL", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define BOOL /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "CheckWanConnection", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^int CheckWanConnection(int mode)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int mode)"}, {"_type": "tag", "name": "CheckWanStatus", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^int CheckWanStatus(int mode)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int mode)"}, {"_type": "tag", "name": "CosaDmlEthWanSetEnable", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^CosaDmlEthWanSetEnable$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(BOOL bEnable)"}, {"_type": "tag", "name": "FALSE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define FALSE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "GetCurrentWanMode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^int GetCurrentWanMode()$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "GetLastKnownWanMode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^int GetLastKnownWanMode()$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "GetSelectedWanMode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^int GetSelectedWanMode()$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "HandleAutoWanMode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^void HandleAutoWanMode(void)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "IntializeAutoWanConfig", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^void IntializeAutoWanConfig()$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "LogWanModeInfo", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^void LogWanModeInfo()$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "ManageWanModes", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^void ManageWanModes(int mode)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(int mode)"}, {"_type": "tag", "name": "ONEWIFI_ENABLED", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define ONEWIFI_ENABLED /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "OPENVSWITCH_LOADED", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define OPENVSWITCH_LOADED /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "RevertTriedConfig", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^void RevertTriedConfig(int mode)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(int mode)"}, {"_type": "tag", "name": "SelectedWanMode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^void SelectedWanMode(int mode)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(int mode)"}, {"_type": "tag", "name": "SetCurrentWanMode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^void SetCurrentWanMode(int mode)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(int mode)"}, {"_type": "tag", "name": "SetLastKnownWanMode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^void SetLastKnownWanMode(int mode)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(int mode)"}, {"_type": "tag", "name": "TRUE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define TRUE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TryAltWan", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^void TryAltWan(int *mode)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(int * mode)"}, {"_type": "tag", "name": "WAN_MODE_AUTO", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define WAN_MODE_AUTO\t/", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "WAN_MODE_DOCSIS", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define WAN_MODE_DOCSIS\t/", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "WAN_MODE_ETH", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define WAN_MODE_ETH\t/", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "WAN_MODE_UNKNOWN", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define WAN_MODE_UNKNOWN\t/", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "WFO_ENABLED", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^#define WFO_ENABLED /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "WanMngrThread", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^void* WanMngrThread(void* arg)$/", "language": "C", "typeref": "typename:void *", "kind": "function", "signature": "(void * arg)"}, {"_type": "tag", "name": "WanModeStr", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^char* WanModeStr(int WanMode)$/", "language": "C", "typeref": "typename:char *", "kind": "function", "signature": "(int WanMode)"}, {"_type": "tag", "name": "g_AutoWanRetryCnt", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^int g_AutoWanRetryCnt \t\t= 0;$/", "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "g_AutoWanRetryInterval", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^int g_AutoWanRetryInterval \t= 0;$/", "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "g_CurrentWanMode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^int g_CurrentWanMode \t\t= 0;$/", "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "g_LastKnowWanMode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^int g_LastKnowWanMode \t\t= 0;$/", "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "g_OvsEnable", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^    int g_OvsEnable             = 0;$/", "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "g_SelectedWanMode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "pattern": "/^int g_SelectedWanMode \t\t= 0;$/", "language": "C", "typeref": "typename:int", "kind": "variable"}], "hash": "9b92e12609837137f8a49843dc41462f", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/GwProvApp-EthWan/source/autowan.c", "fields": [{"name": "int g_AutoWanRetryCnt", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int g_AutoWanRetryInterval", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int g_CurrentWanMode", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int g_LastKnowWanMode", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int g_OvsEnable", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int g_SelectedWanMode", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"18955": ""}]}