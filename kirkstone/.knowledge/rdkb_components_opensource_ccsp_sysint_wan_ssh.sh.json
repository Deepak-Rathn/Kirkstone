{"is_source_file": true, "format": "Shell Script (sh)", "description": "A shell script that manages WAN-side SSH access by configuring dropbear, firewall rules, and handling IP addresses. It includes functions to start and stop SSH service on the WAN interface, as well as to add or remove firewall rules for SSH traffic.", "external_files": ["/etc/waninfo.sh", "/etc/mount-utils/getConfigFile.sh", "/etc/sshbanner.txt"], "external_methods": ["getWanInterfaceName", "getConfigFile", "ip", "awk", "cut", "ps", "grep", "kill", "mkdir", "dropbear", "iptables", "ip6tables", "sleep"], "published": [], "classes": [], "methods": [{"name": "get_wan_ips", "description": "Retrieves current IPv4 and IPv6 addresses for the WAN interface and constructs corresponding parameters for SSH configuration."}, {"name": "start_dropbear_wan", "description": "Starts the dropbear SSH server with the configured parameters."}, {"name": "add_v4firewall_rule", "description": "Adds an IPv4 firewall rule to accept SSH traffic on the WAN interface."}, {"name": "add_v6firewall_rule", "description": "Adds an IPv6 firewall rule to accept SSH traffic on the WAN interface."}, {"name": "remove_v4firewall_rule", "description": "Removes the IPv4 firewall rule for SSH traffic."}, {"name": "remove_v6firewall_rule", "description": "Removes the IPv6 firewall rule for SSH traffic."}, {"name": "start_wan_ssh_service", "description": "Enters a loop to monitor WAN IP addresses and ensure SSH and firewall rules are active."}, {"name": "stop_wan_ssh_service", "description": "Stops the SSH service and removes firewall rules based on current IP addresses."}], "calls": ["getWanInterfaceName", "getConfigFile", "ip", "awk", "cut", "ps", "grep", "kill", "mkdir", "dropbear", "iptables", "ip6tables", "sleep"], "search-terms": ["wan_ssh.sh", "dropbear", "firewall", "WAN side SSH", "IP retrieval", "WAN interface"], "state": 2, "file_id": 7068, "knowledge_revision": 20146, "git_revision": "", "hash": "d401c47ce19407a0924ae58987910e7c", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/sysint/wan_ssh.sh", "revision_history": [{"20146": ""}]}