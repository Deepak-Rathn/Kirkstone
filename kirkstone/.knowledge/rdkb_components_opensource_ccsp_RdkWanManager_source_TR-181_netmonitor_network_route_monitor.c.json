{"is_source_file": true, "format": "C", "description": "This file is a C source file implementing network route monitoring using netlink sockets. It includes functions for handling IPv6 default route changes, toggling system events, and integrating with other system components like sysevents and secure system calls.", "external_files": ["ipc_msg.h", "network_route_monitor.h", "ansc_platform.h", "ansc_string_util.h", "<sysevent/sysevent.h>", "secure_wrapper.h"], "external_methods": ["sysevent_open", "sysevent_set", "sysevent_get", "v_secure_popen", "v_secure_pclose", "v_secure_system", "DBG_MONITOR_PRINT"], "published": ["main"], "classes": [], "methods": [{"name": "void parse_rtattr(struct rtattr * tb[],int max,struct rtattr * rta,int len)", "description": "Parses route attributes from netlink messages, populating an array of rtattr pointers.", "scope": "", "scopeKind": ""}, {"name": "ANSC_STATUS isDefaultGatewaypresent(struct nlmsghdr * nlmsgHdr)", "description": "Checks whether a netlink route message indicates the presence of a default gateway in the main routing table.", "scope": "", "scopeKind": ""}, {"name": "ANSC_STATUS NetMonitor_InitNetlinkRouteMonitorFd()", "description": "Initializes and binds a netlink socket to monitor IPv6 route changes.", "scope": "", "scopeKind": ""}, {"name": "void NetMonitor_DoToggleV6Status(bool flag)", "description": "Sets system events to toggle IPv6 status based on flag.", "scope": "", "scopeKind": ""}, {"name": "void netMonitor_SyseventInit()", "description": "Initializes the sysevent communication channel.", "scope": "", "scopeKind": ""}, {"name": "void NetMonitor_ProcessNetlinkRouteMonitorFd()", "description": "Processes incoming netlink messages related to route changes, updating IPv6 default route status accordingly.", "scope": "", "scopeKind": ""}, {"name": "void NetMonitor_DeInitNetlinkRouteMonitorFd()", "description": "Cleans up and closes the netlink socket.", "scope": "", "scopeKind": ""}, {"name": "int WanManager_MaptRouteSetting()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int get_v6_default_gw_wan(char * defGateway,size_t length)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int main(int argc,char * argv[])", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["sysevent_open", "sysevent_set", "sysevent_get", "v_secure_popen", "v_secure_pclose", "v_secure_system", "DBG_MONITOR_PRINT", "close"], "search-terms": ["netlink route", "IPv6 default gateway", "router route monitor", "netmonitor", "system event toggle", "netlink socket"], "state": 2, "file_id": 9478, "knowledge_revision": 22489, "git_revision": "", "ctags": [{"_type": "tag", "name": "BUFLEN_1024", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define BUFLEN_1024 /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "BUFLEN_128", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define BUFLEN_128 /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "BUFLEN_256", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define BUFLEN_256 /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "BUFLEN_64", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define BUFLEN_64 /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "LOOP_TIMEOUT", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define LOOP_TIMEOUT /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "MAPT_MTU_SIZE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define MAPT_MTU_SIZE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "MAP_WAN_IFACE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define MAP_WAN_IFACE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "MTU_DEFAULT_SIZE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define MTU_DEFAULT_SIZE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "NETMONITOR_SYSNAME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define NETMONITOR_SYSNAME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "NetMonitor_DeInitNetlinkRouteMonitorFd", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^static void NetMonitor_DeInitNetlinkRouteMonitorFd()$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "NetMonitor_DoToggleV6Status", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^static void NetMonitor_DoToggleV6Status(bool flag)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(bool flag)"}, {"_type": "tag", "name": "NetMonitor_InitNetlinkRouteMonitorFd", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^static ANSC_STATUS NetMonitor_InitNetlinkRouteMonitorFd()$/", "file": true, "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "NetMonitor_ProcessNetlinkRouteMonitorFd", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^static void NetMonitor_ProcessNetlinkRouteMonitorFd()$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "SET", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define SET /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SE_SERVER_WELL_KNOWN_PORT", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define SE_SERVER_WELL_KNOWN_PORT /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SE_VERSION", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define SE_VERSION /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SYSEVENT_IPV6_TOGGLE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define SYSEVENT_IPV6_TOGGLE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SYSEVENT_MAPT_CONFIG_FLAG", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define SYSEVENT_MAPT_CONFIG_FLAG /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SYSEVENT_MAP_BR_IPV6_PREFIX", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define SYSEVENT_MAP_BR_IPV6_PREFIX /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SYSEVENT_OPEN_MAX_RETRIES", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define SYSEVENT_OPEN_MAX_RETRIES /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SYS_IP_ADDR", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define SYS_IP_ADDR /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "UPDATE_MAXFD", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^#define UPDATE_MAXFD(/", "file": true, "language": "C", "kind": "macro", "signature": "(f)"}, {"_type": "tag", "name": "WanManager_MaptRouteSetting", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^static int WanManager_MaptRouteSetting()$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "errorFdsMaster", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^static fd_set errorFdsMaster;$/", "file": true, "language": "C", "typeref": "typename:fd_set", "kind": "variable"}, {"_type": "tag", "name": "g_toggle_flag", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^static bool g_toggle_flag = TRUE;$/", "file": true, "language": "C", "typeref": "typename:bool", "kind": "variable"}, {"_type": "tag", "name": "get_v6_default_gw_wan", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^static int get_v6_default_gw_wan(char *defGateway, size_t length)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * defGateway,size_t length)"}, {"_type": "tag", "name": "isDefaultGatewaypresent", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^static ANSC_STATUS isDefaultGatewaypresent(struct nlmsghdr* nlmsgHdr)$/", "file": true, "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(struct nlmsghdr * nlmsgHdr)"}, {"_type": "tag", "name": "main", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^int main(int argc, char* argv[])$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int argc,char * argv[])"}, {"_type": "tag", "name": "maxFd", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^static int maxFd = 50;$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "netMonitor_SyseventInit", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^static void netMonitor_SyseventInit()$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "netlinkRouteMonitorFd", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^int netlinkRouteMonitorFd = -1; \\/\\/subscribe to route change events$/", "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "parse_rtattr", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^static void parse_rtattr(struct rtattr *tb[], int max, struct rtattr *rta, int len)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(struct rtattr * tb[],int max,struct rtattr * rta,int len)"}, {"_type": "tag", "name": "readFdsMaster", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^fd_set readFdsMaster;$/", "language": "C", "typeref": "typename:fd_set", "kind": "variable"}, {"_type": "tag", "name": "sysevent_fd", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^int sysevent_fd = -1;$/", "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "sysevent_token", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "pattern": "/^token_t sysevent_token;$/", "language": "C", "typeref": "typename:token_t", "kind": "variable"}], "hash": "14fe78fd72d349d283dc0858c7e00308", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/RdkWanManager/source/TR-181/netmonitor/network_route_monitor.c", "fields": [{"name": "fd_set errorFdsMaster", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool g_toggle_flag", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int maxFd", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int netlinkRouteMonitorFd", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "fd_set readFdsMaster", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int sysevent_fd", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "token_t sysevent_token", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"22489": ""}]}