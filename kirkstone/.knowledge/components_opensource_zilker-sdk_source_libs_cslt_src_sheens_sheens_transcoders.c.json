{"is_source_file": true, "format": "C", "description": "The file contains a C source code implementing a transcoder for 'sheens' within a rules-based system, specifically converting legacy 'icrules' into the Sheens JSON format, handling schedule entries, triggers, constraints, and actions.", "external_files": ["<cjson/cJSON.h>", "<libxml2/libxml/tree.h>", "<uuid/uuid.h>", "<cslt/cslt.h>", "<cslt/sheens.h>", "<cslt/icrules.h>", "<errno.h>", "<icrule/icrule.h>", "<inttypes.h>", "<deviceService/deviceService_event.h>", "<commonDeviceDefs.h>", "<automationService/automationService_event.h>", "<icUtil/stringUtils.h>", "../cslt_internal.h", "sheens_transcoders.h", "../passthru_transcoder.h", "sheens_javascript.h", "sheens_json.h"], "external_methods": ["icrule_parse", "icrule_destroy", "linkedListCount", "linkedListRemove", "linkedListDestroy", "linkedListIteratorCreate", "linkedListIteratorHasNext", "linkedListIteratorGetNext", "sheens_schedules2javascript", "sheens_trigger2javascript", "sheens_negative2javascript", "sheens_constraints2javascript", "sheens_create_branch", "sheens_create_state_node", "sheens_create_reset_node", "sheens_actions2javascript", "sheens_actions_key", "sheens_constraints_key", "sheens_event_code_key", "sheens_allowed_key", "sheens_reset_value", "sheens_start_value", "icrule_t", "icrule_constraint_time_t"], "published": ["sheens_transcoder_init", "sheens_transcoder_map_device_id"], "classes": [{"name": "icrule_t", "description": "Represents a legacy iControl rule, including triggers, constraints, actions, and schedule entries."}, {"name": "icrule_constraint_time_t", "description": "Represents a time constraint within an iControl rule."}], "methods": [{"name": "bool icrule2sheens_is_valid(const char * schema)", "description": "Checks if a schema string is a valid legacy rule in XML format with the correct namespace.", "scope": "", "scopeKind": ""}, {"name": "bool sheens2sheens_is_valid(const char * schema)", "description": "Verifies if a schema string is a valid Sheens JSON with the correct version.", "scope": "", "scopeKind": ""}, {"name": "void sheens_transcoder_init(icHashMap * settings)", "description": "Initializes the Sheens transcoder module with optional settings, registering relevant factory and transcoders.", "scope": "", "scopeKind": ""}, {"name": "bool sheens_transcoder_map_device_id(const char * deviceId,char ** mappedDeviceId,char ** mappedEndpointId)", "description": "Maps a device ID to a different device and endpoint ID using a configured mapping function.", "scope": "", "scopeKind": ""}, {"name": "void add_automation_id_match(cJSON * pattern,uint64_t ruleId)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "cJSON * add_constraints_event_branch(cJSON * start_branches,const int eventId)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "icrule_constraint_time_t * find_and_remove_time_constraint(icLinkedList * constraints)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int icrule2sheens_transcode(const char * src,char ** dst,size_t size)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int transcode_actions(icrule_t * icrule,cJSON * nodes_object,cJSON * start_branches)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int transcode_constraints(icrule_t * icrule,cJSON * nodes_object)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int transcode_negative_rule(const icrule_t * icrule,cJSON * nodes_object,cJSON * start_branches)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int transcode_schedules(icrule_t * icrule,cJSON * nodes_object,cJSON * start_branches)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int transcode_triggers(const icrule_t * icrule,cJSON * nodes_object,cJSON * start_branches)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["icrule_parse", "linkedListCount", "linkedListRemove", "linkedListDestroy", "linkedListIteratorCreate", "linkedListIteratorHasNext", "linkedListIteratorGetNext", "sheens_schedules2javascript", "sheens_trigger2javascript", "sheens_negative2javascript", "sheens_constraints2javascript", "sheens_create_branch", "sheens_create_state_node", "sheens_create_reset_node", "sheens_actions2javascript"], "search-terms": ["sheens_transcoder", "icrule to sheens", "legacy schedule transcoding", "trigger pattern", "constraints JavaScript", "sheens JSON spec", "transcode negative rules", "device ID mapping"], "state": 2, "file_id": 825, "knowledge_revision": 13983, "git_revision": "", "ctags": [{"_type": "tag", "name": "ACTION_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define ACTION_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "CONSTRAINTS_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define CONSTRAINTS_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "DESCRIPTION_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define DESCRIPTION_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ELEMENT_CATEGORY", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define ELEMENT_CATEGORY /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ELEMENT_CONSTRAINT_AND", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define ELEMENT_CONSTRAINT_AND /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ELEMENT_CONSTRAINT_OR", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define ELEMENT_CONSTRAINT_OR /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ELEMENT_CONSTRAINT_SYSTEM", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define ELEMENT_CONSTRAINT_SYSTEM /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ELEMENT_CONSTRAINT_TIME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define ELEMENT_CONSTRAINT_TIME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ELEMENT_DESCRIPTION", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define ELEMENT_DESCRIPTION /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ELEMENT_SENSOR_ID", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define ELEMENT_SENSOR_ID /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ELEMENT_SENSOR_STATE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define ELEMENT_SENSOR_STATE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ELEMENT_SENSOR_TYPE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define ELEMENT_SENSOR_TYPE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "IC_RULE_TO_SHEENS_TRANSCODER_VERSION", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define IC_RULE_TO_SHEENS_TRANSCODER_VERSION /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SCHEDULE_ENTRY_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define SCHEDULE_ENTRY_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SHEENS_VERSION_KEY", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define SHEENS_VERSION_KEY /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_CLOUD_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_CLOUD_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_CLOUD_SERVICE_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_CLOUD_SERVICE_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_DOORLOCK_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_DOORLOCK_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_LIGHTING_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_LIGHTING_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_LIST_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_LIST_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_NETWORK_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_NETWORK_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_PANIC_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_PANIC_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_RESOURCE_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_RESOURCE_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_SENSOR_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_SENSOR_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_SWITCH_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_SWITCH_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_TIME_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_TIME_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_TOUCHSCREEN_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_TOUCHSCREEN_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_TSTAT_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_TSTAT_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_TSTAT_THRESHOLD_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_TSTAT_THRESHOLD_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TRIGGER_ZIGBEE_COMMSTATUS_NODE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^#define TRIGGER_ZIGBEE_COMMSTATUS_NODE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "add_automation_id_match", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static void add_automation_id_match(cJSON* pattern, uint64_t ruleId)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(cJSON * pattern,uint64_t ruleId)"}, {"_type": "tag", "name": "add_constraints_event_branch", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static cJSON* add_constraints_event_branch(cJSON* start_branches, const int eventId)$/", "file": true, "language": "C", "typeref": "typename:cJSON *", "kind": "function", "signature": "(cJSON * start_branches,const int eventId)"}, {"_type": "tag", "name": "deviceIdMapper", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static DeviceIdMapperFunc deviceIdMapper = NULL;$/", "file": true, "language": "C", "typeref": "typename:DeviceIdMapperFunc", "kind": "variable"}, {"_type": "tag", "name": "find_and_remove_time_constraint", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static icrule_constraint_time_t* find_and_remove_time_constraint(icLinkedList* constraints)$/", "file": true, "language": "C", "typeref": "typename:icrule_constraint_time_t *", "kind": "function", "signature": "(icLinkedList * constraints)"}, {"_type": "tag", "name": "icrule2sheens_is_valid", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static bool icrule2sheens_is_valid(const char* schema)$/", "file": true, "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "(const char * schema)"}, {"_type": "tag", "name": "icrule2sheens_transcode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static int icrule2sheens_transcode(const char* src, char** dst, size_t size)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(const char * src,char ** dst,size_t size)"}, {"_type": "tag", "name": "icrule2sheens_transcoder", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static const cslt_transcoder_t icrule2sheens_transcoder = {$/", "file": true, "language": "C", "typeref": "typename:const cslt_transcoder_t", "kind": "variable"}, {"_type": "tag", "name": "sheens2sheens_is_valid", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static bool sheens2sheens_is_valid(const char* schema)$/", "file": true, "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "(const char * schema)"}, {"_type": "tag", "name": "sheens2sheens_transcoder", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static const cslt_transcoder_t sheens2sheens_transcoder = {$/", "file": true, "language": "C", "typeref": "typename:const cslt_transcoder_t", "kind": "variable"}, {"_type": "tag", "name": "sheens_factory", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static cslt_factory_t sheens_factory = {$/", "file": true, "language": "C", "typeref": "typename:cslt_factory_t", "kind": "variable"}, {"_type": "tag", "name": "sheens_transcoder_init", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^void sheens_transcoder_init(icHashMap* settings)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(icHashMap * settings)"}, {"_type": "tag", "name": "sheens_transcoder_map_device_id", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^bool sheens_transcoder_map_device_id(const char* deviceId, char **mappedDeviceId, char **mappedE/", "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "(const char * deviceId,char ** mappedDeviceId,char ** mappedEndpointId)"}, {"_type": "tag", "name": "transcode_actions", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static int transcode_actions(icrule_t* icrule, cJSON* nodes_object, cJSON* start_branches)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(icrule_t * icrule,cJSON * nodes_object,cJSON * start_branches)"}, {"_type": "tag", "name": "transcode_constraints", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static int transcode_constraints(icrule_t* icrule, cJSON* nodes_object)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(icrule_t * icrule,cJSON * nodes_object)"}, {"_type": "tag", "name": "transcode_negative_rule", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static int transcode_negative_rule(const icrule_t* icrule, cJSON* nodes_object, cJSON* start_bra/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(const icrule_t * icrule,cJSON * nodes_object,cJSON * start_branches)"}, {"_type": "tag", "name": "transcode_schedules", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static int transcode_schedules(icrule_t* icrule, cJSON* nodes_object, cJSON* start_branches)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(icrule_t * icrule,cJSON * nodes_object,cJSON * start_branches)"}, {"_type": "tag", "name": "transcode_triggers", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "pattern": "/^static int transcode_triggers(const icrule_t* icrule, cJSON* nodes_object, cJSON* start_branches/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(const icrule_t * icrule,cJSON * nodes_object,cJSON * start_branches)"}], "hash": "9e1fa3758b24957e4b6df02a04754f2d", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "components/opensource/zilker-sdk/source/libs/cslt/src/sheens/sheens_transcoders.c", "fields": [{"name": "DeviceIdMapperFunc deviceIdMapper", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "const cslt_transcoder_t icrule2sheens_transcoder", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "const cslt_transcoder_t sheens2sheens_transcoder", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "cslt_factory_t sheens_factory", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"13983": ""}]}