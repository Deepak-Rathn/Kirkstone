{"is_source_file": true, "format": "C", "description": "This source file implements RSA signature verification utilities, including buffer dump, ASCII hex conversions, signature file processing, manifest file handling, hashing functions, and signature verification routines. It provides key functions for verifying digital signatures, processing manifest files, and managing required cryptographic operations within a larger project.", "external_files": ["rdm_rsa_signature_verify.h", "openssl/evp.h", "openssl/pem.h", "openssl/err.h", "openssl/conf.h"], "external_methods": ["PEM_read_PUBKEY", "ERR_load_crypto_strings", "OpenSSL_add_all_algorithms", "OPENSSL_config", "EVP_DigestInit_ex", "EVP_DigestUpdate", "EVP_DigestFinal_ex", "EVP_DigestVerifyInit", "EVP_DigestVerifyUpdate", "EVP_DigestVerifyFinal", "EVP_MD_CTX_create", "EVP_MD_CTX_destroy", "EVP_sha256", "PEM_read_PUBKEY"], "published": ["rdm_signature_verify", "init_ssl_lib", "rdm_openssl_rsa_file_signature_verify"], "classes": [], "methods": [{"name": "void dump_buffer(void * buffer,int buffer_size,char * name)", "description": "Outputs buffer contents to stdout and saves it as a binary file for debugging purposes.", "scope": "", "scopeKind": ""}, {"name": "int asciihex_to_bin(const char * asciihex,size_t asciihex_length,unsigned char * bin,size_t * bin_length)", "description": "Converts ASCII hex string to binary data.", "scope": "", "scopeKind": ""}, {"name": "int bin_to_asciihex(const unsigned char * bin,size_t bin_length,char * asciihex,size_t * asciihex_length)", "description": "Converts binary data into ASCII hex string.", "scope": "", "scopeKind": ""}, {"name": "int prepare_sig_file(char * sig_file)", "description": "Processes signature file, removing header bytes and moving to a temporary location.", "scope": "", "scopeKind": ""}, {"name": "int prepare_app_manifest(char * etc_manifest_file,char * cache_manifest_file,char * padding_file,char * prefix)", "description": "Reads a manifest file and prepends a prefix to each line, appending a padding file at the end.", "scope": "", "scopeKind": ""}, {"name": "int prepare_kms_pubkey()", "description": "Runs a system command to generate or prepare the public key used for verification.", "scope": "", "scopeKind": ""}, {"name": "int prepare_rdm_files_for_sign_verification(char * cache_dir,char * app_name)", "description": "Prepares necessary files (signature, manifest, padding, public key) for signature verification.", "scope": "", "scopeKind": ""}, {"name": "int rdm_signature_verify(char * cache_dir,char * app_name,int prepare_files)", "description": "Main routine to verify a signature for a package, possibly preparing files and invoking OpenSSL verification.", "scope": "", "scopeKind": ""}, {"name": "void init_ssl_lib(void)", "description": "Initializes OpenSSL cryptographic libraries and configurations.", "scope": "", "scopeKind": ""}, {"name": "int read_signature_file(const char * sig_file,unsigned char ** sig_buffer,int * sig_size)", "description": "Reads an ASCII hex signature file and converts it into binary form.", "scope": "", "scopeKind": ""}, {"name": "int manifest_file_size(const char * data_file,int * buffer_size)", "description": "Calculates the size of a manifest file.", "scope": "", "scopeKind": ""}, {"name": "int rdm_openssl_file_hash_sha256(const char * data_file,size_t file_len,unsigned char * hash_buffer,int * buffer_len)", "description": "Hashes a data file using SHA256, reading its entire contents.", "scope": "", "scopeKind": ""}, {"name": "int rdm_openssl_file_hash_sha256_pkg_components(const char * data_file,size_t file_len,unsigned char * hash_buffer,int * buffer_len)", "description": "Hashes package components listed in a manifest, handling nested files and directories.", "scope": "", "scopeKind": ""}, {"name": "int openssl_verify_signature(const unsigned char * hashval,int hashval_len,const char * sig_file,const char * vkey_file,char * reply_msg,int * reply_msg_len)", "description": "Verifies a SHA256 hash against a signature file using a public key.", "scope": "", "scopeKind": ""}, {"name": "int rdm_openssl_rsa_file_signature_verify(const char * data_file,size_t file_len,const char * sig_file,const char * vkey_file,char * reply_msg,int * reply_msg_len)", "description": "Performs RSA signature verification over a data file given signature and key files.", "scope": "", "scopeKind": ""}], "calls": ["localtime", "fprintf", "fopen", "fclose", "fwrite", "fseek", "ftell", "system", "snprintf", "strncpy", "strncat", "strtok", "memset", "malloc", "realloc", "free", "strcpy", "strcat", "getline", "ferror", "remove"], "search-terms": ["rdm_rsa_signature_verify", "signature file processing", "ASCII hex conversion", "RSA verification", "manifest processing", "public key verification", "file hashing", "signature verification routines"], "state": 2, "file_id": 12639, "knowledge_revision": 25543, "git_revision": "", "ctags": [{"_type": "tag", "name": "asciihex_to_bin", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^int asciihex_to_bin( const char *asciihex, size_t asciihex_length, unsigned char *bin, size_t *b/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(const char * asciihex,size_t asciihex_length,unsigned char * bin,size_t * bin_length)"}, {"_type": "tag", "name": "bin_to_asciihex", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^int bin_to_asciihex( const unsigned char *bin, size_t bin_length, char *asciihex, size_t *asciih/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(const unsigned char * bin,size_t bin_length,char * asciihex,size_t * asciihex_length)"}, {"_type": "tag", "name": "dump_buffer", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^void dump_buffer(void *buffer, int buffer_size, char *name)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void * buffer,int buffer_size,char * name)"}, {"_type": "tag", "name": "init_ssl_lib", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^void init_ssl_lib(void)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "manifest_file_size", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^int manifest_file_size(const char *data_file, int *buffer_size)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(const char * data_file,int * buffer_size)"}, {"_type": "tag", "name": "openssl_verify_signature", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^int openssl_verify_signature(const unsigned char *hashval, int hashval_len, const char *sig_file/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(const unsigned char * hashval,int hashval_len,const char * sig_file,const char * vkey_file,char * reply_msg,int * reply_msg_len)"}, {"_type": "tag", "name": "prepare_app_manifest", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^static int prepare_app_manifest(char *etc_manifest_file, char *cache_manifest_file, char* paddin/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * etc_manifest_file,char * cache_manifest_file,char * padding_file,char * prefix)"}, {"_type": "tag", "name": "prepare_kms_pubkey", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^static int prepare_kms_pubkey() {$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "prepare_rdm_files_for_sign_verification", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^static int prepare_rdm_files_for_sign_verification(char *cache_dir, char *app_name)$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * cache_dir,char * app_name)"}, {"_type": "tag", "name": "prepare_sig_file", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^static int prepare_sig_file(char *sig_file) {$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * sig_file)"}, {"_type": "tag", "name": "rdm_openssl_file_hash_sha256", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^int rdm_openssl_file_hash_sha256( const char *data_file, size_t file_len, unsigned char *hash_bu/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(const char * data_file,size_t file_len,unsigned char * hash_buffer,int * buffer_len)"}, {"_type": "tag", "name": "rdm_openssl_file_hash_sha256_pkg_components", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^int rdm_openssl_file_hash_sha256_pkg_components( const char *data_file, size_t file_len, unsigne/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(const char * data_file,size_t file_len,unsigned char * hash_buffer,int * buffer_len)"}, {"_type": "tag", "name": "rdm_openssl_rsa_file_signature_verify", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^ int rdm_openssl_rsa_file_signature_verify(const char *data_file, size_t file_len, const char *s/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(const char * data_file,size_t file_len,const char * sig_file,const char * vkey_file,char * reply_msg,int * reply_msg_len)"}, {"_type": "tag", "name": "rdm_signature_verify", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^int rdm_signature_verify(char *cache_dir, char *app_name, int prepare_files)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * cache_dir,char * app_name,int prepare_files)"}, {"_type": "tag", "name": "read_signature_file", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^int read_signature_file( const char *sig_file, unsigned char **sig_buffer, int *sig_size )$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(const char * sig_file,unsigned char ** sig_buffer,int * sig_size)"}, {"_type": "tag", "name": "timebuffer", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "pattern": "/^static time_t timebuffer;$/", "file": true, "language": "C", "typeref": "typename:time_t", "kind": "variable"}], "hash": "e53ef1bb9c192491ae95da7a98d446fd", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdk/components/generic/rdm/src/rdm_rsa_signature_verify.c", "fields": [{"name": "time_t timebuffer", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"25543": ""}]}