{"is_source_file": true, "format": "C", "description": "This file is a C source code implementing firewall log processing and iptables rule counting. It includes functions for parsing logs, handling rules, locking mechanisms, and main logic for gathering and managing firewall data.", "external_files": ["syscfg/syscfg.h", "sysevent/sysevent.h", "autoconf.h", "safec_lib_common.h", "secure_wrapper.h"], "external_methods": ["sysevent_open", "sysevent_get", "sysevent_close", "v_secure_system", "mkdir", "access", "unlink"], "published": ["main", "add_rule", "merger_rule", "get_rule_time", "clean_log"], "classes": [{"name": "rule_info", "description": "Struct representing information about a firewall rule including time, description, action, key, and count."}, {"name": "ipt_rule", "description": "Struct representing detailed iptables rule parameters like packet count, byte count, target, protocol, options, interfaces, source, destination, and others."}, {"name": "action_info", "description": "Struct mapping action names to functions that extract description and key from logs."}], "methods": [{"name": "int fLock()", "description": "Locks a file for exclusive writing using flock mechanism to prevent concurrent access.", "scope": "", "scopeKind": ""}, {"name": "void fUnlock(int fd)", "description": "Releases a previously acquired lock on a file descriptor.", "scope": "", "scopeKind": ""}, {"name": "int _get_key(char * line,char * key,char * prefix)", "description": "Extracts a key substring from a line based on a specified prefix.", "scope": "", "scopeKind": ""}, {"name": "int _memcpy_2_graph(char * d,char * s,size_t count)", "description": "Copies printable characters from source to destination until a non-graphical character is encountered.", "scope": "", "scopeKind": ""}, {"name": "int _memcpy_quotes(char * d,char * s,size_t count)", "description": "Copies a quoted string content between double quotes into destination.", "scope": "", "scopeKind": ""}, {"name": "int SiteBlocked_func(char * line,char * desp,char * key)", "description": "Parses a line to extract and identify site blocking related logs.", "scope": "", "scopeKind": ""}, {"name": "int DeviceBlocked_func(char * line,char * desp,char * key)", "description": "Parses a line to identify device blocking logs, including all devices if specified.", "scope": "", "scopeKind": ""}, {"name": "int FW_block_func(char * line,char * desp,char * key)", "description": "Processes firewall rule lines to extract prefix, description, and action details.", "scope": "", "scopeKind": ""}, {"name": "int ServiceBlocked_func(char * line,char * desp,char * key)", "description": "Parses service blocking lines to extract port information.", "scope": "", "scopeKind": ""}, {"name": "int anlz_rule(char * line,rule_info_t * info)", "description": "Analyzes a line to extract rule information such as count, description, action, and time.", "scope": "", "scopeKind": ""}, {"name": "void write_rule(FILE * fp,rule_info_t * info)", "description": "Writes rule data into a file in a formatted manner.", "scope": "", "scopeKind": ""}, {"name": "char * get_old(FILE * fp,char * name)", "description": "Finds and returns the oldest numbered log file name in a directory.", "scope": "", "scopeKind": ""}, {"name": "void add_rule(rule_info_t * rule,int * num,int flag)", "description": "Adds a new rule into the rule table, merging counts if similar rule exists.", "scope": "", "scopeKind": ""}, {"name": "void merger_rule(FILE * fd,int * num)", "description": "Merges rules from a log file into the internal rule table.", "scope": "", "scopeKind": ""}, {"name": "void get_rule_time(int count)", "description": "Retrieves timestamp information for rules by parsing kernel logs.", "scope": "", "scopeKind": ""}, {"name": "int _memcpy_2_chr(char * d,char * s,size_t count,char c)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char * _move_space(char * line)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void clean_log(void)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int get_count(char * line)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int main(int argc,char ** argv)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char * rev_getline_head(char * end,int len)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char * strstr_len(char * haystack,int count,char * needle)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["sysevent_open", "sysevent_get", "sysevent_close", "v_secure_system", "mkdir", "access", "unlink", "fseek", "fopen", "fgetc", "fclose", "fgets", "sscanf", "printf", "memcpy", "strstr", "strchr", "strcpy_s", "strftime", "strptime", "open", "close", "munmap", "getline", "remove", "sprintf_s", "system"], "search-terms": ["firewall_log", "GenFWLog", "iptables", "firewall", "rule_info", "syscfg", "sysevent", "iptables -L", "kernel log", "firewall count", "firewall rule parser", "lock file", "log cleanup", "firewall log directory"], "state": 2, "file_id": 7741, "knowledge_revision": 20806, "git_revision": "", "ctags": [{"_type": "tag", "name": "ACTION_SIZE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define ACTION_SIZE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ADRF_ACTION", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define ADRF_ACTION /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ADRF_DESP", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define ADRF_DESP /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ADRF_KEY", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define ADRF_KEY /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ADRF_NO_CHECK", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define ADRF_NO_CHECK /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ARF_GET_NEXT_COUNT", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define ARF_GET_NEXT_COUNT /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "CONFIG_CISCO_PARCON_WALLED_GARDEN", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^ #define CONFIG_CISCO_PARCON_WALLED_GARDEN$/", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "DESP_SIZE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define DESP_SIZE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "DeviceBlocked_func", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int DeviceBlocked_func(char *line, char *desp, char *key){$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * line,char * desp,char * key)"}, {"_type": "tag", "name": "FIREWALL_LOG_DIR", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^char FIREWALL_LOG_DIR[50];$/", "language": "C", "typeref": "typename:char[50]", "kind": "variable"}, {"_type": "tag", "name": "FW_ORG_LOG_NAME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define FW_ORG_LOG_NAME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "FW_block_func", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int FW_block_func(char *line, char *desp, char *key){$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * line,char * desp,char * key)"}, {"_type": "tag", "name": "IP6T_COUNT_CMD", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define IP6T_COUNT_CMD /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "IP6T_NAT_COUNT_CMD", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define IP6T_NAT_COUNT_CMD /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "IPT_COUNT_CMD", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define IPT_COUNT_CMD /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "IPT_NAT_COUNT_CMD", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define IPT_NAT_COUNT_CMD /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "KEY_SIZE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define KEY_SIZE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "LOCK_ATTEMP_TIME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define LOCK_ATTEMP_TIME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "LOCK_FILE_NAME", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define LOCK_FILE_NAME /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "LOG_FILE_COUNT_MAX", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define LOG_FILE_COUNT_MAX /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "LOG_TIME_SIZE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define LOG_TIME_SIZE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ORG_LOG_NAME_1", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define ORG_LOG_NAME_1 /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ORG_LOG_NAME_2", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define ORG_LOG_NAME_2 /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "RULE_NUM", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define RULE_NUM /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SHORT_LOG_PREFIX", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^const char SHORT_LOG_PREFIX[2][10] = {$/", "language": "C", "typeref": "typename:const char[2][10]", "kind": "variable"}, {"_type": "tag", "name": "STRING_DEVICE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define STRING_DEVICE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "STRING_DEVICE_BLOCKED", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define STRING_DEVICE_BLOCKED /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "STRING_DEVICE_BLOCKED_ALL", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define STRING_DEVICE_BLOCKED_ALL /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "STRING_KEYWORD", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define STRING_KEYWORD /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "STRING_SERVICE_BLOCKED", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define STRING_SERVICE_BLOCKED /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "STRING_SERVICE_PORT", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define STRING_SERVICE_PORT /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "STRING_SITE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define STRING_SITE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "STRING_SITE_BLOCKED", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define STRING_SITE_BLOCKED /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "STRING_URL", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define STRING_URL /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "ServiceBlocked_func", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int ServiceBlocked_func(char *line, char *desp, char *key){$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * line,char * desp,char * key)"}, {"_type": "tag", "name": "SiteBlocked_func", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int SiteBlocked_func(char *line, char *desp, char *key){$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * line,char * desp,char * key)"}, {"_type": "tag", "name": "TEMP_FILE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define TEMP_FILE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TEMP_LOG_LIST", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define TEMP_LOG_LIST /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "TIME_SIZE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define TIME_SIZE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "_ADRF_CHECK_", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define _ADRF_CHECK_(/", "file": true, "language": "C", "kind": "macro", "signature": "(flag,ADRF_value,cond)"}, {"_type": "tag", "name": "_XOPEN_SOURCE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define _XOPEN_SOURCE$/", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "_get_key", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int _get_key(char* line, char* key, char* prefix){$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * line,char * key,char * prefix)"}, {"_type": "tag", "name": "_memcpy_2_chr", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int _memcpy_2_chr(char *d, char *s, size_t count, char c){$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * d,char * s,size_t count,char c)"}, {"_type": "tag", "name": "_memcpy_2_graph", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int _memcpy_2_graph(char *d, char *s, size_t count){$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * d,char * s,size_t count)"}, {"_type": "tag", "name": "_memcpy_quotes", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int _memcpy_quotes(char *d, char *s, size_t count){$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * d,char * s,size_t count)"}, {"_type": "tag", "name": "_move_space", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^char* _move_space(char *line){$/", "language": "C", "typeref": "typename:char *", "kind": "function", "signature": "(char * line)"}, {"_type": "tag", "name": "action", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char action[ACTION_SIZE];$/", "file": true, "language": "C", "typeref": "typename:char[]", "kind": "member", "scope": "rule_info", "scopeKind": "struct"}, {"_type": "tag", "name": "action_arry", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^action_info_t action_arry[] = {$/", "language": "C", "typeref": "typename:action_info_t[]", "kind": "variable"}, {"_type": "tag", "name": "action_info", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^typedef struct action_info{$/", "file": true, "language": "C", "kind": "struct"}, {"_type": "tag", "name": "action_info_t", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^}action_info_t;$/", "file": true, "language": "C", "typeref": "struct:action_info", "kind": "typedef"}, {"_type": "tag", "name": "action_name", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char action_name[25];$/", "file": true, "language": "C", "typeref": "typename:char[25]", "kind": "member", "scope": "action_info", "scopeKind": "struct"}, {"_type": "tag", "name": "add_rule", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^void add_rule(rule_info_t *rule, int *num, int flag){$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(rule_info_t * rule,int * num,int flag)"}, {"_type": "tag", "name": "anlz_rule", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int anlz_rule(char* line, rule_info_t *info){$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * line,rule_info_t * info)"}, {"_type": "tag", "name": "byte", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    int byte;$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "member", "scope": "ipt_rule", "scopeKind": "struct"}, {"_type": "tag", "name": "clean_log", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define clean_log(/", "file": true, "language": "C", "kind": "macro", "signature": "()"}, {"_type": "tag", "name": "clean_log", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^void clean_log(void){$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "count", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    int count;$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "member", "scope": "rule_info", "scopeKind": "struct"}, {"_type": "tag", "name": "desp", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char desp[DESP_SIZE];$/", "file": true, "language": "C", "typeref": "typename:char[]", "kind": "member", "scope": "rule_info", "scopeKind": "struct"}, {"_type": "tag", "name": "dest", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char dest[50];$/", "file": true, "language": "C", "typeref": "typename:char[50]", "kind": "member", "scope": "ipt_rule", "scopeKind": "struct"}, {"_type": "tag", "name": "fLock", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int fLock(){$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "fUnlock", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^void fUnlock(int fd){$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(int fd)"}, {"_type": "tag", "name": "g_p_rule_tbl", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^rule_info_t *g_p_rule_tbl = NULL;$/", "language": "C", "typeref": "typename:rule_info_t *", "kind": "variable"}, {"_type": "tag", "name": "g_ptime", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^struct tm *g_ptime;$/", "language": "C", "typeref": "struct:tm *", "kind": "variable"}, {"_type": "tag", "name": "g_rule_tlb_len", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int g_rule_tlb_len = 0;$/", "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "get_count", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int get_count(char* line){$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * line)"}, {"_type": "tag", "name": "get_desp", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    int (*get_desp)(char* line, char* desp, char *key);$/", "file": true, "language": "C", "typeref": "typename:int (*)(char * line,char * desp,char * key)", "kind": "member", "scope": "action_info", "scopeKind": "struct"}, {"_type": "tag", "name": "get_old", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^char* get_old(FILE *fp, char* name){$/", "language": "C", "typeref": "typename:char *", "kind": "function", "signature": "(FILE * fp,char * name)"}, {"_type": "tag", "name": "get_rule_time", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^void get_rule_time(int count){$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(int count)"}, {"_type": "tag", "name": "in", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char in[50];$/", "file": true, "language": "C", "typeref": "typename:char[50]", "kind": "member", "scope": "ipt_rule", "scopeKind": "struct"}, {"_type": "tag", "name": "ipt_rule", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^typedef struct ipt_rule{$/", "file": true, "language": "C", "kind": "struct"}, {"_type": "tag", "name": "ipt_rule_t", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^}ipt_rule_t;$/", "file": true, "language": "C", "typeref": "struct:ipt_rule", "kind": "typedef"}, {"_type": "tag", "name": "key", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char key[KEY_SIZE];$/", "file": true, "language": "C", "typeref": "typename:char[]", "kind": "member", "scope": "rule_info", "scopeKind": "struct"}, {"_type": "tag", "name": "main", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^int main(int argc, char** argv){$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int argc,char ** argv)"}, {"_type": "tag", "name": "merger_rule", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^void merger_rule(FILE* fd, int *num){$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(FILE * fd,int * num)"}, {"_type": "tag", "name": "opt", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char opt[50];$/", "file": true, "language": "C", "typeref": "typename:char[50]", "kind": "member", "scope": "ipt_rule", "scopeKind": "struct"}, {"_type": "tag", "name": "others", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char others[50];$/", "file": true, "language": "C", "typeref": "typename:char[50]", "kind": "member", "scope": "ipt_rule", "scopeKind": "struct"}, {"_type": "tag", "name": "out", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char out[50];$/", "file": true, "language": "C", "typeref": "typename:char[50]", "kind": "member", "scope": "ipt_rule", "scopeKind": "struct"}, {"_type": "tag", "name": "pkt", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    int pkt;$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "member", "scope": "ipt_rule", "scopeKind": "struct"}, {"_type": "tag", "name": "printf", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^#define printf(/", "file": true, "language": "C", "kind": "macro", "signature": "(x,argv...)"}, {"_type": "tag", "name": "prot", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char prot[10];$/", "file": true, "language": "C", "typeref": "typename:char[10]", "kind": "member", "scope": "ipt_rule", "scopeKind": "struct"}, {"_type": "tag", "name": "rev_getline_head", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^char* rev_getline_head(char* end, int len)$/", "language": "C", "typeref": "typename:char *", "kind": "function", "signature": "(char * end,int len)"}, {"_type": "tag", "name": "rule_info", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^typedef struct rule_info {$/", "file": true, "language": "C", "kind": "struct"}, {"_type": "tag", "name": "rule_info_t", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^}rule_info_t; $/", "file": true, "language": "C", "typeref": "struct:rule_info", "kind": "typedef"}, {"_type": "tag", "name": "src", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char src[50];$/", "file": true, "language": "C", "typeref": "typename:char[50]", "kind": "member", "scope": "ipt_rule", "scopeKind": "struct"}, {"_type": "tag", "name": "strstr_len", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^char* strstr_len(char *haystack, int count, char *needle){$/", "language": "C", "typeref": "typename:char *", "kind": "function", "signature": "(char * haystack,int count,char * needle)"}, {"_type": "tag", "name": "t", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^time_t t;$/", "language": "C", "typeref": "typename:time_t", "kind": "variable"}, {"_type": "tag", "name": "target", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char target[ACTION_SIZE];$/", "file": true, "language": "C", "typeref": "typename:char[]", "kind": "member", "scope": "ipt_rule", "scopeKind": "struct"}, {"_type": "tag", "name": "time", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^    char time[TIME_SIZE];$/", "file": true, "language": "C", "typeref": "typename:char[]", "kind": "member", "scope": "rule_info", "scopeKind": "struct"}, {"_type": "tag", "name": "write_rule", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "pattern": "/^void write_rule(FILE *fp, rule_info_t *info){$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(FILE * fp,rule_info_t * info)"}], "hash": "bc4dc4762bd97e8da9689f04f69a5971", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/Utopia/source/firewall_log/GenFWLog.c", "fields": [{"name": "char[50] FIREWALL_LOG_DIR", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "const char[2][10] SHORT_LOG_PREFIX", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char[] action", "scope": "rule_info", "scopeKind": "struct", "description": "unavailable"}, {"name": "action_info_t[] action_arry", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char[25] action_name", "scope": "action_info", "scopeKind": "struct", "description": "unavailable"}, {"name": "int byte", "scope": "ipt_rule", "scopeKind": "struct", "description": "unavailable"}, {"name": "int count", "scope": "rule_info", "scopeKind": "struct", "description": "unavailable"}, {"name": "char[] desp", "scope": "rule_info", "scopeKind": "struct", "description": "unavailable"}, {"name": "char[50] dest", "scope": "ipt_rule", "scopeKind": "struct", "description": "unavailable"}, {"name": "rule_info_t * g_p_rule_tbl", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "struct:tm * g_ptime", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int g_rule_tlb_len", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int (*)(char * line,char * desp,char * key) get_desp", "scope": "action_info", "scopeKind": "struct", "description": "unavailable"}, {"name": "char[50] in", "scope": "ipt_rule", "scopeKind": "struct", "description": "unavailable"}, {"name": "char[] key", "scope": "rule_info", "scopeKind": "struct", "description": "unavailable"}, {"name": "char[50] opt", "scope": "ipt_rule", "scopeKind": "struct", "description": "unavailable"}, {"name": "char[50] others", "scope": "ipt_rule", "scopeKind": "struct", "description": "unavailable"}, {"name": "char[50] out", "scope": "ipt_rule", "scopeKind": "struct", "description": "unavailable"}, {"name": "int pkt", "scope": "ipt_rule", "scopeKind": "struct", "description": "unavailable"}, {"name": "char[10] prot", "scope": "ipt_rule", "scopeKind": "struct", "description": "unavailable"}, {"name": "char[50] src", "scope": "ipt_rule", "scopeKind": "struct", "description": "unavailable"}, {"name": "time_t t", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char[] target", "scope": "ipt_rule", "scopeKind": "struct", "description": "unavailable"}, {"name": "char[] time", "scope": "rule_info", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"20806": ""}]}