{"is_source_file": true, "format": "C", "description": "This file implements advanced operation functions for a traceroute-based diagnostic tool within a broadband management system, including functions to start, stop, resolve hosts, handle ICMP packets, and process traceroute results.", "external_files": ["bbhm_diagit_global.h", "safec_lib_common.h"], "external_methods": ["AnscCreateXsocket", "AnscStartupXsocketWrapper", "AnscGetTickInMilliSeconds", "_xskt_setsocketopt", "_xskt_getnameinfo", "_ansc_gethostbyname", "_ansc_inet_addr", "_ansc_gethostbyaddr", "AnscTrace", "AnscSleep", "AnscAllocateMemory", "AnscFreeMemory", "AnscSListPushEntry", "AnscSListPopEntry", "AnscSListGetFirstEntry", "AnscSListGetNextEntry", "AnscAcquireLock", "AnscReleaseLock", "ACCESS_BBHM_TRACERT_ECHO_ENTRY", "ACCESS_BBHM_TRACERT_ECHO_ENTRY", "BbhmDiagitSinkCreate"], "published": ["BbhmDiagitStart", "BbhmDiagitOpen", "BbhmDiagitStop", "BbhmDiagitClose", "BbhmDiagitResolveHost", "BbhmDiagitResolveHostName", "BbhmDiagitExpire1", "BbhmDiagitExpire2", "BbhmDiagitSetStopTime", "BbhmDiagitAddEchoEntry", "BbhmDiagitCalculateResult", "BbhmDiagitUpdateEntry"], "classes": [{"name": "BBHM_DIAG_IP_TRACEROUTE_OBJECT", "description": "Main object for managing traceroute diagnostics, including state, configuration, and callback functions."}, {"name": "BBHM_TRACERT_PROPERTY", "description": "Properties/configuration for traceroute operation such as packet size, timeouts, and counters."}, {"name": "BBHM_TRACERT_TDO_OBJECT", "description": "Timer object used for controlling intervals and timeouts in traceroute operations."}, {"name": "BBHM_TRACERT_SINK_OBJECT", "description": "Sink object for handling sending/receiving ICMP packets and related socket operations."}, {"name": "BBHM_TRACERT_ECHO_ENTRY", "description": "Structure representing each ICMP echo request/reply entry, tracking sequence ID, start/stop times, and error codes."}], "methods": [{"name": "ANSC_STATUS BbhmDiagitStart(ANSC_HANDLE hThisObject)", "description": "Starts the traceroute operation by sending initial packets and configuring sockets.", "scope": "", "scopeKind": ""}, {"name": "ANSC_STATUS BbhmDiagitSendEcho(ANSC_HANDLE hThisObject)", "description": "Sends an ICMP echo request packet, setting appropriate headers and options.", "scope": "", "scopeKind": ""}, {"name": "ANSC_STATUS BbhmDiagitOpen(ANSC_HANDLE hThisObject)", "description": "Opens socket and sink objects, initializing the traceroute session.", "scope": "", "scopeKind": ""}, {"name": "ANSC_STATUS BbhmDiagitStop(ANSC_HANDLE hThisObject)", "description": "Stops the traceroute operation, calculating results and closing sockets.", "scope": "", "scopeKind": ""}, {"name": "ULONG BbhmDiagitResolveHost(ANSC_HANDLE hThisObject,ANSC_HANDLE hHostName)", "description": "Resolves hostname to IP address, either via DNS or direct address.", "scope": "", "scopeKind": ""}, {"name": "PUCHAR BbhmDiagitResolveHostName(ANSC_HANDLE hThisObject,ULONG IpAddr)", "description": "Resolves IP address back to hostname.", "scope": "", "scopeKind": ""}, {"name": "ANSC_STATUS BbhmDiagitExpire1(ANSC_HANDLE hThisObject)", "description": "Triggers sending the next ICMP echo request.", "scope": "", "scopeKind": ""}, {"name": "ANSC_STATUS BbhmDiagitExpire2(ANSC_HANDLE hThisObject)", "description": "Handles timeout expiration, resets hop count.", "scope": "", "scopeKind": ""}, {"name": "ANSC_STATUS BbhmDiagitClose(ANSC_HANDLE hThisObject)", "description": "Closes socket and sink, cleans up resources.", "scope": "", "scopeKind": ""}, {"name": "ANSC_STATUS BbhmDiagitSetStopTime(ANSC_HANDLE hThisObject,USHORT SeqNumber,ULONG StopTime)", "description": "Records the stop time for a given ICMP sequence.", "scope": "", "scopeKind": ""}, {"name": "ANSC_STATUS BbhmDiagitAddEchoEntry(ANSC_HANDLE hThisObject,USHORT SeqNumber,ULONG StartTime,ULONG TimeToLive)", "description": "Adds a new echo request entry to the internal table for tracking.", "scope": "", "scopeKind": ""}, {"name": "ANSC_STATUS BbhmDiagitCalculateResult(ANSC_HANDLE hThisObject)", "description": "Calculates the traceroute results after operation completion, including hop timings and errors.", "scope": "", "scopeKind": ""}, {"name": "ANSC_STATUS BbhmDiagitUpdateEntry(ANSC_HANDLE hThisObject,ULONG SeqId,xskt_addrinfo * pHopAddrInfo,ULONG StopTime,ULONG ErrorCode)", "description": "Updates an existing echo entry with reply information, including host info and times.", "scope": "", "scopeKind": ""}], "calls": ["AnscCreateXsocket", "AnscStartupXsocketWrapper", "AnscGetTickInMilliSeconds", "_xskt_setsocketopt", "_xskt_getnameinfo", "_ansc_gethostbyname", "_ansc_inet_addr", "_ansc_gethostbyaddr", "AnscTrace", "AnscSleep", "AnscAllocateMemory", "AnscFreeMemory", "AnscSListPushEntry", "AnscSListPopEntry", "AnscSListGetFirstEntry", "AnscSListGetNextEntry", "AnscAcquireLock", "AnscReleaseLock", "ACCESS_BBHM_TRACERT_ECHO_ENTRY", "BbhmDiagitSinkCreate"], "search-terms": ["BbhmDiagitStart", "ICMPV4_ECHO_MESSAGE", "ICMPV6_ECHO_MESSAGE", "ResolveAddr", "SetPeerName", "CalculateResult", "EchoTable", "TTL", "Traceroute", "ICMP ECHO REQUEST"], "state": 2, "file_id": 8974, "knowledge_revision": 22005, "git_revision": "", "ctags": [{"_type": "tag", "name": "BbhmDiagitAddEchoEntry", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitAddEchoEntry$/", "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(ANSC_HANDLE hThisObject,USHORT SeqNumber,ULONG StartTime,ULONG TimeToLive)"}, {"_type": "tag", "name": "BbhmDiagitCalculateResult", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitCalculateResult$/", "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(ANSC_HANDLE hThisObject)"}, {"_type": "tag", "name": "BbhmDiagitClose", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitClose$/", "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(ANSC_HANDLE hThisObject)"}, {"_type": "tag", "name": "BbhmDiagitExpire1", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitExpire1$/", "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(ANSC_HANDLE hThisObject)"}, {"_type": "tag", "name": "BbhmDiagitExpire2", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitExpire2$/", "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(ANSC_HANDLE hThisObject)"}, {"_type": "tag", "name": "BbhmDiagitOpen", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitOpen$/", "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(ANSC_HANDLE hThisObject)"}, {"_type": "tag", "name": "BbhmDiagitResolveHost", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitResolveHost$/", "language": "C", "typeref": "typename:ULONG", "kind": "function", "signature": "(ANSC_HANDLE hThisObject,ANSC_HANDLE hHostName)"}, {"_type": "tag", "name": "BbhmDiagitResolveHostName", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitResolveHostName$/", "language": "C", "typeref": "typename:PUCHAR", "kind": "function", "signature": "(ANSC_HANDLE hThisObject,ULONG IpAddr)"}, {"_type": "tag", "name": "BbhmDiagitSendEcho", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitSendEcho$/", "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(ANSC_HANDLE hThisObject)"}, {"_type": "tag", "name": "BbhmDiagitSetStopTime", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitSetStopTime$/", "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(ANSC_HANDLE hThisObject,USHORT SeqNumber,ULONG StopTime)"}, {"_type": "tag", "name": "BbhmDiagitStart", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitStart$/", "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(ANSC_HANDLE hThisObject)"}, {"_type": "tag", "name": "BbhmDiagitStop", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitStop$/", "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(ANSC_HANDLE hThisObject)"}, {"_type": "tag", "name": "BbhmDiagitUpdateEntry", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "pattern": "/^BbhmDiagitUpdateEntry$/", "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(ANSC_HANDLE hThisObject,ULONG SeqId,xskt_addrinfo * pHopAddrInfo,ULONG StopTime,ULONG ErrorCode)"}], "hash": "429311ad581dcc1205e3a532999f3c7c", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/TestAndDiagnostic/source/diagnostic/BbhmDiagIpTraceroute/bbhm_diagit_operation.c", "revision_history": [{"22005": ""}]}