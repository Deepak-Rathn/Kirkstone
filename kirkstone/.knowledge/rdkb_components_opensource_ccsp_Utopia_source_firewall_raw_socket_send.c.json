{"is_source_file": true, "format": "C", "description": "This file is a C source code for sending custom-crafted TCP packets over raw sockets, specifically involving Ethernet, IP, and TCP headers, with payload construction for HTTP redirection. It includes functions for creating headers, computing checksums, and transmitting packets on network interfaces.", "external_files": ["/usr/include/stdio.h", "/usr/include/stdlib.h", "/sys/socket.h", "/features.h", "/linux/if_packet.h", "/netinet/if_ether.h", "/linux/if_ether.h", "/errno.h", "/sys/ioctl.h", "/net/if.h", "/netinet/ip.h", "/netinet/ip6.h", "/linux/tcp.h", "/arpa/inet.h", "/string.h", "/sys/time.h", "/unistd.h", "/netinet/ether.h", "/netinet/in.h", "/sys/types.h", "/ifaddrs.h"], "external_methods": ["socket", "write", "inet_addr", "htons", "malloc", "memcpy", "free", "inet_pton", "getifaddrs", "freeifaddrs", "htop", "bzero", "ioctl", "bind", "perror", "exit", "inet_ntop", "getnetbyname"], "published": [], "classes": [], "methods": [{"name": "unsigned short tcp_checksum(unsigned short * buffer,int byte_count)", "description": "Calculates the checksum for TCP headers and data, used in checksum verification.", "scope": "", "scopeKind": ""}, {"name": "int SendRawPacket(int rawsock,unsigned char * pkt,int pkt_len,char * dstIp,unsigned short dstPort)", "description": "Sends raw packet data over a socket to a specified destination IP and port.", "scope": "", "scopeKind": ""}, {"name": "struct:ethhdr * CreateEthernetHeader(char * src_mac,char * dst_mac,int protocol)", "description": "Constructs an Ethernet frame header with source and destination MAC addresses and protocol type.", "scope": "", "scopeKind": ""}, {"name": "unsigned short ComputeChecksum(void * data,unsigned long length)", "description": "Computes a generic checksum over a block of data, used for IP header checksum.", "scope": "", "scopeKind": ""}, {"name": "void * CreateIPHeader(int family,char * srcIp,char * dstIp,unsigned int dataSize)", "description": "Creates an IPv4 or IPv6 header depending on the family parameter.", "scope": "", "scopeKind": ""}, {"name": "struct:tcphdr * CreateTcpHeader(int family,unsigned short sport,unsigned short dport,unsigned long seqNum,unsigned long ackNum,unsigned char fin)", "description": "Constructs a TCP header with specified source/destination ports, sequence numbers, and flags.", "scope": "", "scopeKind": ""}, {"name": "void CreatePseudoHeaderAndComputeTcpChecksum(int family,struct tcphdr * tcp_header,void * ip_header,unsigned char * data,unsigned int dataSize)", "description": "Builds pseudo-headers for TCP checksum calculation for both IPv4 and IPv6.", "scope": "", "scopeKind": ""}, {"name": "unsigned char * CreateData(int family,char * url,char * gwIp)", "description": "Generates the payload data with HTTP redirection content, incorporating IP addresses and URL.", "scope": "", "scopeKind": ""}, {"name": "void send_tcp_pkt(char * interface,int family,char * srcMac,char * dstMac,char * srcIp,char * dstIp,unsigned short srcPort,unsigned short dstPort,unsigned long seqNum,unsigned long ackNum,char * url,unsigned char rst)", "description": "Main function that assembles Ethernet, IP, TCP headers and payload, then transmits a raw TCP packet on a specified network interface.", "scope": "", "scopeKind": ""}], "calls": ["socket", "write", "inet_addr", "htons", "malloc", "memcpy", "free", "inet_pton", "getifaddrs", "freeifaddrs", "bzero", "ioctl", "bind", "perror", "exit", "inet_ntop"], "search-terms": ["raw_socket_send", "firewall", "HTTP redirect payload", "pseudo header", "TCP checksum", "Ethernet header", "IPv6 header", "IPv4 header", "create TCP packet", "send_raw_tcp"], "state": 2, "file_id": 7449, "knowledge_revision": 20517, "git_revision": "", "ctags": [{"_type": "tag", "name": "ComputeChecksum", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^static unsigned short ComputeChecksum (void *data, unsigned long length)$/", "file": true, "language": "C", "typeref": "typename:unsigned short", "kind": "function", "signature": "(void * data,unsigned long length)"}, {"_type": "tag", "name": "CreateData", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^static unsigned char *CreateData (int family, char *url, char *gwIp)$/", "file": true, "language": "C", "typeref": "typename:unsigned char *", "kind": "function", "signature": "(int family,char * url,char * gwIp)"}, {"_type": "tag", "name": "CreateEthernetHeader", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^static struct ethhdr *CreateEthernetHeader (char *src_mac, char *dst_mac, int protocol)$/", "file": true, "language": "C", "typeref": "struct:ethhdr *", "kind": "function", "signature": "(char * src_mac,char * dst_mac,int protocol)"}, {"_type": "tag", "name": "CreateIPHeader", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^static void *CreateIPHeader (int family, char *srcIp, char *dstIp, unsigned int dataSize)$/", "file": true, "language": "C", "typeref": "typename:void *", "kind": "function", "signature": "(int family,char * srcIp,char * dstIp,unsigned int dataSize)"}, {"_type": "tag", "name": "CreatePseudoHeaderAndComputeTcpChecksum", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^static void CreatePseudoHeaderAndComputeTcpChecksum (int family, struct tcphdr *tcp_header, void/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(int family,struct tcphdr * tcp_header,void * ip_header,unsigned char * data,unsigned int dataSize)"}, {"_type": "tag", "name": "CreateTcpHeader", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^static struct tcphdr *CreateTcpHeader(int family, unsigned short sport, unsigned short dport, un/", "file": true, "language": "C", "typeref": "struct:tcphdr *", "kind": "function", "signature": "(int family,unsigned short sport,unsigned short dport,unsigned long seqNum,unsigned long ackNum,unsigned char fin)"}, {"_type": "tag", "name": "HDRLEN", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^#define HDRLEN /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "MAX_IPLEN", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^#define MAX_IPLEN /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "PseudoHeader", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^typedef struct PseudoHeader {$/", "file": true, "language": "C", "kind": "struct"}, {"_type": "tag", "name": "PseudoHeader", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^} PseudoHeader;$/", "file": true, "language": "C", "typeref": "struct:PseudoHeader", "kind": "typedef"}, {"_type": "tag", "name": "PseudoHeaderv6", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^typedef struct PseudoHeaderv6 {$/", "file": true, "language": "C", "kind": "struct"}, {"_type": "tag", "name": "PseudoHeaderv6", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^} PseudoHeaderv6;$/", "file": true, "language": "C", "typeref": "struct:PseudoHeaderv6", "kind": "typedef"}, {"_type": "tag", "name": "SendRawPacket", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^static int SendRawPacket (int rawsock, unsigned char *pkt, int pkt_len, char *dstIp, unsigned sh/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(int rawsock,unsigned char * pkt,int pkt_len,char * dstIp,unsigned short dstPort)"}, {"_type": "tag", "name": "dest_ip", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^    u_int32_t dest_ip;$/", "file": true, "language": "C", "typeref": "typename:u_int32_t", "kind": "member", "scope": "PseudoHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "dest_ipv6", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^    u_int8_t dest_ipv6[16];$/", "file": true, "language": "C", "typeref": "typename:u_int8_t[16]", "kind": "member", "scope": "PseudoHeaderv6", "scopeKind": "struct"}, {"_type": "tag", "name": "http_redirect_payload", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^static unsigned char http_redirect_payload[HDRLEN+MAX_IPLEN + 2 +sizeof(http_redirect_payload2)+/", "file": true, "language": "C", "typeref": "typename:unsigned char[]", "kind": "variable"}, {"_type": "tag", "name": "http_redirect_payload2", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^static const unsigned char http_redirect_payload2[] = { \\\\$/", "file": true, "language": "C", "typeref": "typename:const unsigned char[]", "kind": "variable"}, {"_type": "tag", "name": "http_redirect_payload_bottom", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^static const unsigned char http_redirect_payload_bottom[] = { \\\\$/", "file": true, "language": "C", "typeref": "typename:const unsigned char[]", "kind": "variable"}, {"_type": "tag", "name": "next_hdr", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^    u_int8_t next_hdr;$/", "file": true, "language": "C", "typeref": "typename:u_int8_t", "kind": "member", "scope": "PseudoHeaderv6", "scopeKind": "struct"}, {"_type": "tag", "name": "protocol", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^    u_int8_t protocol;$/", "file": true, "language": "C", "typeref": "typename:u_int8_t", "kind": "member", "scope": "PseudoHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "reserved", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^    u_int8_t reserved;$/", "file": true, "language": "C", "typeref": "typename:u_int8_t", "kind": "member", "scope": "PseudoHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "reserved", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^    u_int8_t reserved[3];$/", "file": true, "language": "C", "typeref": "typename:u_int8_t[3]", "kind": "member", "scope": "PseudoHeaderv6", "scopeKind": "struct"}, {"_type": "tag", "name": "send_tcp_pkt", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^void send_tcp_pkt (char *interface, int family, char *srcMac, char *dstMac, char *srcIp, char *d/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(char * interface,int family,char * srcMac,char * dstMac,char * srcIp,char * dstIp,unsigned short srcPort,unsigned short dstPort,unsigned long seqNum,unsigned long ackNum,char * url,unsigned char rst)"}, {"_type": "tag", "name": "source_ip", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^    u_int32_t source_ip;$/", "file": true, "language": "C", "typeref": "typename:u_int32_t", "kind": "member", "scope": "PseudoHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "source_ipv6", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^    u_int8_t source_ipv6[16];$/", "file": true, "language": "C", "typeref": "typename:u_int8_t[16]", "kind": "member", "scope": "PseudoHeaderv6", "scopeKind": "struct"}, {"_type": "tag", "name": "tcp_checksum", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^static unsigned short tcp_checksum (unsigned short *buffer, int byte_count)$/", "file": true, "language": "C", "typeref": "typename:unsigned short", "kind": "function", "signature": "(unsigned short * buffer,int byte_count)"}, {"_type": "tag", "name": "tcp_length", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^    u_int16_t tcp_length;$/", "file": true, "language": "C", "typeref": "typename:u_int16_t", "kind": "member", "scope": "PseudoHeader", "scopeKind": "struct"}, {"_type": "tag", "name": "up_len", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "pattern": "/^    u_int32_t up_len;$/", "file": true, "language": "C", "typeref": "typename:u_int32_t", "kind": "member", "scope": "PseudoHeaderv6", "scopeKind": "struct"}], "hash": "452d919af91243b7a3f5f0f4e85112c5", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/Utopia/source/firewall/raw_socket_send.c", "fields": [{"name": "u_int32_t dest_ip", "scope": "PseudoHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "u_int8_t[16] dest_ipv6", "scope": "PseudoHeaderv6", "scopeKind": "struct", "description": "unavailable"}, {"name": "unsigned char[] http_redirect_payload", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "const unsigned char[] http_redirect_payload2", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "const unsigned char[] http_redirect_payload_bottom", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "u_int8_t next_hdr", "scope": "PseudoHeaderv6", "scopeKind": "struct", "description": "unavailable"}, {"name": "u_int8_t protocol", "scope": "PseudoHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "u_int8_t reserved", "scope": "PseudoHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "u_int8_t[3] reserved", "scope": "PseudoHeaderv6", "scopeKind": "struct", "description": "unavailable"}, {"name": "u_int32_t source_ip", "scope": "PseudoHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "u_int8_t[16] source_ipv6", "scope": "PseudoHeaderv6", "scopeKind": "struct", "description": "unavailable"}, {"name": "u_int16_t tcp_length", "scope": "PseudoHeader", "scopeKind": "struct", "description": "unavailable"}, {"name": "u_int32_t up_len", "scope": "PseudoHeaderv6", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"20517": ""}]}