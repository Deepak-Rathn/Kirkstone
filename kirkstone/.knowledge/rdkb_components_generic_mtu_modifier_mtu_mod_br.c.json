{"is_source_file": true, "format": "C", "description": "This source file implements network filtering and MTU modification functionality within a Linux kernel module, including handling ICMP 'Packet Too Big' messages and fragmenting IP packets based on MTU settings.", "external_files": ["<linux/kernel.h>", "<linux/module.h>", "<linux/list.h>", "<linux/spinlock.h>", "<linux/skbuff.h>", "<linux/ip.h>", "<linux/netdevice.h>", "<linux/netfilter.h>", "<linux/netfilter_ipv4.h>", "<linux/netfilter_bridge.h>", "<linux/version.h>", "<net/ip.h>", "<net/dst.h>"], "external_methods": ["ip_fast_csum", "ip_compute_csum"], "published": ["mtu_mod_node_init", "mtu_mod_node_deinit", "mtu_mod_get_setting", "mtu_mod_create_node", "mtu_mod_remove_node", "mtu_mod_update_node", "mtu_mod_show_node"], "classes": [], "methods": [{"name": "void mtu_mod_lock(void)", "description": "Acquires a spin lock to protect MTU modification data structures.", "scope": "", "scopeKind": ""}, {"name": "void mtu_mod_unlock(void)", "description": "Releases the spin lock used for MTU modification data structures.", "scope": "", "scopeKind": ""}, {"name": "void mtu_mod_node_init(void)", "description": "Initializes the MTU modification module, registering necessary hooks.", "scope": "", "scopeKind": ""}, {"name": "void mtu_mod_node_deinit(void)", "description": "Deinitializes the MTU modification module, unregistering hooks and cleaning up nodes.", "scope": "", "scopeKind": ""}, {"name": "mtu_mod_node_t * mtu_mod_search_node(char * pBrName)", "description": "Searches for a MTU modification node by bridge name.", "scope": "", "scopeKind": ""}, {"name": "int mtu_mod_get_setting(char * pBrName,int * pSegFlag,int * pIcmpFlag,unsigned char * pMtu,unsigned char * pGw)", "description": "Retrieves current MTU, segmentation, and ICMP flags for a given bridge.", "scope": "", "scopeKind": ""}, {"name": "void mtu_mod_create_node(char * pBrName,char segmentFlag,char icmpFlag,int mtu,unsigned int gwIp)", "description": "Creates or updates a MTU modification node for a specified bridge.", "scope": "", "scopeKind": ""}, {"name": "void mtu_mod_remove_node(char * pBrName)", "description": "Removes a MTU modification node for a specified bridge.", "scope": "", "scopeKind": ""}, {"name": "void mtu_mod_update_node(char * pBrName,char segmentFlag,char icmpFlag,int mtu,unsigned int gwIp)", "description": "Updates MTU and related settings for a bridge.", "scope": "", "scopeKind": ""}, {"name": "void mtu_mod_show_node(char * pBrName)", "description": "Displays information about a specific MTU node.", "scope": "", "scopeKind": ""}, {"name": "void mtu_mod_send_icmp_too_big_frame(const struct net_device * pInDev,struct sk_buff * pSkb,unsigned char mtu[2],unsigned char gw[4])", "description": "Constructs and sends an ICMP 'Packet Too Big' message in response to oversized packets.", "scope": "", "scopeKind": ""}, {"name": "void ip_copy_metadata(struct sk_buff * to,struct sk_buff * from)", "description": "Copies metadata from one sk_buff to another.", "scope": "", "scopeKind": ""}, {"name": "void br_ip_fragment(struct sk_buff * skb,const struct net_device * indev,const struct net_device * outdev,int mtu,int (* output)(struct sk_buff *))", "description": "Fragments IP packets exceeding the MTU and sends fragments.", "scope": "", "scopeKind": ""}, {"name": "unsigned int mtu_mod_hook(unsigned int hook,struct sk_buff * skb,const struct net_device * indev,const struct net_device * outdev,int (* kfn)(struct sk_buff *))", "description": "Netfilter hook function that intercepts IP packets to apply MTU modifications and fragmentation.", "scope": "", "scopeKind": ""}, {"name": "void mtu_mod_flush_nodes(void)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["ip_fast_csum", "ip_compute_csum", "dev_queue_xmit", "eth_hdr", "skb_reserve", "skb_reset_mac_header", "alloc_skb", "skb_put", "skb_reset_network_header", "skb_copy_from_linear_data", "skb_copy_bits", "ip_send_check", "dev_queue_xmit", "nf_register_net_hook", "nf_unregister_net_hook"], "search-terms": ["mtu_mod", "netfilter", "icmp_too_big", "ip_fragmentation", "bridge", "netfilter_hooks", "MTU", "IP fragmentation", "ICMP Packet Too Big", "Linux kernel module"], "state": 2, "file_id": 5756, "knowledge_revision": 18879, "git_revision": "", "ctags": [{"_type": "tag", "name": "MTU_MOD_IF_NAME_SIZE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^#define MTU_MOD_IF_NAME_SIZE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "__anone05e87b90108", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^typedef struct{$/", "file": true, "language": "C", "kind": "struct"}, {"_type": "tag", "name": "brName", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^    char brName[MTU_MOD_IF_NAME_SIZE];$/", "file": true, "language": "C", "typeref": "typename:char[]", "kind": "member", "scope": "__anone05e87b90108", "scopeKind": "struct"}, {"_type": "tag", "name": "br_ip_fragment", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^br_ip_fragment(struct sk_buff *skb,$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(struct sk_buff * skb,const struct net_device * indev,const struct net_device * outdev,int mtu,int (* output)(struct sk_buff *))"}, {"_type": "tag", "name": "gMtuModBrList", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^static struct list_head gMtuModBrList;$/", "file": true, "language": "C", "typeref": "struct:list_head", "kind": "variable"}, {"_type": "tag", "name": "icmpPktTemp", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^static unsigned char icmpPktTemp[]={$/", "file": true, "language": "C", "typeref": "typename:unsigned char[]", "kind": "variable"}, {"_type": "tag", "name": "icmpTooBigFlag", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^    unsigned char icmpTooBigFlag;$/", "file": true, "language": "C", "typeref": "typename:unsigned char", "kind": "member", "scope": "__anone05e87b90108", "scopeKind": "struct"}, {"_type": "tag", "name": "ip_copy_metadata", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^static void ip_copy_metadata(struct sk_buff *to, struct sk_buff *from)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(struct sk_buff * to,struct sk_buff * from)"}, {"_type": "tag", "name": "lock", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^static spinlock_t   lock;$/", "file": true, "language": "C", "typeref": "typename:spinlock_t", "kind": "variable"}, {"_type": "tag", "name": "mtu", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^    unsigned char mtu[2];$/", "file": true, "language": "C", "typeref": "typename:unsigned char[2]", "kind": "member", "scope": "__anone05e87b90108", "scopeKind": "struct"}, {"_type": "tag", "name": "mtu_mod_create_node", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^void mtu_mod_create_node(char *pBrName,char segmentFlag, char icmpFlag, int mtu, unsigned int gw/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(char * pBrName,char segmentFlag,char icmpFlag,int mtu,unsigned int gwIp)"}, {"_type": "tag", "name": "mtu_mod_flush_nodes", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^static void mtu_mod_flush_nodes(void)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "mtu_mod_get_setting", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^int mtu_mod_get_setting(char *pBrName,int *pSegFlag, int *pIcmpFlag, unsigned char *pMtu, unsign/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(char * pBrName,int * pSegFlag,int * pIcmpFlag,unsigned char * pMtu,unsigned char * pGw)"}, {"_type": "tag", "name": "mtu_mod_hook", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^static unsigned int mtu_mod_hook(unsigned int hook, struct sk_buff *skb, $/", "file": true, "language": "C", "typeref": "typename:unsigned int", "kind": "function", "signature": "(unsigned int hook,struct sk_buff * skb,const struct net_device * indev,const struct net_device * outdev,int (* kfn)(struct sk_buff *))"}, {"_type": "tag", "name": "mtu_mod_lock", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^static void mtu_mod_lock(void)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "mtu_mod_node_deinit", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^void mtu_mod_node_deinit(void)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "mtu_mod_node_init", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^void mtu_mod_node_init(void)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "mtu_mod_node_t", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^}mtu_mod_node_t;$/", "file": true, "language": "C", "typeref": "struct:__anone05e87b90108", "kind": "typedef"}, {"_type": "tag", "name": "mtu_mod_ops", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^static struct nf_hook_ops mtu_mod_ops={$/", "file": true, "language": "C", "typeref": "struct:nf_hook_ops", "kind": "variable"}, {"_type": "tag", "name": "mtu_mod_remove_node", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^void mtu_mod_remove_node(char *pBrName)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(char * pBrName)"}, {"_type": "tag", "name": "mtu_mod_search_node", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^static mtu_mod_node_t *mtu_mod_search_node(char *pBrName)$/", "file": true, "language": "C", "typeref": "typename:mtu_mod_node_t *", "kind": "function", "signature": "(char * pBrName)"}, {"_type": "tag", "name": "mtu_mod_send_icmp_too_big_frame", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^static void mtu_mod_send_icmp_too_big_frame(const struct net_device *pInDev, struct sk_buff *pSk/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(const struct net_device * pInDev,struct sk_buff * pSkb,unsigned char mtu[2],unsigned char gw[4])"}, {"_type": "tag", "name": "mtu_mod_show_node", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^void mtu_mod_show_node(char *pBrName)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(char * pBrName)"}, {"_type": "tag", "name": "mtu_mod_unlock", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^static void mtu_mod_unlock(void)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "mtu_mod_update_node", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^void mtu_mod_update_node(char *pBrName, char segmentFlag, char icmpFlag, int mtu, unsigned int g/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(char * pBrName,char segmentFlag,char icmpFlag,int mtu,unsigned int gwIp)"}, {"_type": "tag", "name": "node", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^    struct list_head node;$/", "file": true, "language": "C", "typeref": "struct:list_head", "kind": "member", "scope": "__anone05e87b90108", "scopeKind": "struct"}, {"_type": "tag", "name": "pGw", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^    unsigned char pGw[4];$/", "file": true, "language": "C", "typeref": "typename:unsigned char[4]", "kind": "member", "scope": "__anone05e87b90108", "scopeKind": "struct"}, {"_type": "tag", "name": "segFlag", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "pattern": "/^    unsigned char segFlag;$/", "file": true, "language": "C", "typeref": "typename:unsigned char", "kind": "member", "scope": "__anone05e87b90108", "scopeKind": "struct"}], "hash": "e886310cf079f5aaa23bd28a59018217", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/generic/mtu_modifier/mtu_mod_br.c", "fields": [{"name": "char[] brName", "scope": "__anone05e87b90108", "scopeKind": "struct", "description": "unavailable"}, {"name": "struct:list_head gMtuModBrList", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "unsigned char[] icmpPktTemp", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "unsigned char icmpTooBigFlag", "scope": "__anone05e87b90108", "scopeKind": "struct", "description": "unavailable"}, {"name": "spinlock_t lock", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "unsigned char[2] mtu", "scope": "__anone05e87b90108", "scopeKind": "struct", "description": "unavailable"}, {"name": "struct:nf_hook_ops mtu_mod_ops", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "struct:list_head node", "scope": "__anone05e87b90108", "scopeKind": "struct", "description": "unavailable"}, {"name": "unsigned char[4] pGw", "scope": "__anone05e87b90108", "scopeKind": "struct", "description": "unavailable"}, {"name": "unsigned char segFlag", "scope": "__anone05e87b90108", "scopeKind": "struct", "description": "unavailable"}], "revision_history": [{"18879": ""}]}