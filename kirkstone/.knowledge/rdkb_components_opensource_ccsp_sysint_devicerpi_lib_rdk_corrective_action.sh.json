{"is_source_file": true, "format": "shell script", "description": "This file is a shell script designed for device self-healing and diagnostics on a router or gateway device. It includes functions for checking system state, performing reboots, resetting processes, gathering system info, and managing configuration and reboot reasons.", "external_files": ["/etc/log_timestamp.sh", "/etc/device.properties", "/usr/ccsp/tad/selfheal_reset_counts.sh", "/rdklogger/backupLogs.sh", "/usr/bin/XconfHttpDl", "/usr/ccsp/snmp/run_subagent.sh", "/usr/ccsp/pam/launch_adv_security.sh", "/usr/ccsp/tr069pa", "/usr/ccsp/cm", "/usr/ccsp/wifi", "/usr/ccsp/hotspot", "/usr/ccsp/lm", "/usr/ccsp/xdns", "/usr/ccsp/ethagent", "/usr/ccsp/moca", "/usr/ccsp/tad/CcspTandDSsp", "/usr/ccsp/scannerd", "/usr/ccsp/threatd", "/usr/ccsp/advsec_bin/AdvSecurityAgent", "/usr/ccsp/advsec_bin/AdvSecurityRabid", "/usr/ccsp/advsec_bin/dnscap", "/usr/ccsp/advsec_bin/dhcpcap", "/usr/ccsp/advsec_bin/mdnscap", "/usr/ccsp/advsec_bin/p0f", "/usr/ccsp/advsec_bin/softflowd", "/usr/ccsp/advsec_bin/scannerd", "/usr/ccsp/advsec_bin/threatd"], "external_methods": ["dmcli eRT getv", "dmcli eRT setv", "syscfg get", "syscfg set", "syscfg commit", "cat", "grep", "awk", "tr", "date", "top", "ifconfig", "iptables -S", "ip route", "route", "ip6tables -S", "ip -6 route", "brctl show", "find", "kill", "reboot"], "published": ["getVendorName", "getModelName", "getDate", "getDateTime", "getCMMac", "checkConditionsbeforeAction", "resetRouter", "rebootNeeded", "checkCaptivePortal", "resetNeeded", "storeInformation", "setRebootreason", "CheckAndProceedFurtherBasedonDiagnosticMode", "checkMaintenanceWindow", "logNetworkInfo", "CheckRebootCretiriaForAtomHang", "SetRebootConfigForAtomHang"], "classes": [], "methods": [{"name": "getVendorName", "description": "Retrieves the device manufacturer name, either via dmcli or from device properties depending on SELFHEAL_TYPE and WAN_TYPE."}, {"name": "getModelName", "description": "Retrieves the device model name via dmcli or from device properties."}, {"name": "getDate", "description": "Returns the current system date and time in 'YYYY:MM:DD:HH:MM:SS' format."}, {"name": "getDateTime", "description": "Returns the current date and time with microsecond precision in 'YYYY-MM-DD:HH:MM:SS:Microseconds' format."}, {"name": "getCMMac", "description": "Retrieves the device's Base MAC Address, with logic depending on SELFHEAL_TYPE and WAN_TYPE."}, {"name": "checkConditionsbeforeAction", "description": "Checks network readiness, registration and call state before performing a corrective action, waits until conditions are met or timeout."}, {"name": "resetRouter", "description": "Performs a reset procedure on the router if certain conditions are met, including registration status and traffic checks."}, {"name": "rebootNeeded", "description": "Determines if a reboot is necessary based on system diagnostics, counts, and thresholds, and performs reboot if conditions are met."}, {"name": "checkCaptivePortal", "description": "Checks and enables captive portal if required based on network response, P&M notifications, and device configuration."}, {"name": "resetNeeded", "description": "Performs process reset actions for specified process names, with count limits and condition checks, including process-specific handling."}, {"name": "storeInformation", "description": "Gathers system memory, CPU, WiFi, MoCA, and network info and logs them for diagnostics."}, {"name": "setRebootreason", "description": "Sets the device reboot reason and counter in syscfg for diagnostic purposes."}, {"name": "CheckAndProceedFurtherBasedonDiagnosticMode", "description": "Checks whether the device is in diagnostic mode, skipping reboot/reset if true."}, {"name": "checkMaintenanceWindow", "description": "Checks if current time falls within a configured maintenance window for firmware upgrades."}], "calls": ["grep 'cpu ' /proc/stat", "sed", "cut", "awk", "dmcli eRT getv", "dmcli eRT setv", "syscfg get", "syscfg set", "syscfg commit", "date", "top", "ifconfig", "iptables -S", "ip route", "route", "ip6tables -S", "ip -6 route", "brctl show", "find", "kill", "reboot"], "search-terms": ["selfhealing", "corrective_action", "device reboot", "process reset", "diagnostics", "router system health", "MoCA statistics", "WiFi connected devices", "system memory utilization", "CPU load", "maintenance window", "reboot reason", "process management", "route diagnostics", "captive portal"], "state": 2, "file_id": 7136, "knowledge_revision": 20222, "git_revision": "", "hash": "951a826c3a936b99d0bc14e1115790d5", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/sysint/devicerpi/lib/rdk/corrective_action.sh", "revision_history": [{"20222": ""}]}