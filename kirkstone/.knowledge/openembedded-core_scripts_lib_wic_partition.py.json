{"is_source_file": true, "format": "Python", "description": "This file defines a 'Partition' class for managing disk partitions in an OpenEmbedded build environment, including methods for preparing, sizing, and creating various partition types (ext, btrfs, vfat, squashfs, erofs, swap). It handles configuration, filesystem preparation, and checks related to partition attributes and potential filesystem issues.", "external_files": ["wic", "wic.misc", "wic.pluginbase"], "external_methods": ["wic.WicError", "wic.misc.exec_cmd", "wic.misc.exec_native_cmd", "wic.misc.get_bitbake_var", "wic.pluginbase.PluginMgr", "os.path.isfile", "os.remove", "os.ftruncate", "os.path.join", "os.environ.get", "logging.getLogger", "exec_cmd", "exec_native_cmd"], "published": ["Partition"], "classes": [{"name": "Partition", "description": "Represents a disk partition with methods to configure, prepare, and size it for various filesystem types and partition schemes, including support for special cases like swap and handling of filesystem-specific preparation routines."}], "methods": [{"name": "get_extra_block_count(self, current_blocks)", "description": "Calculates how many 1k blocks need to be added to reach the desired size based on current blocks and requested size.", "scope": "Partition", "scopeKind": "class"}, {"name": "get_rootfs_size(self, actual_rootfs_size=0)", "description": "Computes the size needed for the root filesystem partition, considering fixed size constraints, extra space, overhead factor, and actual rootfs size.", "scope": "Partition", "scopeKind": "class"}, {"name": "prepare(self, creator, cr_workdir, oe_builddir, rootfs_dir, bootimg_dir, kernel_dir, native_sysroot, updated_fstab_path)", "description": "Prepares the partition content based on its configuration, including calling plugin routines for source-based partitions or creating empty filesystem images.", "scope": "Partition", "scopeKind": "class"}, {"name": "prepare_rootfs(self, cr_workdir, oe_builddir, rootfs_dir, native_sysroot, real_rootfs = True, pseudo_dir = None)", "description": "Creates and populates a root filesystem partition, using plugin routines and handling different filesystem types.", "scope": "Partition", "scopeKind": "class"}, {"name": "prepare_rootfs_ext(self, rootfs, cr_workdir, oe_builddir, rootfs_dir, native_sysroot, pseudo)", "description": "Prepares an ext filesystem rootfs, creating sparse files, formatting, and optionally updating fstab.", "scope": "Partition", "scopeKind": "class"}, {"name": "prepare_rootfs_btrfs(self, rootfs, cr_workdir, oe_builddir, rootfs_dir, native_sysroot, pseudo)", "description": "Prepares a btrfs rootfs similar to ext, with relevant formatting commands.", "scope": "Partition", "scopeKind": "class"}, {"name": "prepare_rootfs_msdos(self, rootfs, cr_workdir, oe_builddir, rootfs_dir, native_sysroot, pseudo)", "description": "Prepares an msdos/vfat rootfs, including creating filesystem and copying fstab if needed.", "scope": "Partition", "scopeKind": "class"}, {"name": "prepare_rootfs_vfat", "description": "Alias for prepare_rootfs_msdos."}, {"name": "prepare_rootfs_squashfs(self, rootfs, cr_workdir, oe_builddir, rootfs_dir, native_sysroot, pseudo)", "description": "Creates a squashfs rootfs from a directory.", "scope": "Partition", "scopeKind": "class"}, {"name": "prepare_rootfs_erofs(self, rootfs, cr_workdir, oe_builddir, rootfs_dir, native_sysroot, pseudo)", "description": "Creates an erofs rootfs image.", "scope": "Partition", "scopeKind": "class"}, {"name": "prepare_empty_partition_ext(self, rootfs, oe_builddir, native_sysroot)", "description": "Creates an empty ext filesystem partition.", "scope": "Partition", "scopeKind": "class"}, {"name": "prepare_empty_partition_btrfs(self, rootfs, oe_builddir, native_sysroot)", "description": "Creates an empty btrfs partition.", "scope": "Partition", "scopeKind": "class"}, {"name": "prepare_empty_partition_msdos(self, rootfs, oe_builddir, native_sysroot)", "description": "Creates an empty msdos/vfat partition.", "scope": "Partition", "scopeKind": "class"}, {"name": "prepare_empty_partition_vfat", "description": "Alias for prepare_empty_partition_msdos."}, {"name": "prepare_swap_partition(self, cr_workdir, oe_builddir, native_sysroot)", "description": "Prepares a swap partition.", "scope": "Partition", "scopeKind": "class"}, {"name": "check_for_Y2038_problem(self, rootfs, native_sysroot)", "description": "Checks if the filesystem is affected by the Y2038 problem, issuing warnings if necessary.", "scope": "Partition", "scopeKind": "class"}, {"name": "__init__(self, args, lineno)", "scope": "Partition", "scopeKind": "class", "description": "unavailable"}, {"name": "disk_size(self)", "scope": "Partition", "scopeKind": "class", "description": "unavailable"}, {"name": "get_err_str(part)", "scope": "Partition.check_for_Y2038_problem", "scopeKind": "member", "description": "unavailable"}], "calls": ["exec_cmd", "exec_native_cmd", "os.path.isfile", "os.remove", "os.ftruncate", "os.path.join", "get_bitbake_var", "logging.getLogger", "WicError"], "search-terms": ["partition class", "filesystem preparation", "openembedded partition", "filesystem creation", "Y2038 filesystem", "partition sizing", "source plugin", "fstab update", "boot image", "filesystem type exts"], "state": 2, "file_id": 1443, "knowledge_revision": 14593, "git_revision": "", "ctags": [{"_type": "tag", "name": "Partition", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^class Partition():$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def __init__(self, args, lineno):$/", "language": "Python", "kind": "member", "signature": "(self, args, lineno)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "check_for_Y2038_problem", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def check_for_Y2038_problem(self, rootfs, native_sysroot):$/", "language": "Python", "kind": "member", "signature": "(self, rootfs, native_sysroot)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "disk_size", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def disk_size(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "get_err_str", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^        def get_err_str(part):$/", "file": true, "language": "Python", "kind": "function", "signature": "(part)", "scope": "Partition.check_for_Y2038_problem", "scopeKind": "member"}, {"_type": "tag", "name": "get_extra_block_count", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def get_extra_block_count(self, current_blocks):$/", "language": "Python", "kind": "member", "signature": "(self, current_blocks)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "get_rootfs_size", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def get_rootfs_size(self, actual_rootfs_size=0):$/", "language": "Python", "kind": "member", "signature": "(self, actual_rootfs_size=0)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^logger = logging.getLogger('wic')$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "prepare", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def prepare(self, creator, cr_workdir, oe_builddir, rootfs_dir,$/", "language": "Python", "kind": "member", "signature": "(self, creator, cr_workdir, oe_builddir, rootfs_dir, bootimg_dir, kernel_dir, native_sysroot, updated_fstab_path)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "prepare_empty_partition_btrfs", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def prepare_empty_partition_btrfs(self, rootfs, oe_builddir,$/", "language": "Python", "kind": "member", "signature": "(self, rootfs, oe_builddir, native_sysroot)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "prepare_empty_partition_ext", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def prepare_empty_partition_ext(self, rootfs, oe_builddir,$/", "language": "Python", "kind": "member", "signature": "(self, rootfs, oe_builddir, native_sysroot)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "prepare_empty_partition_msdos", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def prepare_empty_partition_msdos(self, rootfs, oe_builddir,$/", "language": "Python", "kind": "member", "signature": "(self, rootfs, oe_builddir, native_sysroot)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "prepare_empty_partition_vfat", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    prepare_empty_partition_vfat = prepare_empty_partition_msdos$/", "language": "Python", "kind": "variable", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "prepare_rootfs", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def prepare_rootfs(self, cr_workdir, oe_builddir, rootfs_dir,$/", "language": "Python", "kind": "member", "signature": "(self, cr_workdir, oe_builddir, rootfs_dir, native_sysroot, real_rootfs = True, pseudo_dir = None)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "prepare_rootfs_btrfs", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def prepare_rootfs_btrfs(self, rootfs, cr_workdir, oe_builddir, rootfs_dir,$/", "language": "Python", "kind": "member", "signature": "(self, rootfs, cr_workdir, oe_builddir, rootfs_dir, native_sysroot, pseudo)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "prepare_rootfs_erofs", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def prepare_rootfs_erofs(self, rootfs, cr_workdir, oe_builddir, rootfs_dir,$/", "language": "Python", "kind": "member", "signature": "(self, rootfs, cr_workdir, oe_builddir, rootfs_dir, native_sysroot, pseudo)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "prepare_rootfs_ext", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def prepare_rootfs_ext(self, rootfs, cr_workdir, oe_builddir, rootfs_dir,$/", "language": "Python", "kind": "member", "signature": "(self, rootfs, cr_workdir, oe_builddir, rootfs_dir, native_sysroot, pseudo)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "prepare_rootfs_msdos", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def prepare_rootfs_msdos(self, rootfs, cr_workdir, oe_builddir, rootfs_dir,$/", "language": "Python", "kind": "member", "signature": "(self, rootfs, cr_workdir, oe_builddir, rootfs_dir, native_sysroot, pseudo)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "prepare_rootfs_squashfs", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def prepare_rootfs_squashfs(self, rootfs, cr_workdir, oe_builddir, rootfs_dir,$/", "language": "Python", "kind": "member", "signature": "(self, rootfs, cr_workdir, oe_builddir, rootfs_dir, native_sysroot, pseudo)", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "prepare_rootfs_vfat", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    prepare_rootfs_vfat = prepare_rootfs_msdos$/", "language": "Python", "kind": "variable", "scope": "Partition", "scopeKind": "class"}, {"_type": "tag", "name": "prepare_swap_partition", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/scripts/lib/wic/partition.py", "pattern": "/^    def prepare_swap_partition(self, cr_workdir, oe_builddir, native_sysroot):$/", "language": "Python", "kind": "member", "signature": "(self, cr_workdir, oe_builddir, native_sysroot)", "scope": "Partition", "scopeKind": "class"}], "hash": "84e1be1244bc6213442858e913b3a3a5", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "openembedded-core/scripts/lib/wic/partition.py", "fields": [{"name": "logger = logging.getLogger('wic')", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "prepare_empty_partition_vfat = prepare_empty_partition_msdos", "scope": "Partition", "scopeKind": "class", "description": "unavailable"}, {"name": "prepare_rootfs_vfat = prepare_rootfs_msdos", "scope": "Partition", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"14593": ""}]}