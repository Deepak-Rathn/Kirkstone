{"is_source_file": true, "format": "PHP", "description": "This PHP source file appears to be a web interface script for router or network device management. It includes HTML markup, PHP logic for authentication, session management, access control, and external script and style references. The code facilitates user login, supports multiple user roles (e.g., 'mso', 'cusadmin'), handles login attempt locking, and manages sessions with IP binding and token verification.", "external_files": ["includes/utility.php", "includes/jwt.php"], "external_methods": ["getStr", "setStr", "VerifyToken", "getAuthenticationUrl", "innerIP", "checkCusadminAccess", "if_type"], "published": ["create_session"], "classes": [], "methods": [{"name": "create_session", "description": "Handles creation and validation of user sessions, including IP binding and session ID verification, setting session variables based on user login and model type."}, {"name": "innerIP", "description": "Determines if the client IP is within the LAN subnet by executing system network commands and analyzing network configuration."}, {"name": "get_ips", "description": "Retrieves IP addresses associated with a specified network interface."}, {"name": "checkCusadminAccess", "description": "Evaluates whether a given IP address has remote access permissions based on current configuration and network mode."}, {"name": "if_type", "description": "Classifies an IP address as 'lan_ip', 'cm_ip', or 'rg_ip' based on network interface and subnet configurations."}, {"name": "getAuthenticationUrl", "description": "Constructs an OAuth authentication URL with query parameters for redirect URI."}], "calls": ["getStr", "setStr", "VerifyToken", "getAuthenticationUrl", "innerIP", "checkCusadminAccess", "if_type", "/usr/bin/logger", "/usr/bin/snmpget", "exec", "sleep", "session_start", "session_destroy", "header", "echo", "fopen", "fgets", "fclose", "str_replace", "strpos", "explode", "array_pop", "in_array", "strcasecmp", "strcmp"], "search-terms": ["PHP router login", "session IP binding", "OAuth token verification", "user role mso cusadmin", "login lockout attempts", "network interface IP retrieval", "device model specific logic"], "state": 2, "file_id": 8708, "knowledge_revision": 21744, "git_revision": "", "hash": "0607af7b8a974dd1ed8063b8f957a9b4", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/webui-bwg/source/Styles/xb3/code/check.php", "revision_history": [{"21744": ""}]}