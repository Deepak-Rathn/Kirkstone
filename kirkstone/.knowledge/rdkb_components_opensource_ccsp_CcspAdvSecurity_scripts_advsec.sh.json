{"is_source_file": true, "format": "bash script", "description": "This file is a shell script that manages security-related features for a device, including starting/stopping agents, managing kernel modules, and configuration. It defines variables, functions, and control logic specific to device security features.", "external_files": ["/etc/device.properties", "/etc/log_timestamp.sh", "/usr/bin/cujo-agent-sh-env", "/sys", "/proc/self/net/netfilter/nfnetlink_queue", "/lib/modules/$(uname -r)/nflua.ko", "/lib/modules/$(uname -r)/luaconntrack.ko", "/lib/modules/$(uname -r)/luadata.ko", "/lib/modules/$(uname -r)/luajson.ko", "/lib/modules/$(uname -r)/lunatik.ko", "/lib/modules/$(uname -r)/luapuma.ko", "/lib/modules/$(uname -r)/pumastats.ko", "/lib/modules/$(uname -r)/luakcrypto.ko"], "external_methods": ["syscfg get", "pidof", "kill", "insmod", "rmmod", "lsmod", "mount", "umount", "echo_t", "netstat", "sleep", "touch", "rm", "sysctl", "ipset create", "ipset flush", "ipset destroy", "grep", "bash", "basename", "cut", "ps", "grep", "awk"], "published": ["advsec_is_agent_installed", "advsec_start_agent", "advsec_wait_for_agent", "advsec_agent_start_fp", "advsec_agent_start_sb", "advsec_agent_start_sf", "advsec_stop_agent", "advsec_agent_stop_fp", "advsec_agent_stop_sb", "advsec_agent_stop_sf", "start_adv_parental_control", "stop_adv_parental_control", "start_privacy_protection", "stop_privacy_protection", "start_app_blocker", "stop_app_blocker", "advsec_module_load", "advsec_module_unload", "advsec_initialize_nfq_ct", "advsec_agent_create_ipsets", "advsec_agent_flush_ipsets", "advsec_agent_restart_needed", "advsec_is_alive", "advsec_stop_process", "advsec_cleanup_config", "advsec_cleanup_config_agent", "advsec_restart_agent", "advsec_get_agent_group_name", "advsec_agent_loglevel", "advsec_agent_get_safebro_config", "wait_for_lanip"], "classes": [], "methods": [], "calls": ["pidof ${CUJO_AGENT}", "kill -TERM", "sysctl -w", "insmod", "rmmod", "lsmod", "mount", "umount", "ipset create", "ipset flush", "ipset destroy", "cat", "sysevent get", "netstat -an", "sleep", "touch", "rm", "basename", "cut", "ps", "grep -v", "awk", "echo"], "search-terms": ["advsec", "kernel modules", "agent management", "ipset configuration", "firewall rules", "kernel module load/unload", "device security script", "CUJO agent", "nfnetlink_queue", "nfq_ct", "advsec"], "state": 2, "file_id": 5879, "knowledge_revision": 18982, "git_revision": "", "hash": "af69c5af0dd1f7c8f733936b928ee687", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/CcspAdvSecurity/scripts/advsec.sh", "revision_history": [{"18982": ""}]}