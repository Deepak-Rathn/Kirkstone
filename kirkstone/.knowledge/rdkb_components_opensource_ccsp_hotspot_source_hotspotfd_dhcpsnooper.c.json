{"is_source_file": true, "format": "C", "description": "This source file implements DHCP snooping and client management for a hotspot system, including packet processing, client list management, and integration with netfilter queue (nfq) for handling DHCP packets in kernel networking modules.", "external_files": ["dhcpsnooper.h", "debug.h", "dhcp.h", "ansc_platform.h", "telemetry_busmessage_sender.h", "libHotspot.h"], "external_methods": ["nfq_open", "nfq_unbind_pf", "nfq_bind_pf", "nfq_create_queue", "nfq_set_mode", "nfq_handle_packet", "nfq_destroy_queue", "nfq_close", "nfnl_fd", "nfq_nfnlh", "nfq_get_msg_packet_hdr", "nfq_get_payload", "nfq_set_verdict", "exit", "nfq_handle_packet"], "published": ["snoop_ipChecksum", "snoop_log", "snoop_RemoveClientListEntry", "updateRssiForClient", "dhcp_snooper_init"], "classes": [], "methods": [{"name": "uint16_t snoop_ipChecksum(struct iphdr * header)", "description": "Calculates the IP header checksum.", "scope": "", "scopeKind": ""}, {"name": "void snoop_log(void)", "description": "Logs DHCP snooping details including client list and statistics.", "scope": "", "scopeKind": ""}, {"name": "void snoop_RemoveClientListEntry(char * pRemote_id)", "description": "Removes a client from the snooper client list based on remote ID.", "scope": "", "scopeKind": ""}, {"name": "void updateRssiForClient(char * pRemote_id,int rssi)", "description": "Updates RSSI for a specific client in the client list.", "scope": "", "scopeKind": ""}, {"name": "void * dhcp_snooper_init(void * data)", "description": "Initializes the DHCP snooping netfilter queue handler in a separate thread.", "scope": "", "scopeKind": ""}, {"name": "void SET_LIST_HEAD(struct mylist_head * l)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void mylist_add(struct mylist_head * nn,struct mylist_head * h)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void mylist_del(struct mylist_head * e)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void snoop_AddClientListEntry(char * pRemote_id,char * pCircuit_id,char * pDhcp_status,char * pIpv4_addr,char * pHostname,int rssi)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void snoop_AddClientListHostname(char * pHostname,char * pRemote_id,int queue_number)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void snoop_CheckClientIsPrivate(char * pRemote_id)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int snoop_addRelayAgentOptions(struct dhcp_packet * packet,unsigned length,int queue_number)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool snoop_isValidIpAddress(char * ipAddress)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int snoop_packetHandler(struct nfq_q_handle * myQueue,struct nfgenmsg * msg,struct nfq_data * pkt,void * cbData)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int snoop_removeRelayAgentOptions(struct dhcp_packet * packet,unsigned length,int queue_number)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["nfq_open", "nfq_unbind_pf", "nfq_bind_pf", "nfq_create_queue", "nfq_set_mode", "nfq_handle_packet", "nfq_destroy_queue", "nfq_close", "nfq_get_msg_packet_hdr", "nfq_get_payload", "nfq_set_verdict", "nfq_nfnlh", "nfnl_fd", "nfq_handle_packet", "exit"], "search-terms": ["dhcpsnooper", "netfilter queue", "DHCP relay options", "client list management", "DHCP packet handler", "hotspot DHCP snooping", "gSnoop_ClientList", "gCircuit_id", "gRemote_id", "dhcp_snooper_init"], "state": 2, "file_id": 9749, "knowledge_revision": 22749, "git_revision": "", "ctags": [{"_type": "tag", "name": "SET_LIST_HEAD", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static inline void SET_LIST_HEAD(struct mylist_head *l)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(struct mylist_head * l)"}, {"_type": "tag", "name": "add_agent_options", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static int add_agent_options = 1;\t\\/* If nonzero, add relay agent options. *\\/$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "agent_relay_mode", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static enum agent_relay_mode_t agent_relay_mode = forward_and_replace;$/", "file": true, "language": "C", "typeref": "enum:agent_relay_mode_t", "kind": "variable"}, {"_type": "tag", "name": "cof", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^#define cof(/", "file": true, "language": "C", "kind": "macro", "signature": "(p,t,m)"}, {"_type": "tag", "name": "dhcp_snooper_init", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^void *dhcp_snooper_init(void *data)$/", "language": "C", "typeref": "typename:void *", "kind": "function", "signature": "(void * data)"}, {"_type": "tag", "name": "gCircuit_id", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static char gCircuit_id[kSnoop_MaxCircuitLen];$/", "file": true, "language": "C", "typeref": "typename:char[]", "kind": "variable"}, {"_type": "tag", "name": "gPriv_data", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static int gPriv_data[kSnoop_MaxNumberOfQueues];$/", "file": true, "language": "C", "typeref": "typename:int[]", "kind": "variable"}, {"_type": "tag", "name": "gRemote_id", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static char gRemote_id[kSnoop_MaxRemoteLen]; $/", "file": true, "language": "C", "typeref": "typename:char[]", "kind": "variable"}, {"_type": "tag", "name": "gSnoopDhcpMaxAgentOptionLen", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static int gSnoopDhcpMaxAgentOptionLen = DHCP_MTU_MIN;$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "gSnoopNumCapturedPackets", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static int gSnoopNumCapturedPackets = 0;$/", "file": true, "language": "C", "typeref": "typename:int", "kind": "variable"}, {"_type": "tag", "name": "gSnoop_ClientList", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static snooper_priv_client_list gSnoop_ClientList;$/", "file": true, "language": "C", "typeref": "typename:snooper_priv_client_list", "kind": "variable"}, {"_type": "tag", "name": "g_cHostnameForQueue", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static char g_cHostnameForQueue[kSnoop_MaxCircuitIDs][kSnooper_MaxHostNameLen];$/", "file": true, "language": "C", "typeref": "typename:char[][]", "kind": "variable"}, {"_type": "tag", "name": "g_cInformIpForQueue", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static char g_cInformIpForQueue[kSnoop_MaxCircuitIDs][INET_ADDRSTRLEN];$/", "file": true, "language": "C", "typeref": "typename:char[][]", "kind": "variable"}, {"_type": "tag", "name": "global_stats_mutex", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static pthread_mutex_t global_stats_mutex = PTHREAD_MUTEX_INITIALIZER;$/", "file": true, "language": "C", "typeref": "typename:pthread_mutex_t", "kind": "variable"}, {"_type": "tag", "name": "glog_level", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^unsigned int glog_level = kSnoop_LOG_NOISE;$/", "language": "C", "typeref": "typename:unsigned int", "kind": "variable"}, {"_type": "tag", "name": "mylist_add", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static inline void mylist_add(struct mylist_head *nn, struct mylist_head *h)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(struct mylist_head * nn,struct mylist_head * h)"}, {"_type": "tag", "name": "mylist_del", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static inline void mylist_del(struct mylist_head *e)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(struct mylist_head * e)"}, {"_type": "tag", "name": "mylist_entry", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^#define mylist_entry(/", "file": true, "language": "C", "kind": "macro", "signature": "(p,t,m)"}, {"_type": "tag", "name": "mylist_safe", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^#define mylist_safe(/", "file": true, "language": "C", "kind": "macro", "signature": "(p,q,h)"}, {"_type": "tag", "name": "offf", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^#define offf(/", "file": true, "language": "C", "kind": "macro", "signature": "(t,m)"}, {"_type": "tag", "name": "snoop_AddClientListEntry", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static void snoop_AddClientListEntry(char *pRemote_id, char *pCircuit_id,$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(char * pRemote_id,char * pCircuit_id,char * pDhcp_status,char * pIpv4_addr,char * pHostname,int rssi)"}, {"_type": "tag", "name": "snoop_AddClientListHostname", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static void snoop_AddClientListHostname(char *pHostname, char *pRemote_id, int queue_number)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(char * pHostname,char * pRemote_id,int queue_number)"}, {"_type": "tag", "name": "snoop_CheckClientIsPrivate", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static void snoop_CheckClientIsPrivate(char *pRemote_id)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(char * pRemote_id)"}, {"_type": "tag", "name": "snoop_RemoveClientListEntry", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^void snoop_RemoveClientListEntry(char *pRemote_id)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(char * pRemote_id)"}, {"_type": "tag", "name": "snoop_addRelayAgentOptions", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static int snoop_addRelayAgentOptions(struct dhcp_packet *packet, unsigned length, int queue_num/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(struct dhcp_packet * packet,unsigned length,int queue_number)"}, {"_type": "tag", "name": "snoop_ipChecksum", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^uint16_t snoop_ipChecksum(struct iphdr * header)$/", "language": "C", "typeref": "typename:uint16_t", "kind": "function", "signature": "(struct iphdr * header)"}, {"_type": "tag", "name": "snoop_isValidIpAddress", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static bool snoop_isValidIpAddress(char *ipAddress)$/", "file": true, "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "(char * ipAddress)"}, {"_type": "tag", "name": "snoop_log", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^void snoop_log(void)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "snoop_packetHandler", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static int snoop_packetHandler(struct nfq_q_handle * myQueue, struct nfgenmsg *msg,struct nfq_da/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(struct nfq_q_handle * myQueue,struct nfgenmsg * msg,struct nfq_data * pkt,void * cbData)"}, {"_type": "tag", "name": "snoop_removeRelayAgentOptions", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^static int snoop_removeRelayAgentOptions(struct dhcp_packet *packet, unsigned length, int queue_/", "file": true, "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(struct dhcp_packet * packet,unsigned length,int queue_number)"}, {"_type": "tag", "name": "updateRssiForClient", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "pattern": "/^void updateRssiForClient(char* pRemote_id, int rssi)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(char * pRemote_id,int rssi)"}], "hash": "0c9fd77caa13511da2f1587382c34b1f", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/hotspot/source/hotspotfd/dhcpsnooper.c", "fields": [{"name": "int add_agent_options", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "enum:agent_relay_mode_t agent_relay_mode", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char[] gCircuit_id", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int[] gPriv_data", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char[] gRemote_id", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int gSnoopDhcpMaxAgentOptionLen", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int gSnoopNumCapturedPackets", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "snooper_priv_client_list gSnoop_ClientList", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char[][] g_cHostnameForQueue", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "char[][] g_cInformIpForQueue", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pthread_mutex_t global_stats_mutex", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "unsigned int glog_level", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"22749": ""}]}