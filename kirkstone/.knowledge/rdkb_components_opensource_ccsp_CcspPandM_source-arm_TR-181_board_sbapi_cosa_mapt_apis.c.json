{"is_source_file": true, "format": "C", "description": "This source file implements backend APIs for MAP-T (Mapping of Address and Port Translation) configuration in a router's data model. It includes functions for formulating IPv4 and IPv6 addresses, parsing MAP-T options received from network, applying configuration by loading kernel modules and setting sysctl parameters, managing services like DHCP and UPnP, and handling configuration rollback.", "external_files": ["ccsp_psm_helper.h", "ansc_platform.h", "syscfg/syscfg.h", "cosa_mapt_apis.h", "plugin_main_apis.h", "secure_wrapper.h", "safec_lib_common.h", "cosa_drg_common.h", "ipc_msg.h", "/sys/kernel/debug", "/lib/modules/`uname -r`/extra/nat46.ko"], "external_methods": ["commonSyseventSet", "v_secure_system", "syscfg_get", "pthread_create", "pthread_detach", "memset_s", "memcpy_s", "sprintf_s", "strcmp_s", "strcmp", "fscanf", "fgets", "fputs", "fclose", "remove", "access", "inet_pton", "inet_ntop", "htonl", "ntohs", "strtol", "strchr", "strstr", "strlen", "memset", "memcpy", "fopen", "fprintf", "fscanf", "popen", "pclose", "close", "system", "sprintf", "snprintf", "memset_s", "release_componentStruct_t", "free_componentStruct_t", "getIPv6StringFromHex", "apply_config", "setUPnPIGDService"], "published": ["CosaDmlMaptProcessOpt95Response", "CosaDmlMaptPrintConfig", "CosaDmlMaptResetClient", "CosaDmlMaptResetConfig", "CosaDmlMaptRollback", "CosaDmlMaptProcessOpt95Response"], "classes": [], "methods": [{"name": "UINT CosaDmlMaptCalculateChecksum(unsigned char * buf)", "description": "Calculates a simple checksum over a buffer by summing all byte values.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptFormulateIPv4Address(UINT32 ipv4Suffix,PCHAR pIPv4AddrString)", "description": "Generates an IPv4 address by adding a suffix to a base IPv4 prefix.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptFormulateIPv6Address(PCHAR pPdIPv6Prefix,PCHAR pIPv4AddrSting,UINT16 psid,PCHAR pIPv6AddrString)", "description": "Constructs an IPv6 address combining a prefix, IPv4 address, and PSID.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptGetIPv6StringFromHex(PUCHAR pIPv6AddrH,PCHAR pIPv6AddrS)", "description": "Converts a hexadecimal IPv6 address to its string representation.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptApplyConfig(VOID)", "description": "Applies NAT46 related configurations, loads kernel modules, and sets up routing.", "scope": "", "scopeKind": ""}, {"name": "PVOID CosaDmlMaptSetUPnPIGDService(PVOID arg)", "description": "Sets the UPnP IGD service via D-Bus support, used for enabling/disabling UPnP.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptFlushDNSv4Entries(VOID)", "description": "Removes DNS server entries from resolv.conf to flush cached DNS.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptStopServices(VOID)", "description": "Stops DHCP client, flushes DNS, and disables NAT46 modules.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptSetEvents(VOID)", "description": "Sets sysctl and sysevent parameters for MAP-T operation.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptResetClient(VOID)", "description": "Restarts DHCPv4 client service.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptResetEvents(VOID)", "description": "Resets MAP-T related sysvents to default/empty values.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptResetConfig(VOID)", "description": "Restores default IP routes and removes kernel modules related to NAT46.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptRollback(RB_STATE eState)", "description": "Performs a rollback of MAP-T configuration based on specified reset flags.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptConvertStringToHexStream(PUCHAR pWriteBf,PUINT16 uiOptionBufLen)", "description": "Converts a colon-separated hex string into a byte stream.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptDisplayFeatureStatus(VOID)", "description": "Logs the status of various MAP-T features based on syscfg values.", "scope": "", "scopeKind": ""}, {"name": "RETURN_STATUS CosaDmlMaptComputePsidAndIPv4Suffix(PCHAR pPdIPv6Prefix,UINT16 ui16PdPrefixLen,UINT16 ui16v6PrefixLen,UINT16 ui16v4PrefixLen,PUINT16 pPsid,PUINT16 pPsidLen,PUINT32 pIPv4Suffix)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "RETURN_STATUS CosaDmlMaptParseResponse(PUCHAR pOptionBuf,UINT16 uiOptionBufLen)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "RETURN_STATUS CosaDmlMaptPrintConfig(VOID)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ANSC_STATUS CosaDmlMaptProcessOpt95Response(PCHAR pPdIPv6Prefix,PUCHAR pOptionBuf)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["commonSyseventSet", "v_secure_system", "syscfg_get", "pthread_create", "pthread_detach", "memset_s", "memcpy_s", "sprintf_s", "strcmp_s", "fopen", "fclose", "fgets", "fputs", "remove", "access", "inet_pton", "inet_ntop", "htonl", "ntohs", "strtol", "strchr", "strstr", "strlen", "system", "popen", "pclose"], "search-terms": ["COSA_DML_MAPT_DATA", "Option95", "IPv6", "IPv4", "PSID", "nat46", "mapt", "MAP-T", "nat46.ko", "syscfg", "UPnP", "firewall", "nat"], "state": 2, "file_id": 8516, "knowledge_revision": 21550, "git_revision": "", "ctags": [{"_type": "tag", "name": "CosaDmlMaptApplyConfig", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptApplyConfig$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(VOID)"}, {"_type": "tag", "name": "CosaDmlMaptCalculateChecksum", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptCalculateChecksum(unsigned char *buf)$/", "file": true, "language": "C", "typeref": "typename:UINT", "kind": "function", "signature": "(unsigned char * buf)"}, {"_type": "tag", "name": "CosaDmlMaptComputePsidAndIPv4Suffix", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptComputePsidAndIPv4Suffix$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(PCHAR pPdIPv6Prefix,UINT16 ui16PdPrefixLen,UINT16 ui16v6PrefixLen,UINT16 ui16v4PrefixLen,PUINT16 pPsid,PUINT16 pPsidLen,PUINT32 pIPv4Suffix)"}, {"_type": "tag", "name": "CosaDmlMaptConvertStringToHexStream", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptConvertStringToHexStream$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(PUCHAR pWriteBf,PUINT16 uiOptionBufLen)"}, {"_type": "tag", "name": "CosaDmlMaptDisplayFeatureStatus", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptDisplayFeatureStatus$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(VOID)"}, {"_type": "tag", "name": "CosaDmlMaptFlushDNSv4Entries", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptFlushDNSv4Entries$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(VOID)"}, {"_type": "tag", "name": "CosaDmlMaptFormulateIPv4Address", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptFormulateIPv4Address$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(UINT32 ipv4Suffix,PCHAR pIPv4AddrString)"}, {"_type": "tag", "name": "CosaDmlMaptFormulateIPv6Address", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptFormulateIPv6Address$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(PCHAR pPdIPv6Prefix,PCHAR pIPv4AddrSting,UINT16 psid,PCHAR pIPv6AddrString)"}, {"_type": "tag", "name": "CosaDmlMaptGetIPv6StringFromHex", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptGetIPv6StringFromHex$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(PUCHAR pIPv6AddrH,PCHAR pIPv6AddrS)"}, {"_type": "tag", "name": "CosaDmlMaptParseResponse", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptParseResponse$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(PUCHAR pOptionBuf,UINT16 uiOptionBufLen)"}, {"_type": "tag", "name": "CosaDmlMaptPrintConfig", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptPrintConfig$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(VOID)"}, {"_type": "tag", "name": "CosaDmlMaptProcessOpt95Response", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptProcessOpt95Response$/", "language": "C", "typeref": "typename:ANSC_STATUS", "kind": "function", "signature": "(PCHAR pPdIPv6Prefix,PUCHAR pOptionBuf)"}, {"_type": "tag", "name": "CosaDmlMaptResetClient", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptResetClient$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(VOID)"}, {"_type": "tag", "name": "CosaDmlMaptResetConfig", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptResetConfig$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(VOID)"}, {"_type": "tag", "name": "CosaDmlMaptResetEvents", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptResetEvents$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(VOID)"}, {"_type": "tag", "name": "CosaDmlMaptRollback", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptRollback$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(RB_STATE eState)"}, {"_type": "tag", "name": "CosaDmlMaptSetEvents", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptSetEvents$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(VOID)"}, {"_type": "tag", "name": "CosaDmlMaptSetUPnPIGDService", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptSetUPnPIGDService$/", "file": true, "language": "C", "typeref": "typename:PVOID", "kind": "function", "signature": "(PVOID arg)"}, {"_type": "tag", "name": "CosaDmlMaptStopServices", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^CosaDmlMaptStopServices$/", "file": true, "language": "C", "typeref": "typename:RETURN_STATUS", "kind": "function", "signature": "(VOID)"}, {"_type": "tag", "name": "FIRST_BYTE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^#define FIRST_BYTE(/", "file": true, "language": "C", "kind": "macro", "signature": "(byte)"}, {"_type": "tag", "name": "FORTH_BYTE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^#define FORTH_BYTE(/", "file": true, "language": "C", "kind": "macro", "signature": "(byte)"}, {"_type": "tag", "name": "RESOLV_CONF_FILE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^#define RESOLV_CONF_FILE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "RESOLV_CONF_FILE_BK", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^#define RESOLV_CONF_FILE_BK /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "SECND_BYTE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^#define SECND_BYTE(/", "file": true, "language": "C", "kind": "macro", "signature": "(byte)"}, {"_type": "tag", "name": "SET_BIT_MASK", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^#define SET_BIT_MASK(/", "file": true, "language": "C", "kind": "macro", "signature": "(maskBits,shiftBits)"}, {"_type": "tag", "name": "SET_RSHIFT_MASK", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^#define SET_RSHIFT_MASK(/", "file": true, "language": "C", "kind": "macro", "signature": "(maskBits)"}, {"_type": "tag", "name": "STATUS_NULL", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^#define STATUS_NULL /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "STRING_TO_HEX", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^#define STRING_TO_HEX(/", "file": true, "language": "C", "kind": "macro", "signature": "(pStr)"}, {"_type": "tag", "name": "THIRD_BYTE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^#define THIRD_BYTE(/", "file": true, "language": "C", "kind": "macro", "signature": "(byte)"}, {"_type": "tag", "name": "g_bEnableUPnPIGD", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^static volatile UINT8 g_bEnableUPnPIGD;$/", "file": true, "language": "C", "typeref": "typename:volatile UINT8", "kind": "variable"}, {"_type": "tag", "name": "g_bRollBackInProgress", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^static UINT8 g_bRollBackInProgress;$/", "file": true, "language": "C", "typeref": "typename:UINT8", "kind": "variable"}, {"_type": "tag", "name": "g_stMaptData", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^static COSA_DML_MAPT_DATA   g_stMaptData;$/", "file": true, "language": "C", "typeref": "typename:COSA_DML_MAPT_DATA", "kind": "variable"}, {"_type": "tag", "name": "s_Option95CheckSum", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "pattern": "/^static UINT s_Option95CheckSum = 0;$/", "file": true, "language": "C", "typeref": "typename:UINT", "kind": "variable"}], "hash": "fb600b8014e32b3c2413f0615d624fa5", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/CcspPandM/source-arm/TR-181/board_sbapi/cosa_mapt_apis.c", "fields": [{"name": "volatile UINT8 g_bEnableUPnPIGD", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "UINT8 g_bRollBackInProgress", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "COSA_DML_MAPT_DATA g_stMaptData", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "UINT s_Option95CheckSum", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"21550": ""}]}