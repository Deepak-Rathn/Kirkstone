{"is_source_file": true, "format": "shell script / sh", "description": "This file is a shell script used for CPU and memory recovery and monitoring for an 'Advsec' (Advanced Security) agent. It includes logic to check system modes, retrieve agent process IDs, monitor CPU and memory usage, and trigger agent restarts when thresholds are exceeded.", "external_files": ["advsec.sh"], "external_methods": ["syscfg get", "pidof", "awk", "grep", "cat", "expr", "top"], "published": [], "classes": [], "methods": [{"name": "get_agent_pid_list", "description": "Collects process IDs of agent processes based on predefined process names."}, {"name": "get_agent_cpu_time_spent", "description": "Calculates total CPU time spent by agent processes in user and kernel mode."}, {"name": "get_total_cpu_usage", "description": "Calculates total CPU usage from /proc/stat."}, {"name": "log_agent_cpu_statistics", "description": "Logs CPU statistics of agent processes."}, {"name": "log_agent_mem_statistics", "description": "Logs memory usage of agent processes and triggers restarts if limits are exceeded."}], "calls": ["syscfg get bridge_mode", "pidof", "awk", "cat", "expr", "top", "dmesg", "${RUNTIME_DIR}/bin/${CUJO_AGENT_SH}", "collectgarbage", "grep", "tail", "cut", "rm", "advsec_restart_agent", "advsec_wait_for_agent"], "search-terms": ["advsec_cpu_mem_recovery", "agent memory thresholds", "agent CPU time", "system mode check", "Nfluamem", "HighRSS", "LowFreeMem", "advsec"], "state": 2, "file_id": 5881, "knowledge_revision": 18977, "git_revision": "", "hash": "9bc94159148adeaf8f3f2bd1a5cd7a28", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdkb/components/opensource/ccsp/CcspAdvSecurity/scripts/advsec_cpu_mem_recovery.sh", "revision_history": [{"18977": ""}]}