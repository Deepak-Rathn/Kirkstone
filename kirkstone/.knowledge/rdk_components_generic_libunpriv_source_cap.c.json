{"is_source_file": true, "format": "C", "description": "This file manages Linux capabilities, process name retrieval, and blocklisting functionalities. It includes functions for manipulating process privileges, checking if a process is blocklisted, and handling capabilities via libcap.", "external_files": ["cap.h", "utility.h", "/proc/%d/comm"], "external_methods": ["getRFCParameter", "log_cap", "cap_get_proc", "cap_free", "cap_get_pid", "cap_to_text", "prctl", "getpwnam", "setgid", "setuid", "cap_set_flag", "cap_clear_flag", "cap_set_proc", "cap_set_ambient", "CAP_AMBIENT_SUPPORTED"], "published": ["isNull", "fetchRFC", "isBlocklisted", "prepare_caps", "init_capability", "read_capability", "set_ambient_caps", "drop_root_caps", "update_process_caps", "drop_root_priv", "gain_root_privilege"], "classes": [], "methods": [{"name": "void get_process_name(const pid_t pid,char * pname)", "description": "Retrieves the process name given a process ID by reading from /proc/[pid]/comm.", "scope": "", "scopeKind": ""}, {"name": "int drop_root_caps(cap_user * _appcaps)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool drop_root_priv(cap_user * _appcaps)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool fetchRFC(char * key,char ** value)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void gain_root_privilege()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "cap_t init_capability(void)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool isBlocklisted()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool isNonroot()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool isNull(char * str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void prepare_caps(cap_user * _appcaps,const cap_value_t _cap_add[],const cap_value_t _cap_drop[])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void read_capability(cap_user * _appcaps)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "void set_ambient_caps(const cap_value_t caplist[],short count,cap_flag_value_t value)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int update_process_caps(cap_user * _appcaps)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["getRFCParameter", "log_cap", "cap_get_proc", "cap_free", "cap_get_pid", "cap_to_text", "fopen", "fseek", "ftell", "fread", "fclose", "strcasestr", "getpid", "getuid", "getpwnam", "setgid", "setuid", "cap_set_flag", "cap_clear_flag", "cap_set_proc", "prctl", "cap_set_ambient"], "search-terms": ["capability management", "blocklist check", "root privilege drop", "process capability", "Linux privileges", "cap_init", "blocklist file path", "non-root"], "state": 2, "file_id": 12920, "knowledge_revision": 25824, "git_revision": "", "ctags": [{"_type": "tag", "name": "BLOCKLIST_FILE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^    #define BLOCKLIST_FILE /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "BLOCKLIST_RFC", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^#define BLOCKLIST_RFC /", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "_GNU_SOURCE", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^#define _GNU_SOURCE$/", "file": true, "language": "C", "kind": "macro"}, {"_type": "tag", "name": "caps", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^static cap_t caps;$/", "file": true, "language": "C", "typeref": "typename:cap_t", "kind": "variable"}, {"_type": "tag", "name": "drop_root_caps", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^int drop_root_caps(cap_user *_appcaps)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(cap_user * _appcaps)"}, {"_type": "tag", "name": "drop_root_priv", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^bool drop_root_priv(cap_user *_appcaps)$/", "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "(cap_user * _appcaps)"}, {"_type": "tag", "name": "fetchRFC", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^bool fetchRFC(char* key,char** value)$/", "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "(char * key,char ** value)"}, {"_type": "tag", "name": "gain_root_privilege", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^void gain_root_privilege()$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_process_name", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^static void get_process_name(const pid_t pid, char *pname)$/", "file": true, "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(const pid_t pid,char * pname)"}, {"_type": "tag", "name": "init_capability", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^cap_t init_capability(void)$/", "language": "C", "typeref": "typename:cap_t", "kind": "function", "signature": "(void)"}, {"_type": "tag", "name": "isBlocklisted", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^bool isBlocklisted()$/", "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "isNonroot", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^bool isNonroot( )$/", "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "isNull", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^bool isNull(char *str)$/", "language": "C", "typeref": "typename:bool", "kind": "function", "signature": "(char * str)"}, {"_type": "tag", "name": "prepare_caps", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^void prepare_caps(cap_user *_appcaps,const cap_value_t _cap_add[],const cap_value_t _cap_drop[])$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(cap_user * _appcaps,const cap_value_t _cap_add[],const cap_value_t _cap_drop[])"}, {"_type": "tag", "name": "read_capability", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^void read_capability(cap_user *_appcaps)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(cap_user * _appcaps)"}, {"_type": "tag", "name": "set_ambient_caps", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^void set_ambient_caps( const cap_value_t caplist[],short count,cap_flag_value_t value)$/", "language": "C", "typeref": "typename:void", "kind": "function", "signature": "(const cap_value_t caplist[],short count,cap_flag_value_t value)"}, {"_type": "tag", "name": "update_process_caps", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/rdk/components/generic/libunpriv/source/cap.c", "pattern": "/^int update_process_caps(cap_user *_appcaps)$/", "language": "C", "typeref": "typename:int", "kind": "function", "signature": "(cap_user * _appcaps)"}], "hash": "f2c11120bb2916073f0a7616671a6df9", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "rdk/components/generic/libunpriv/source/cap.c", "fields": [{"name": "cap_t caps", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"25824": ""}]}