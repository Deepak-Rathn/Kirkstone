{"is_source_file": true, "format": "Python", "description": "This file contains unit tests for the 'cve_check' functionality in the OEQA selftest framework. It tests version comparison logic, JSON report generation for CVEs, and integration with BitBake build system, focusing on handling different configurations and verifying output correctness.", "external_files": ["oeqa.selftest.case", "oeqa.utils.commands"], "external_methods": ["oeqa.selftest.case.OESelftestTestCase", "oeqa.utils.commands.bitbake", "oeqa.utils.commands.get_bb_vars"], "published": ["CVECheck"], "classes": [{"name": "CVECheck", "description": "Test case class for CVE checking functionalities, including version comparison and JSON report validation."}], "methods": [{"name": "test_version_compare(self)", "description": "Tests the comparison operators for the Version class with various version strings to ensure correct comparison semantics.", "scope": "CVECheck", "scopeKind": "class"}, {"name": "test_recipe_report_json(self)", "description": "Verifies the JSON report for a specific recipe after running the cve_check task via BitBake, ensuring the report contains expected data.", "scope": "CVECheck", "scopeKind": "class"}, {"name": "test_image_json(self)", "description": "Checks that a build of an image produces a CVE report JSON with multiple packages and associated reports.", "scope": "CVECheck", "scopeKind": "class"}, {"name": "test_recipe_report_json_unpatched(self)", "description": "Verifies the report content when all CVEs are unpatched, ensuring the 'issue' array is empty.", "scope": "CVECheck", "scopeKind": "class"}, {"name": "test_recipe_report_json_ignored(self)", "description": "Checks that CVEs marked as ignored do not appear as 'Patched' or 'Unpatched' in the report, and that only ignored CVEs are present for some packages.", "scope": "CVECheck", "scopeKind": "class"}, {"name": "check_m4_json(filename)", "scope": "CVECheck.test_recipe_report_json_unpatched", "scopeKind": "member", "description": "unavailable"}], "calls": ["oeqa.utils.commands.bitbake", "oeqa.utils.commands.get_bb_vars", "os.remove", "json.load", "self.assertEqual", "self.assertExists", "self.assertGreater", "self.assertIn", "self.assertNotIn"], "search-terms": ["cve_check", "version comparison", "JSON CVE report", "selftest", "bitbake", "OEQA"], "state": 2, "file_id": 1932, "knowledge_revision": 15076, "git_revision": "", "ctags": [{"_type": "tag", "name": "CVECheck", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/cases/cve_check.py", "pattern": "/^class CVECheck(OESelftestTestCase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "check_m4_json", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/cases/cve_check.py", "pattern": "/^        def check_m4_json(filename):$/", "file": true, "language": "Python", "kind": "function", "signature": "(filename)", "scope": "CVECheck.test_recipe_report_json", "scopeKind": "member"}, {"_type": "tag", "name": "check_m4_json", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/cases/cve_check.py", "pattern": "/^        def check_m4_json(filename):$/", "file": true, "language": "Python", "kind": "function", "signature": "(filename)", "scope": "CVECheck.test_recipe_report_json_ignored", "scopeKind": "member"}, {"_type": "tag", "name": "check_m4_json", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/cases/cve_check.py", "pattern": "/^        def check_m4_json(filename):$/", "file": true, "language": "Python", "kind": "function", "signature": "(filename)", "scope": "CVECheck.test_recipe_report_json_unpatched", "scopeKind": "member"}, {"_type": "tag", "name": "test_image_json", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/cases/cve_check.py", "pattern": "/^    def test_image_json(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "CVECheck", "scopeKind": "class"}, {"_type": "tag", "name": "test_recipe_report_json", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/cases/cve_check.py", "pattern": "/^    def test_recipe_report_json(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "CVECheck", "scopeKind": "class"}, {"_type": "tag", "name": "test_recipe_report_json_ignored", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/cases/cve_check.py", "pattern": "/^    def test_recipe_report_json_ignored(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "CVECheck", "scopeKind": "class"}, {"_type": "tag", "name": "test_recipe_report_json_unpatched", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/cases/cve_check.py", "pattern": "/^    def test_recipe_report_json_unpatched(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "CVECheck", "scopeKind": "class"}, {"_type": "tag", "name": "test_version_compare", "path": "/home/kavia/workspace/code-generation/Kirkstone/kirkstone/openembedded-core/meta/lib/oeqa/selftest/cases/cve_check.py", "pattern": "/^    def test_version_compare(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "CVECheck", "scopeKind": "class"}], "hash": "5a4b477f30e4fb2843e4a497f7da927f", "format-version": 4, "code-base-name": "meta-rdk-sampleapp", "filename": "openembedded-core/meta/lib/oeqa/selftest/cases/cve_check.py", "revision_history": [{"15076": ""}]}